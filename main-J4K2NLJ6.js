import{a as q,b as Ce,c as rf,d as N,e as q_,f as tc,g as z_,h as G_,i as W_,j as of,k as K_,l as Ks,m as sf,n as nc,o as Q_,p as Y_,q as af,r as Re,s as Wr,t as cn,u as rc,v as Qs,w as Z_,x as J_,y as sr,z as Et}from"./chunk-OQHDBYRL.js";var cf=null;var uf=1,X_=Symbol("SIGNAL");function ve(n){let e=cf;return cf=n,e}function eI(){return cf}var lf={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function vx(n){if(!(gf(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===uf)){if(!n.producerMustRecompute(n)&&!hf(n)){n.dirty=!1,n.lastCleanEpoch=uf;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=uf}}function df(n){return n&&(n.nextProducerIndex=0),ve(n)}function tI(n,e){if(ve(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(gf(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)pf(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function hf(n){mf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(vx(t),r!==t.version))return!0}return!1}function ff(n){if(mf(n),gf(n))for(let e=0;e<n.producerNode.length;e++)pf(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function pf(n,e){if(wx(n),n.liveConsumerNode.length===1&&_x(n))for(let r=0;r<n.producerNode.length;r++)pf(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];mf(i),i.producerIndexOfThis[r]=e}}function gf(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function mf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function wx(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function _x(n){return n.producerNode!==void 0}function Ix(){throw new Error}var Ex=Ix;function nI(n){Ex=n}function te(n){return typeof n=="function"}function Qi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ic=Qi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Kr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Oe=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(o){e=o instanceof ic?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{rI(o)}catch(s){e=e??[],s instanceof ic?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ic(e)}}add(e){var t;if(e&&e!==this)if(this.closed)rI(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Kr(t,e)}remove(e){let{_finalizers:t}=this;t&&Kr(t,e),e instanceof n&&e._removeParent(this)}};Oe.EMPTY=(()=>{let n=new Oe;return n.closed=!0,n})();var yf=Oe.EMPTY;function oc(n){return n instanceof Oe||n&&"closed"in n&&te(n.remove)&&te(n.add)&&te(n.unsubscribe)}function rI(n){te(n)?n():n.unsubscribe()}var Kt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Yi={setTimeout(n,e,...t){let{delegate:r}=Yi;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Yi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function sc(n){Yi.setTimeout(()=>{let{onUnhandledError:e}=Kt;if(e)e(n);else throw n})}function Ys(){}var iI=vf("C",void 0,void 0);function oI(n){return vf("E",void 0,n)}function sI(n){return vf("N",n,void 0)}function vf(n,e,t){return{kind:n,value:e,error:t}}var Qr=null;function Zi(n){if(Kt.useDeprecatedSynchronousErrorHandling){let e=!Qr;if(e&&(Qr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Qr;if(Qr=null,t)throw r}}else n()}function aI(n){Kt.useDeprecatedSynchronousErrorHandling&&Qr&&(Qr.errorThrown=!0,Qr.error=n)}var Yr=class extends Oe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,oc(e)&&e.add(this)):this.destination=Cx}static create(e,t,r){return new Nn(e,t,r)}next(e){this.isStopped?_f(sI(e),this):this._next(e)}error(e){this.isStopped?_f(oI(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?_f(iI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Dx=Function.prototype.bind;function wf(n,e){return Dx.call(n,e)}var If=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){ac(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){ac(r)}else ac(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ac(t)}}},Nn=class extends Yr{constructor(e,t,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Kt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&wf(e.next,o),error:e.error&&wf(e.error,o),complete:e.complete&&wf(e.complete,o)}):i=e}this.destination=new If(i)}};function ac(n){Kt.useDeprecatedSynchronousErrorHandling?aI(n):sc(n)}function Tx(n){throw n}function _f(n,e){let{onStoppedNotification:t}=Kt;t&&Yi.setTimeout(()=>t(n,e))}var Cx={closed:!0,next:Ys,error:Tx,complete:Ys};var Ji=typeof Symbol=="function"&&Symbol.observable||"@@observable";function pt(n){return n}function Ef(...n){return Df(n)}function Df(n){return n.length===0?pt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var le=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=Sx(t)?t:new Nn(t,r,i);return Zi(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=uI(r),new r((i,o)=>{let s=new Nn({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Ji](){return this}pipe(...t){return Df(t)(this)}toPromise(t){return t=uI(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function uI(n){var e;return(e=n??Kt.Promise)!==null&&e!==void 0?e:Promise}function bx(n){return n&&te(n.next)&&te(n.error)&&te(n.complete)}function Sx(n){return n&&n instanceof Yr||bx(n)&&oc(n)}function Tf(n){return te(n?.lift)}function se(n){return e=>{if(Tf(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(n,e,t,r,i){return new Cf(n,e,t,r,i)}var Cf=class extends Yr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Xi(){return se((n,e)=>{let t=null;n._refCount++;let r=ue(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var eo=class extends le{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Tf(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Oe;let t=this.getSubject();e.add(this.source.subscribe(ue(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Oe.EMPTY)}return e}refCount(){return Xi()(this)}};var cI=Qi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ve=(()=>{class n extends le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new uc(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new cI}next(t){Zi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Zi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Zi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?yf:(this.currentObservers=null,o.push(t),new Oe(()=>{this.currentObservers=null,Kr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new le;return t.source=this,t}}return n.create=(e,t)=>new uc(e,t),n})(),uc=class extends Ve{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:yf}};var et=class extends Ve{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Zs={now(){return(Zs.delegate||Date).now()},delegate:void 0};var cc=class extends Ve{constructor(e=1/0,t=1/0,r=Zs){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var lc=class extends Oe{constructor(e,t){super()}schedule(e,t=0){return this}};var Js={setInterval(n,e,...t){let{delegate:r}=Js;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Js;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var to=class extends lc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Js.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Js.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Kr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var no=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};no.now=Zs.now;var ro=class extends no{constructor(e,t=no.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Xs=new ro(to);var dc=class extends to{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var hc=class extends ro{};var bf=new hc(dc);var gt=new le(n=>n.complete());function lI(n){return n&&te(n.schedule)}function Sf(n){return n[n.length-1]}function dI(n){return te(Sf(n))?n.pop():void 0}function ln(n){return lI(Sf(n))?n.pop():void 0}function hI(n,e){return typeof Sf(n)=="number"?n.pop():e}var fc=n=>n&&typeof n.length=="number"&&typeof n!="function";function pc(n){return te(n?.then)}function gc(n){return te(n[Ji])}function mc(n){return Symbol.asyncIterator&&te(n?.[Symbol.asyncIterator])}function yc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Ax(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var vc=Ax();function wc(n){return te(n?.[vc])}function _c(n){return z_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield tc(t.read());if(i)return yield tc(void 0);yield yield tc(r)}}finally{t.releaseLock()}})}function Ic(n){return te(n?.getReader)}function Ne(n){if(n instanceof le)return n;if(n!=null){if(gc(n))return xx(n);if(fc(n))return Mx(n);if(pc(n))return Rx(n);if(mc(n))return fI(n);if(wc(n))return Nx(n);if(Ic(n))return Px(n)}throw yc(n)}function xx(n){return new le(e=>{let t=n[Ji]();if(te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Mx(n){return new le(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Rx(n){return new le(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,sc)})}function Nx(n){return new le(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function fI(n){return new le(e=>{kx(n,e).catch(t=>e.error(t))})}function Px(n){return fI(_c(n))}function kx(n,e){var t,r,i,o;return q_(this,void 0,void 0,function*(){try{for(t=G_(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Dt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Ot(n,e=0){return se((t,r)=>{t.subscribe(ue(r,i=>Dt(r,n,()=>r.next(i),e),()=>Dt(r,n,()=>r.complete(),e),i=>Dt(r,n,()=>r.error(i),e)))})}function Qt(n,e=0){return se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function pI(n,e){return Ne(n).pipe(Qt(e),Ot(e))}function gI(n,e){return Ne(n).pipe(Qt(e),Ot(e))}function mI(n,e){return new le(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function yI(n,e){return new le(t=>{let r;return Dt(t,e,()=>{r=n[vc](),Dt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function Ec(n,e){if(!n)throw new Error("Iterable cannot be null");return new le(t=>{Dt(t,e,()=>{let r=n[Symbol.asyncIterator]();Dt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function vI(n,e){return Ec(_c(n),e)}function wI(n,e){if(n!=null){if(gc(n))return pI(n,e);if(fc(n))return mI(n,e);if(pc(n))return gI(n,e);if(mc(n))return Ec(n,e);if(wc(n))return yI(n,e);if(Ic(n))return vI(n,e)}throw yc(n)}function we(n,e){return e?wI(n,e):Ne(n)}function Z(...n){let e=ln(n);return we(n,e)}function io(n,e){let t=te(n)?n:()=>n,r=i=>i.error(t());return new le(e?i=>e.schedule(r,0,i):r)}function Af(n){return!!n&&(n instanceof le||te(n.lift)&&te(n.subscribe))}var Pn=Qi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function ee(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:Ox}=Array;function Fx(n,e){return Ox(e)?n(...e):n(e)}function _I(n){return ee(e=>Fx(n,e))}var{isArray:Lx}=Array,{getPrototypeOf:Vx,prototype:jx,keys:Ux}=Object;function II(n){if(n.length===1){let e=n[0];if(Lx(e))return{args:e,keys:null};if(Bx(e)){let t=Ux(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Bx(n){return n&&typeof n=="object"&&Vx(n)===jx}function EI(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function ea(...n){let e=ln(n),t=dI(n),{args:r,keys:i}=II(n);if(r.length===0)return we([],e);let o=new le($x(r,e,i?s=>EI(i,s):pt));return t?o.pipe(_I(t)):o}function $x(n,e,t=pt){return r=>{DI(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)DI(e,()=>{let l=we(n[c],e),h=!1;l.subscribe(ue(r,p=>{o[c]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function DI(n,e,t){n?Dt(t,n,e):e()}function TI(n,e,t,r,i,o,s,a){let c=[],l=0,h=0,p=!1,m=()=>{p&&!c.length&&!l&&e.complete()},y=A=>l<r?C(A):c.push(A),C=A=>{o&&e.next(A),l++;let R=!1;Ne(t(A,h++)).subscribe(ue(e,L=>{i?.(L),o?y(L):e.next(L)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let L=c.shift();s?Dt(e,s,()=>C(L)):C(L)}m()}catch(L){e.error(L)}}))};return n.subscribe(ue(e,y,()=>{p=!0,m()})),()=>{a?.()}}function He(n,e,t=1/0){return te(e)?He((r,i)=>ee((o,s)=>e(r,o,i,s))(Ne(n(r,i))),t):(typeof e=="number"&&(t=e),se((r,i)=>TI(r,i,n,t)))}function ar(n=1/0){return He(pt,n)}function CI(){return ar(1)}function oo(...n){return CI()(we(n,ln(n)))}function Dc(n){return new le(e=>{Ne(n()).subscribe(e)})}function xf(...n){let e=ln(n),t=hI(n,1/0),r=n;return r.length?r.length===1?Ne(r[0]):ar(t)(we(r,e)):gt}function tt(n,e){return se((t,r)=>{let i=0;t.subscribe(ue(r,o=>n.call(e,o,i++)&&r.next(o)))})}function ur(n){return se((e,t)=>{let r=null,i=!1,o;r=e.subscribe(ue(t,void 0,void 0,s=>{o=Ne(n(s,ur(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function bI(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(ue(s,h=>{let p=l++;c=a?n(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function Zr(n,e){return te(e)?He(n,e,1):He(n,1)}function cr(n){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function kn(n){return n<=0?()=>gt:se((e,t)=>{let r=0;e.subscribe(ue(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Mf(n){return ee(()=>n)}function Rf(n,e=pt){return n=n??Hx,se((t,r)=>{let i,o=!0;t.subscribe(ue(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function Hx(n,e){return n===e}function Tc(n=qx){return se((e,t)=>{let r=!1;e.subscribe(ue(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function qx(){return new Pn}function ta(n){return se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ft(n,e){let t=arguments.length>=2;return r=>r.pipe(n?tt((i,o)=>n(i,o,r)):pt,kn(1),t?cr(e):Tc(()=>new Pn))}function so(n){return n<=0?()=>gt:se((e,t)=>{let r=[];e.subscribe(ue(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Nf(n,e){let t=arguments.length>=2;return r=>r.pipe(n?tt((i,o)=>n(i,o,r)):pt,so(1),t?cr(e):Tc(()=>new Pn))}function na(){return se((n,e)=>{let t,r=!1;n.subscribe(ue(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Jr(n,e){return se(bI(n,e,arguments.length>=2,!0))}function SI(n={}){let{connector:e=()=>new Ve,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,c,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},y=()=>{m(),s=c=void 0,h=p=!1},C=()=>{let A=s;y(),A?.unsubscribe()};return se((A,R)=>{l++,!p&&!h&&m();let L=c=c??e();R.add(()=>{l--,l===0&&!p&&!h&&(a=Pf(C,i))}),L.subscribe(R),!s&&l>0&&(s=new Nn({next:$=>L.next($),error:$=>{p=!0,m(),a=Pf(y,t,$),L.error($)},complete:()=>{h=!0,m(),a=Pf(y,r),L.complete()}}),Ne(A).subscribe(s))})(o)}}function Pf(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Nn({next:()=>{r.unsubscribe(),n()}});return Ne(e(...t)).subscribe(r)}function Cc(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,SI({connector:()=>new cc(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Xr(...n){let e=ln(n);return se((t,r)=>{(e?oo(n,t,e):oo(n,t)).subscribe(r)})}function Fe(n,e){return se((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ue(r,c=>{i?.unsubscribe();let l=0,h=o++;Ne(n(c,h)).subscribe(i=ue(r,p=>r.next(e?e(c,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function bc(n,e){return te(e)?Fe(()=>n,e):Fe(()=>n)}function kf(n){return se((e,t)=>{Ne(n).subscribe(ue(t,()=>t.complete(),Ys)),!t.closed&&e.subscribe(t)})}function Qe(n,e,t){let r=te(n)||e||t?{next:n,error:e,complete:t}:n;return r?se((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ue(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):pt}var J=class extends Error{constructor(e,t){super(Ap(e,t)),this.code=e}};function Ap(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function fa(n){return{toString:n}.toString()}var Sc="__parameters__";function zx(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function dE(n,e,t){return fa(()=>{let r=zx(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,h){let p=c.hasOwnProperty(Sc)?c[Sc]:Object.defineProperty(c,Sc,{value:[]})[Sc];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Vn=globalThis;function De(n){for(let e in n)if(n[e]===De)return e;throw Error("Could not find renamed property on target object.")}function xt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(xt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function AI(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var Gx=De({__forward_ref__:De});function hE(n){return n.__forward_ref__=hE,n.toString=function(){return xt(this())},n}function Vt(n){return fE(n)?n():n}function fE(n){return typeof n=="function"&&n.hasOwnProperty(Gx)&&n.__forward_ref__===hE}function W(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ut(n){return{providers:n.providers||[],imports:n.imports||[]}}function il(n){return xI(n,gE)||xI(n,mE)}function pE(n){return il(n)!==null}function xI(n,e){return n.hasOwnProperty(e)?n[e]:null}function Wx(n){let e=n&&(n[gE]||n[mE]);return e||null}function MI(n){return n&&(n.hasOwnProperty(RI)||n.hasOwnProperty(Kx))?n[RI]:null}var gE=De({\u0275prov:De}),RI=De({\u0275inj:De}),mE=De({ngInjectableDef:De}),Kx=De({ngInjectorDef:De}),z=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=W({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function yE(n){return n&&!!n.\u0275providers}var Qx=De({\u0275cmp:De}),Yx=De({\u0275dir:De}),Zx=De({\u0275pipe:De}),Jx=De({\u0275mod:De}),kc=De({\u0275fac:De}),ia=De({__NG_ELEMENT_ID__:De}),NI=De({__NG_ENV_ID__:De});function Hf(n){return typeof n=="string"?n:n==null?"":String(n)}function Xx(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Hf(n)}function eM(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new J(-200,n)}function xp(n,e){throw new J(-201,!1)}var ae=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ae||{}),qf;function vE(){return qf}function Lt(n){let e=qf;return qf=n,e}function wE(n,e,t){let r=il(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ae.Optional)return null;if(e!==void 0)return e;xp(n,"Injector")}var tM={},sa=tM,zf="__NG_DI_FLAG__",Oc="ngTempTokenPath",nM="ngTokenPath",rM=/\n/gm,iM="\u0275",PI="__source",ho;function oM(){return ho}function lr(n){let e=ho;return ho=n,e}function sM(n,e=ae.Default){if(ho===void 0)throw new J(-203,!1);return ho===null?wE(n,void 0,e):ho.get(n,e&ae.Optional?null:void 0,e)}function F(n,e=ae.Default){return(vE()||sM)(Vt(n),e)}function j(n,e=ae.Default){return F(n,ol(e))}function ol(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Gf(n){let e=[];for(let t=0;t<n.length;t++){let r=Vt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new J(900,!1);let i,o=ae.Default;for(let s=0;s<r.length;s++){let a=r[s],c=aM(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(F(i,o))}else e.push(F(r))}return e}function _E(n,e){return n[zf]=e,n.prototype[zf]=e,n}function aM(n){return n[zf]}function uM(n,e,t,r){let i=n[Oc];throw e[PI]&&i.unshift(e[PI]),n.message=cM(`
`+n.message,i,t,r),n[nM]=i,n[Oc]=null,n}function cM(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==iM?n.slice(2):n;let i=xt(e);if(Array.isArray(e))i=e.map(xt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):xt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(rM,`
  `)}`}var Do=_E(dE("Optional"),8);var Mp=_E(dE("SkipSelf"),4);function po(n,e){let t=n.hasOwnProperty(kc);return t?n[kc]:null}function Rp(n,e){n.forEach(t=>Array.isArray(t)?Rp(t,e):e(t))}function IE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Fc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var aa={},dn=[],go=new z(""),EE=new z("",-1),DE=new z(""),Lc=class{get(e,t=sa){if(t===sa){let r=new Error(`NullInjectorError: No provider for ${xt(e)}!`);throw r.name="NullInjectorError",r}return t}},TE=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(TE||{}),pn=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(pn||{}),hr=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(hr||{});function lM(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function Wf(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];hM(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function dM(n){return n===3||n===4||n===6}function hM(n){return n.charCodeAt(0)===64}function Np(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?kI(n,t,i,null,e[++r]):kI(n,t,i,null,null))}}return n}function kI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var CE="ng-template";function fM(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&lM(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Pp(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Pp(n){return n.type===4&&n.value!==CE}function pM(n,e,t){let r=n.type===4&&!t?CE:n.value;return e===r}function gM(n,e,t){let r=4,i=n.attrs,o=i!==null?vM(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Yt(r)&&!Yt(c))return!1;if(s&&Yt(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!pM(n,c,t)||c===""&&e.length===1){if(Yt(r))return!1;s=!0}}else if(r&8){if(i===null||!fM(n,i,c,t)){if(Yt(r))return!1;s=!0}}else{let l=e[++a],h=mM(c,i,Pp(n),t);if(h===-1){if(Yt(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Yt(r))return!1;s=!0}}}}return Yt(r)||s}function Yt(n){return(n&1)===0}function mM(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return wM(e,n)}function yM(n,e,t=!1){for(let r=0;r<e.length;r++)if(gM(n,e[r],t))return!0;return!1}function vM(n){for(let e=0;e<n.length;e++){let t=n[e];if(dM(t))return e}return n.length}function wM(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function OI(n,e){return n?":not("+e.trim()+")":e}function _M(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Yt(s)&&(e+=OI(o,i),i=""),r=s,o=o||!Yt(r);t++}return i!==""&&(e+=OI(o,i)),e}function IM(n){return n.map(_M).join(",")}function EM(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Yt(i))break;i=o}r++}return{attrs:e,classes:t}}function sl(n){return fa(()=>{let e=ME(n),t=Ce(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===TE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||pn.Emulated,styles:n.styles||dn,_:null,schemas:n.schemas||null,tView:null,id:""});RE(t);let r=n.dependencies;return t.directiveDefs=LI(r,!1),t.pipeDefs=LI(r,!0),t.id=CM(t),t})}function DM(n){return fr(n)||bE(n)}function TM(n){return n!==null}function ct(n){return fa(()=>({type:n.type,bootstrap:n.bootstrap||dn,declarations:n.declarations||dn,imports:n.imports||dn,exports:n.exports||dn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function FI(n,e){if(n==null)return aa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=hr.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==hr.None?[r,a]:r,e[o]=s):t[o]=r}return t}function al(n){return fa(()=>{let e=ME(n);return RE(e),e})}function fr(n){return n[Qx]||null}function bE(n){return n[Yx]||null}function SE(n){return n[Zx]||null}function AE(n){let e=fr(n)||bE(n)||SE(n);return e!==null?e.standalone:!1}function xE(n,e){let t=n[Jx]||null;if(!t&&e===!0)throw new Error(`Type ${xt(n)} does not have '\u0275mod' property.`);return t}function ME(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||aa,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||dn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:FI(n.inputs,e),outputs:FI(n.outputs),debugInfo:null}}function RE(n){n.features?.forEach(e=>e(n))}function LI(n,e){if(!n)return null;let t=e?SE:DM;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(TM)}function CM(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function bM(...n){return{\u0275providers:NE(!0,n),\u0275fromNgModule:!0}}function NE(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Rp(e,s=>{let a=s;Kf(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&PE(i,o),t}function PE(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];kp(i,o=>{e(o,r)})}}function Kf(n,e,t,r){if(n=Vt(n),!n)return!1;let i=null,o=MI(n),s=!o&&fr(n);if(!o&&!s){let c=n.ngModule;if(o=MI(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Kf(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{Rp(o.imports,h=>{Kf(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&PE(l,e)}if(!a){let l=po(i)||(()=>new i);e({provide:i,useFactory:l,deps:dn},i),e({provide:DE,useValue:i,multi:!0},i),e({provide:go,useValue:()=>F(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;kp(c,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function kp(n,e){for(let t of n)yE(t)&&(t=t.\u0275providers),Array.isArray(t)?kp(t,e):e(t)}var SM=De({provide:String,useValue:De});function kE(n){return n!==null&&typeof n=="object"&&SM in n}function AM(n){return!!(n&&n.useExisting)}function xM(n){return!!(n&&n.useFactory)}function Qf(n){return typeof n=="function"}var ul=new z(""),Mc={},MM={},Of;function Op(){return Of===void 0&&(Of=new Lc),Of}var Mt=class{},ua=class extends Mt{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Zf(e,s=>this.processProvider(s)),this.records.set(EE,ao(void 0,this)),i.has("environment")&&this.records.set(Mt,ao(void 0,this));let o=this.records.get(ul);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(DE,dn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ve(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ve(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=lr(this),r=Lt(void 0),i;try{return e()}finally{lr(t),Lt(r)}}get(e,t=sa,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(NI))return e[NI](this);r=ol(r);let i,o=lr(this),s=Lt(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=FM(e)&&il(e);l&&this.injectableDefInScope(l)?c=ao(Yf(e),Mc):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?Op():this.parent;return t=r&ae.Optional&&t===sa?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Oc]=a[Oc]||[]).unshift(xt(e)),o)throw a;return uM(a,e,"R3InjectorError",this.source)}else throw a}finally{Lt(s),lr(o)}}resolveInjectorInitializers(){let e=ve(null),t=lr(this),r=Lt(void 0),i;try{let o=this.get(go,dn,ae.Self);for(let s of o)s()}finally{lr(t),Lt(r),ve(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(xt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new J(205,!1)}processProvider(e){e=Vt(e);let t=Qf(e)?e:Vt(e&&e.provide),r=NM(e);if(!Qf(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ao(void 0,Mc,!0),i.factory=()=>Gf(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ve(null);try{return t.value===Mc&&(t.value=MM,t.value=t.factory()),typeof t.value=="object"&&t.value&&OM(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ve(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Vt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Yf(n){let e=il(n),t=e!==null?e.factory:po(n);if(t!==null)return t;if(n instanceof z)throw new J(204,!1);if(n instanceof Function)return RM(n);throw new J(204,!1)}function RM(n){if(n.length>0)throw new J(204,!1);let t=Wx(n);return t!==null?()=>t.factory(n):()=>new n}function NM(n){if(kE(n))return ao(void 0,n.useValue);{let e=PM(n);return ao(e,Mc)}}function PM(n,e,t){let r;if(Qf(n)){let i=Vt(n);return po(i)||Yf(i)}else if(kE(n))r=()=>Vt(n.useValue);else if(xM(n))r=()=>n.useFactory(...Gf(n.deps||[]));else if(AM(n))r=()=>F(Vt(n.useExisting));else{let i=Vt(n&&(n.useClass||n.provide));if(kM(n))r=()=>new i(...Gf(n.deps));else return po(i)||Yf(i)}return r}function ao(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function kM(n){return!!n.deps}function OM(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function FM(n){return typeof n=="function"||typeof n=="object"&&n instanceof z}function Zf(n,e){for(let t of n)Array.isArray(t)?Zf(t,e):t&&yE(t)?Zf(t.\u0275providers,e):e(t)}function yn(n,e){n instanceof ua&&n.assertNotDestroyed();let t,r=lr(n),i=Lt(void 0);try{return e()}finally{lr(r),Lt(i)}}function OE(){return vE()!==void 0||oM()!=null}function LM(n){if(!OE())throw new J(-203,!1)}function VM(n){let e=Vn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function jM(n){return typeof n=="function"}var jn=0,de=1,ne=2,yt=3,Zt=4,Jt=5,Vc=6,jc=7,On=8,mo=9,Fn=10,Tt=11,ca=12,VI=13,pa=14,gn=15,yo=16,uo=17,vo=18,cl=19,FE=20,dr=21,Ff=22,jt=23,pr=25,LE=1;var ii=7,Uc=8,Bc=9,Ut=10,$c=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}($c||{});function ni(n){return Array.isArray(n)&&typeof n[LE]=="object"}function Un(n){return Array.isArray(n)&&n[LE]===!0}function VE(n){return(n.flags&4)!==0}function ll(n){return n.componentOffset>-1}function Fp(n){return(n.flags&1)===1}function ga(n){return!!n.template}function Jf(n){return(n[ne]&512)!==0}var Xf=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function jE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function dl(){return UE}function UE(n){return n.type.prototype.ngOnChanges&&(n.setInput=BM),UM}dl.ngInherit=!0;function UM(){let n=$E(this),e=n?.current;if(e){let t=n.previous;if(t===aa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function BM(n,e,t,r,i){let o=this.declaredInputs[r],s=$E(n)||$M(n,{previous:aa,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new Xf(l&&l.currentValue,t,c===aa),jE(n,e,i,t)}var BE="__ngSimpleChanges__";function $E(n){return n[BE]||null}function $M(n,e){return n[BE]=e}var jI=null;var hn=function(n,e,t){jI?.(n,e,t)},HM="svg",qM="math";function mn(n){for(;Array.isArray(n);)n=n[jn];return n}function zM(n,e){return mn(e[n])}function Xt(n,e){return mn(e[n.index])}function HE(n,e){return n.data[e]}function ci(n,e){let t=e[n];return ni(t)?t:t[jn]}function Lp(n){return(n[ne]&128)===128}function GM(n){return Un(n[yt])}function Hc(n,e){return e==null?null:n[e]}function qE(n){n[uo]=0}function zE(n){n[ne]&1024||(n[ne]|=1024,Lp(n)&&fl(n))}function hl(n){return!!(n[ne]&9216||n[jt]?.dirty)}function ep(n){n[Fn].changeDetectionScheduler?.notify(8),n[ne]&64&&(n[ne]|=1024),hl(n)&&fl(n)}function fl(n){n[Fn].changeDetectionScheduler?.notify(0);let e=oi(n);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!Lp(e)));)e=oi(e)}function GE(n,e){if((n[ne]&256)===256)throw new J(911,!1);n[dr]===null&&(n[dr]=[]),n[dr].push(e)}function WM(n,e){if(n[dr]===null)return;let t=n[dr].indexOf(e);t!==-1&&n[dr].splice(t,1)}function oi(n){let e=n[yt];return Un(e)?e[yt]:e}var ye={lFrame:tD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var WE=!1;function KM(){return ye.lFrame.elementDepthCount}function QM(){ye.lFrame.elementDepthCount++}function YM(){ye.lFrame.elementDepthCount--}function KE(){return ye.bindingsEnabled}function ZM(){return ye.skipHydrationRootTNode!==null}function JM(n){return ye.skipHydrationRootTNode===n}function XM(){ye.skipHydrationRootTNode=null}function nt(){return ye.lFrame.lView}function li(){return ye.lFrame.tView}function en(){let n=QE();for(;n!==null&&n.type===64;)n=n.parent;return n}function QE(){return ye.lFrame.currentTNode}function eR(){let n=ye.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ma(n,e){let t=ye.lFrame;t.currentTNode=n,t.isParent=e}function YE(){return ye.lFrame.isParent}function tR(){ye.lFrame.isParent=!1}function ZE(){return WE}function UI(n){WE=n}function nR(){return ye.lFrame.bindingIndex}function rR(n){return ye.lFrame.bindingIndex=n}function iR(){return ye.lFrame.bindingIndex++}function oR(n){let e=ye.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function sR(){return ye.lFrame.inI18n}function aR(n,e){let t=ye.lFrame;t.bindingIndex=t.bindingRootIndex=n,tp(e)}function uR(){return ye.lFrame.currentDirectiveIndex}function tp(n){ye.lFrame.currentDirectiveIndex=n}function JE(n){ye.lFrame.currentQueryIndex=n}function cR(n){let e=n[de];return e.type===2?e.declTNode:e.type===1?n[Jt]:null}function XE(n,e,t){if(t&ae.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ae.Host);)if(i=cR(o),i===null||(o=o[pa],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=ye.lFrame=eD();return r.currentTNode=e,r.lView=n,!0}function Vp(n){let e=eD(),t=n[de];ye.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function eD(){let n=ye.lFrame,e=n===null?null:n.child;return e===null?tD(n):e}function tD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function nD(){let n=ye.lFrame;return ye.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var rD=nD;function jp(){let n=nD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Up(){return ye.lFrame.selectedIndex}function si(n){ye.lFrame.selectedIndex=n}function lR(){let n=ye.lFrame;return HE(n.tView,n.selectedIndex)}function dR(){return ye.lFrame.currentNamespace}var iD=!0;function Bp(){return iD}function $p(n){iD=n}function hR(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=UE(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Hp(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function Rc(n,e,t){oD(n,e,3,t)}function Nc(n,e,t,r){(n[ne]&3)===t&&oD(n,e,t,r)}function Lf(n,e){let t=n[ne];(t&3)===e&&(t&=16383,t+=1,n[ne]=t)}function oD(n,e,t,r){let i=r!==void 0?n[uo]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[uo]+=65536),(a<o||o==-1)&&(fR(n,t,e,c),n[uo]=(n[uo]&4294901760)+c+2),c++}function BI(n,e){hn(4,n,e);let t=ve(null);try{e.call(n)}finally{ve(t),hn(5,n,e)}}function fR(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ne]>>14<n[uo]>>16&&(n[ne]&3)===e&&(n[ne]+=16384,BI(a,o)):BI(a,o)}var fo=-1,la=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function pR(n){return n instanceof la}function gR(n){return(n.flags&8)!==0}function mR(n){return(n.flags&16)!==0}var Vf={},np=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=ol(r);let i=this.injector.get(e,Vf,r);return i!==Vf||t===Vf?i:this.parentInjector.get(e,t,r)}};function sD(n){return n!==fo}function qc(n){return n&32767}function yR(n){return n>>16}function zc(n,e){let t=yR(n),r=e;for(;t>0;)r=r[pa],t--;return r}var rp=!0;function $I(n){let e=rp;return rp=n,e}var vR=256,aD=vR-1,uD=5,wR=0,fn={};function _R(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ia)&&(r=t[ia]),r==null&&(r=t[ia]=wR++);let i=r&aD,o=1<<i;e.data[n+(i>>uD)]|=o}function cD(n,e){let t=lD(n,e);if(t!==-1)return t;let r=e[de];r.firstCreatePass&&(n.injectorIndex=e.length,jf(r.data,n),jf(e,null),jf(r.blueprint,null));let i=qp(n,e),o=n.injectorIndex;if(sD(i)){let s=qc(i),a=zc(i,e),c=a[de].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function jf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function lD(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function qp(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=gD(i),r===null)return fo;if(t++,i=i[pa],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return fo}function IR(n,e,t){_R(n,e,t)}function dD(n,e,t){if(t&ae.Optional||n!==void 0)return n;xp(e,"NodeInjector")}function hD(n,e,t,r){if(t&ae.Optional&&r===void 0&&(r=null),!(t&(ae.Self|ae.Host))){let i=n[mo],o=Lt(void 0);try{return i?i.get(e,r,t&ae.Optional):wE(e,r,t&ae.Optional)}finally{Lt(o)}}return dD(r,e,t)}function fD(n,e,t,r=ae.Default,i){if(n!==null){if(e[ne]&2048&&!(r&ae.Self)){let s=bR(n,e,t,r,fn);if(s!==fn)return s}let o=pD(n,e,t,r,fn);if(o!==fn)return o}return hD(e,t,r,i)}function pD(n,e,t,r,i){let o=TR(t);if(typeof o=="function"){if(!XE(e,n,r))return r&ae.Host?dD(i,t,r):hD(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ae.Optional))xp(t);else return s}finally{rD()}}else if(typeof o=="number"){let s=null,a=lD(n,e),c=fo,l=r&ae.Host?e[gn][Jt]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?qp(n,e):e[a+8],c===fo||!qI(r,!1)?a=-1:(s=e[de],a=qc(c),e=zc(c,e)));a!==-1;){let h=e[de];if(HI(o,a,h.data)){let p=ER(a,e,t,s,r,l);if(p!==fn)return p}c=e[a+8],c!==fo&&qI(r,e[de].data[a+8]===l)&&HI(o,a,e)?(s=h,a=qc(c),e=zc(c,e)):a=-1}}return i}function ER(n,e,t,r,i,o){let s=e[de],a=s.data[n+8],c=r==null?ll(a)&&rp:r!=s&&(a.type&3)!==0,l=i&ae.Host&&o===a,h=DR(a,s,t,c,l);return h!==null?da(e,s,h,a):fn}function DR(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let y=p;y<m;y++){let C=s[y];if(y<c&&t===C||y>=c&&C.type===t)return y}if(i){let y=s[c];if(y&&ga(y)&&y.type===t)return c}return null}function da(n,e,t,r){let i=n[t],o=e.data;if(pR(i)){let s=i;s.resolving&&eM(Xx(o[t]));let a=$I(s.canSeeViewProviders);s.resolving=!0;let c,l=s.injectImpl?Lt(s.injectImpl):null,h=XE(n,r,ae.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&hR(t,o[t],e)}finally{l!==null&&Lt(l),$I(a),s.resolving=!1,rD()}}return i}function TR(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ia)?n[ia]:void 0;return typeof e=="number"?e>=0?e&aD:CR:e}function HI(n,e,t){let r=1<<n;return!!(t[e+(n>>uD)]&r)}function qI(n,e){return!(n&ae.Self)&&!(n&ae.Host&&e)}var ri=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return fD(this._tNode,this._lView,e,ol(r),t)}};function CR(){return new ri(en(),nt())}function zp(n){return fa(()=>{let e=n.prototype.constructor,t=e[kc]||ip(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[kc]||ip(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function ip(n){return fE(n)?()=>{let e=ip(Vt(n));return e&&e()}:po(n)}function bR(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ne]&2048&&!(s[ne]&512);){let a=pD(o,s,t,r|ae.Self,fn);if(a!==fn)return a;let c=o.parent;if(!c){let l=s[FE];if(l){let h=l.get(t,fn,r);if(h!==fn)return h}c=gD(s),s=s[pa]}o=c}return i}function gD(n){let e=n[de],t=e.type;return t===2?e.declTNode:t===1?n[Jt]:null}function zI(n,e=null,t=null,r){let i=mD(n,e,t,r);return i.resolveInjectorInitializers(),i}function mD(n,e=null,t=null,r,i=new Set){let o=[t||dn,bM(n)];return r=r||(typeof n=="object"?void 0:xt(n)),new ua(o,e||Op(),r||null,i)}var ei=class ei{static create(e,t){if(Array.isArray(e))return zI({name:""},t,e,"");{let r=e.name??"";return zI({name:r},e.parent,e.providers,r)}}};ei.THROW_IF_NOT_FOUND=sa,ei.NULL=new Lc,ei.\u0275prov=W({token:ei,providedIn:"any",factory:()=>F(EE)}),ei.__NG_ELEMENT_ID__=-1;var Bt=ei;var SR=new z("");SR.__NG_ELEMENT_ID__=n=>{let e=en();if(e===null)throw new J(204,!1);if(e.type&2)return e.value;if(n&ae.Optional)return null;throw new J(204,!1)};var AR="ngOriginalError";function Uf(n){return n[AR]}var yD=!0,Gp=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=xR,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),op=class extends Gp{constructor(e){super(),this._lView=e}onDestroy(e){return GE(this._lView,e),()=>WM(this._lView,e)}};function xR(){return new op(nt())}var To=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new et(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275prov=W({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();var sp=class extends Ve{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,OE()&&(this.destroyRef=j(Gp,{optional:!0})??void 0,this.pendingTasks=j(To,{optional:!0})??void 0)}emit(e){let t=ve(null);try{super.next(e)}finally{ve(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Oe&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},mt=sp;function Gc(...n){}function vD(n){let e,t;function r(){n=Gc;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function GI(n){return queueMicrotask(()=>n()),()=>{n=Gc}}var Wp="isAngularZone",Wc=Wp+"_ID",MR=0,he=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mt(!1),this.onMicrotaskEmpty=new mt(!1),this.onStable=new mt(!1),this.onError=new mt(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=yD}=e;if(typeof Zone>"u")throw new J(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,PR(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Wp)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new J(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new J(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,RR,Gc,Gc);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},RR={};function Kp(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function NR(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){vD(()=>{n.callbackScheduled=!1,ap(n),n.isCheckStableRunning=!0,Kp(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),ap(n)}function PR(n){let e=()=>{NR(n)},t=MR++;n._inner=n._inner.fork({name:"angular",properties:{[Wp]:!0,[Wc]:t,[Wc+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(kR(c))return r.invokeTask(o,s,a,c);try{return WI(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),KI(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return WI(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!OR(c)&&e(),KI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,ap(n),Kp(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function ap(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function WI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function KI(n){n._nesting--,Kp(n)}var Kc=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mt,this.onMicrotaskEmpty=new mt,this.onStable=new mt,this.onError=new mt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function kR(n){return wD(n,"__ignore_ng_zone__")}function OR(n){return wD(n,"__scheduler_tick__")}function wD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}function FR(n="zone.js",e){return n==="noop"?new Kc:n==="zone.js"?new he(e):n}var Ln=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Uf(e);for(;t&&Uf(t);)t=Uf(t);return t||null}},LR=new z("",{providedIn:"root",factory:()=>{let n=j(he),e=j(Ln);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function VR(){return pl(en(),nt())}function pl(n,e){return new gl(Xt(n,e))}var gl=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=VR;let n=e;return n})();function _D(n){return(n.flags&128)===128}var ID=new Map,jR=0;function UR(){return jR++}function BR(n){ID.set(n[cl],n)}function up(n){ID.delete(n[cl])}var QI="__ngContext__";function ai(n,e){ni(e)?(n[QI]=e[cl],BR(e)):n[QI]=e}function ED(n){return TD(n[ca])}function DD(n){return TD(n[Zt])}function TD(n){for(;n!==null&&!Un(n);)n=n[Zt];return n}var cp;function CD(n){cp=n}function $R(){if(cp!==void 0)return cp;if(typeof document<"u")return document;throw new J(210,!1)}var ml=new z("",{providedIn:"root",factory:()=>HR}),HR="ng",Qp=new z(""),Ct=new z("",{providedIn:"platform",factory:()=>"unknown"});var Yp=new z("",{providedIn:"root",factory:()=>$R().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var qR="h",zR="b";var GR=()=>null;function Zp(n,e,t=!1){return GR(n,e,t)}var bD=!1,WR=new z("",{providedIn:"root",factory:()=>bD});function SD(n){return n instanceof Function?n():n}function KR(n){return(n??j(Bt)).get(Ct)==="browser"}var di=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(di||{}),QR;function Jp(n,e){return QR(n,e)}function co(n,e,t,r,i){if(r!=null){let o,s=!1;Un(r)?o=r:ni(r)&&(s=!0,r=r[jn]);let a=mn(r);n===0&&t!==null?i==null?ND(e,t,a):Qc(e,t,a,i||null,!0):n===1&&t!==null?Qc(e,t,a,i||null,!0):n===2?lN(e,a,s):n===3&&e.destroyNode(a),o!=null&&hN(e,n,o,t,i)}}function YR(n,e){return n.createText(e)}function ZR(n,e,t){n.setValue(e,t)}function AD(n,e,t){return n.createElement(e,t)}function JR(n,e){xD(n,e),e[jn]=null,e[Jt]=null}function XR(n,e,t,r,i,o){r[jn]=i,r[Jt]=e,yl(n,r,t,1,i,o)}function xD(n,e){e[Fn].changeDetectionScheduler?.notify(9),yl(n,e,e[Tt],2,null,null)}function eN(n){let e=n[ca];if(!e)return Bf(n[de],n);for(;e;){let t=null;if(ni(e))t=e[ca];else{let r=e[Ut];r&&(t=r)}if(!t){for(;e&&!e[Zt]&&e!==n;)ni(e)&&Bf(e[de],e),e=e[yt];e===null&&(e=n),ni(e)&&Bf(e[de],e),t=e&&e[Zt]}e=t}}function tN(n,e,t,r){let i=Ut+r,o=t.length;r>0&&(t[i-1][Zt]=e),r<o-Ut?(e[Zt]=t[i],IE(t,Ut+r,e)):(t.push(e),e[Zt]=null),e[yt]=t;let s=e[yo];s!==null&&t!==s&&MD(s,e);let a=e[vo];a!==null&&a.insertView(n),ep(e),e[ne]|=128}function MD(n,e){let t=n[Bc],r=e[yt];if(ni(r))n[ne]|=$c.HasTransplantedViews;else{let i=r[yt][gn];e[gn]!==i&&(n[ne]|=$c.HasTransplantedViews)}t===null?n[Bc]=[e]:t.push(e)}function Xp(n,e){let t=n[Bc],r=t.indexOf(e);t.splice(r,1)}function lp(n,e){if(n.length<=Ut)return;let t=Ut+e,r=n[t];if(r){let i=r[yo];i!==null&&i!==n&&Xp(i,r),e>0&&(n[t-1][Zt]=r[Zt]);let o=Fc(n,Ut+e);JR(r[de],r);let s=o[vo];s!==null&&s.detachView(o[de]),r[yt]=null,r[Zt]=null,r[ne]&=-129}return r}function RD(n,e){if(!(e[ne]&256)){let t=e[Tt];t.destroyNode&&yl(n,e,t,3,null,null),eN(e)}}function Bf(n,e){if(e[ne]&256)return;let t=ve(null);try{e[ne]&=-129,e[ne]|=256,e[jt]&&ff(e[jt]),rN(n,e),nN(n,e),e[de].type===1&&e[Tt].destroy();let r=e[yo];if(r!==null&&Un(e[yt])){r!==e[yt]&&Xp(r,e);let i=e[vo];i!==null&&i.detachView(n)}up(e)}finally{ve(t)}}function nN(n,e){let t=n.cleanup,r=e[jc];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[jc]=null);let i=e[dr];if(i!==null){e[dr]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function rN(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof la)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];hn(4,a,c);try{c.call(a)}finally{hn(5,a,c)}}else{hn(4,i,o);try{o.call(i)}finally{hn(5,i,o)}}}}}function iN(n,e,t){return oN(n,e.parent,t)}function oN(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[jn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===pn.None||o===pn.Emulated)return null}return Xt(r,t)}}function Qc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function ND(n,e,t){n.appendChild(e,t)}function YI(n,e,t,r,i){r!==null?Qc(n,e,t,r,i):ND(n,e,t)}function PD(n,e){return n.parentNode(e)}function sN(n,e){return n.nextSibling(e)}function aN(n,e,t){return cN(n,e,t)}function uN(n,e,t){return n.type&40?Xt(n,t):null}var cN=uN,ZI;function eg(n,e,t,r){let i=iN(n,r,e),o=e[Tt],s=r.parent||e[Jt],a=aN(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)YI(o,i,t[c],a,!1);else YI(o,i,t,a,!1);ZI!==void 0&&ZI(o,r,e,t,i)}function ra(n,e){if(e!==null){let t=e.type;if(t&3)return Xt(e,n);if(t&4)return dp(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ra(n,r);{let i=n[e.index];return Un(i)?dp(-1,i):mn(i)}}else{if(t&128)return ra(n,e.next);if(t&32)return Jp(e,n)()||mn(n[e.index]);{let r=kD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=oi(n[gn]);return ra(i,r)}else return ra(n,e.next)}}}return null}function kD(n,e){if(e!==null){let r=n[gn][Jt],i=e.projection;return r.projection[i]}return null}function dp(n,e){let t=Ut+n+1;if(t<e.length){let r=e[t],i=r[de].firstChild;if(i!==null)return ra(r,i)}return e[ii]}function lN(n,e,t){n.removeChild(null,e,t)}function tg(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&ai(mn(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)tg(n,e,t.child,r,i,o,!1),co(e,n,i,a,o);else if(c&32){let l=Jp(t,r),h;for(;h=l();)co(e,n,i,h,o);co(e,n,i,a,o)}else c&16?dN(n,e,r,t,i,o):co(e,n,i,a,o);t=s?t.projectionNext:t.next}}function yl(n,e,t,r,i,o){tg(t,r,n.firstChild,e,i,o,!1)}function dN(n,e,t,r,i,o){let s=t[gn],c=s[Jt].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let h=c[l];co(e,n,i,h,o)}else{let l=c,h=s[yt];_D(r)&&(l.flags|=128),tg(n,e,l,h,i,o,!0)}}function hN(n,e,t,r,i){let o=t[ii],s=mn(t);o!==s&&co(e,n,r,o,i);for(let a=Ut;a<t.length;a++){let c=t[a];yl(c[de],c,n,e,r,o)}}function fN(n,e,t){n.setAttribute(e,"style",t)}function OD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function FD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&Wf(n,e,r),i!==null&&OD(n,e,i),o!==null&&fN(n,e,o)}var vl={};function ng(n=1){LD(li(),nt(),Up()+n,!1)}function LD(n,e,t,r){if(!r)if((e[ne]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Rc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Nc(e,o,0,t)}si(t)}function yr(n,e=ae.Default){let t=nt();if(t===null)return F(n,e);let r=en();return fD(r,t,Vt(n),e)}function VD(){let n="invalid";throw new Error(n)}function jD(n,e,t,r,i,o){let s=ve(null);try{let a=null;i&hr.SignalBased&&(a=e[r][X_]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&hr.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):jE(e,a,r,o)}finally{ve(s)}}function pN(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)si(~i);else{let o=i,s=t[++r],a=t[++r];aR(s,o);let c=e[o];a(2,c)}}}finally{si(-1)}}function wl(n,e,t,r,i,o,s,a,c,l,h){let p=e.blueprint.slice();return p[jn]=i,p[ne]=r|4|128|8|64,(l!==null||n&&n[ne]&2048)&&(p[ne]|=2048),qE(p),p[yt]=p[pa]=n,p[On]=t,p[Fn]=s||n&&n[Fn],p[Tt]=a||n&&n[Tt],p[mo]=c||n&&n[mo]||null,p[Jt]=o,p[cl]=UR(),p[Vc]=h,p[FE]=l,p[gn]=e.type==2?n[gn]:p,p}function _l(n,e,t,r,i){let o=n.data[e];if(o===null)o=gN(n,e,t,r,i),sR()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=eR();o.injectorIndex=s===null?-1:s.injectorIndex}return ma(o,!0),o}function gN(n,e,t,r,i){let o=QE(),s=YE(),a=s?o:o&&o.parent,c=n.data[e]=_N(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),o!==null&&(s?o.child==null&&c.parent!==null&&(o.child=c):o.next===null&&(o.next=c,c.prev=o)),c}function UD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function BD(n,e,t,r,i){let o=Up(),s=r&2;try{si(-1),s&&e.length>pr&&LD(n,e,pr,!1),hn(s?2:0,i),t(r,i)}finally{si(o),hn(s?3:1,i)}}function $D(n,e,t){if(VE(e)){let r=ve(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{ve(r)}}}function HD(n,e,t){KE()&&(SN(n,e,t,Xt(t,e)),(t.flags&64)===64&&KD(n,e,t))}function qD(n,e,t=Xt){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function zD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=rg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function rg(n,e,t,r,i,o,s,a,c,l,h){let p=pr+r,m=p+i,y=mN(p,m),C=typeof l=="function"?l():l;return y[de]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:C,incompleteFirstPass:!1,ssrId:h}}function mN(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:vl);return t}function yN(n,e,t,r){let o=r.get(WR,bD)||t===pn.ShadowDom,s=n.selectRootElement(e,o);return vN(s),s}function vN(n){wN(n)}var wN=()=>null;function _N(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return ZM()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function JI(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=hr.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?XI(r,t,l,a,c):XI(r,t,l,a)}return r}function XI(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function IN(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,y=m?m.inputs:null,C=m?m.outputs:null;c=JI(0,p.inputs,h,c,y),l=JI(1,p.outputs,h,l,C);let A=c!==null&&s!==null&&!Pp(e)?FN(c,h,s):null;a.push(A)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function EN(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function DN(n,e,t,r,i,o,s,a){let c=Xt(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(ig(n,t,h,r,i),ll(e)&&TN(t,e.index)):e.type&3?(r=EN(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function TN(n,e){let t=ci(e,n);t[ne]&16||(t[ne]|=64)}function GD(n,e,t,r){if(KE()){let i=r===null?null:{"":-1},o=xN(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&WD(n,e,t,s,i,a),i&&MN(t,r,i)}t.mergedAttrs=Np(t.mergedAttrs,t.attrs)}function WD(n,e,t,r,i,o){for(let l=0;l<r.length;l++)IR(cD(t,e),n,r[l].type);NN(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,c=UD(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=Np(t.mergedAttrs,h.hostAttrs),PN(n,t,e,c,h),RN(c,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}IN(n,t,o)}function CN(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;bN(s)!=a&&s.push(a),s.push(t,r,o)}}function bN(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function SN(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;ll(t)&&kN(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||cD(t,e),ai(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],l=da(e,n,a,t);if(ai(l,e),s!==null&&ON(e,a-i,l,c,t,s),ga(c)){let h=ci(t.index,e);h[On]=da(e,n,a,t)}}}function KD(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=uR();try{si(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];tp(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&AN(c,l)}}finally{si(-1),tp(s)}}function AN(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function xN(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(yM(e,s.selectors,!1))if(r||(r=[]),ga(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;hp(n,e,c)}else r.unshift(s),hp(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function hp(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function MN(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new J(-301,!1);r.push(e[i],o)}}}function RN(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;ga(e)&&(t[""]=n)}}function NN(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function PN(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=po(i.type,!0)),s=new la(o,ga(i),yr);n.blueprint[r]=s,t[r]=s,CN(n,e,r,UD(n,t,i.hostVars,vl),i)}function kN(n,e,t){let r=Xt(e,n),i=zD(t),o=n[Fn].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=Il(n,wl(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function ON(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],l=s[a++],h=s[a++],p=s[a++];jD(r,t,c,l,h,p)}}function FN(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function QD(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function YD(n,e){let t=n.contentQueries;if(t!==null){let r=ve(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];JE(o),a.contentQueries(2,e[s],s)}}}finally{ve(r)}}}function Il(n,e){return n[ca]?n[VI][Zt]=e:n[ca]=e,n[VI]=e,e}function fp(n,e,t){JE(0);let r=ve(null);try{e(n,t)}finally{ve(r)}}function LN(n){return n[jc]??=[]}function VN(n){return n.cleanup??=[]}function ZD(n,e){let t=n[mo],r=t?t.get(Ln,null):null;r&&r.handleError(e)}function ig(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],l=e[s],h=n.data[s];jD(h,l,r,a,c,i)}}function jN(n,e,t){let r=zM(e,n);ZR(n[Tt],r,t)}function UN(n,e){let t=ci(e,n),r=t[de];BN(r,t);let i=t[jn];i!==null&&t[Vc]===null&&(t[Vc]=Zp(i,t[mo])),og(r,t,t[On])}function BN(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function og(n,e,t){Vp(e);try{let r=n.viewQuery;r!==null&&fp(1,r,t);let i=n.template;i!==null&&BD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[vo]?.finishViewCreation(n),n.staticContentQueries&&YD(n,e),n.staticViewQueries&&fp(2,n.viewQuery,t);let o=n.components;o!==null&&$N(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ne]&=-5,jp()}}function $N(n,e){for(let t=0;t<e.length;t++)UN(n,e[t])}function HN(n,e,t,r){let i=ve(null);try{let o=e.tView,a=n[ne]&4096?4096:16,c=wl(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[yo]=l;let h=n[vo];return h!==null&&(c[vo]=h.createEmbeddedView(o)),og(o,c,t),c}finally{ve(i)}}function eE(n,e){return!e||e.firstChild===null||_D(n)}function qN(n,e,t,r=!0){let i=e[de];if(tN(i,e,n,t),r){let s=dp(t,n),a=e[Tt],c=PD(a,n[ii]);c!==null&&XR(i,n[Jt],a,e,c,s)}let o=e[Vc];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Yc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(mn(o)),Un(o)&&zN(o,r);let s=t.type;if(s&8)Yc(n,e,t.child,r);else if(s&32){let a=Jp(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=kD(e,t);if(Array.isArray(a))r.push(...a);else{let c=oi(e[gn]);Yc(c[de],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function zN(n,e){for(let t=Ut;t<n.length;t++){let r=n[t],i=r[de].firstChild;i!==null&&Yc(r[de],r,i,e)}n[ii]!==n[jn]&&e.push(n[ii])}var JD=[];function GN(n){return n[jt]??WN(n)}function WN(n){let e=JD.pop()??Object.create(QN);return e.lView=n,e}function KN(n){n.lView[jt]!==n&&(n.lView=null,JD.push(n))}var QN=Ce(q({},lf),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{fl(n.lView)},consumerOnSignalRead(){this.lView[jt]=this}});function YN(n){let e=n[jt]??Object.create(ZN);return e.lView=n,e}var ZN=Ce(q({},lf),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=oi(n.lView);for(;e&&!XD(e[de]);)e=oi(e);e&&zE(e)},consumerOnSignalRead(){this.lView[jt]=this}});function XD(n){return n.type!==2}var JN=100;function eT(n,e=!0,t=0){let r=n[Fn],i=r.rendererFactory,o=!1;o||i.begin?.();try{XN(n,t)}catch(s){throw e&&ZD(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function XN(n,e){let t=ZE();try{UI(!0),pp(n,e);let r=0;for(;hl(n);){if(r===JN)throw new J(103,!1);r++,pp(n,1)}}finally{UI(t)}}function eP(n,e,t,r){let i=e[ne];if((i&256)===256)return;let o=!1,s=!1;!o&&e[Fn].inlineEffectRunner?.flush(),Vp(e);let a=!0,c=null,l=null;o||(XD(n)?(l=GN(e),c=df(l)):eI()===null?(a=!1,l=YN(e),c=df(l)):e[jt]&&(ff(e[jt]),e[jt]=null));try{qE(e),rR(n.bindingStartIndex),t!==null&&BD(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let y=n.preOrderCheckHooks;y!==null&&Rc(e,y,null)}else{let y=n.preOrderHooks;y!==null&&Nc(e,y,0,null),Lf(e,0)}if(s||tP(e),tT(e,0),n.contentQueries!==null&&YD(n,e),!o)if(h){let y=n.contentCheckHooks;y!==null&&Rc(e,y)}else{let y=n.contentHooks;y!==null&&Nc(e,y,1),Lf(e,1)}pN(n,e);let p=n.components;p!==null&&rT(e,p,0);let m=n.viewQuery;if(m!==null&&fp(2,m,r),!o)if(h){let y=n.viewCheckHooks;y!==null&&Rc(e,y)}else{let y=n.viewHooks;y!==null&&Nc(e,y,2),Lf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Ff]){for(let y of e[Ff])y();e[Ff]=null}o||(e[ne]&=-73)}catch(h){throw o||fl(e),h}finally{l!==null&&(tI(l,c),a&&KN(l)),jp()}}function tT(n,e){for(let t=ED(n);t!==null;t=DD(t))for(let r=Ut;r<t.length;r++){let i=t[r];nT(i,e)}}function tP(n){for(let e=ED(n);e!==null;e=DD(e)){if(!(e[ne]&$c.HasTransplantedViews))continue;let t=e[Bc];for(let r=0;r<t.length;r++){let i=t[r];zE(i)}}}function nP(n,e,t){let r=ci(e,n);nT(r,t)}function nT(n,e){Lp(n)&&pp(n,e)}function pp(n,e){let r=n[de],i=n[ne],o=n[jt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&hf(o)),s||=!1,o&&(o.dirty=!1),n[ne]&=-9217,s)eP(r,n,r.template,n[On]);else if(i&8192){tT(n,1);let a=r.components;a!==null&&rT(n,a,1)}}function rT(n,e,t){for(let r=0;r<e.length;r++)nP(n,e[r],t)}function sg(n,e){let t=ZE()?64:1088;for(n[Fn].changeDetectionScheduler?.notify(e);n;){n[ne]|=t;let r=oi(n);if(Jf(n)&&!r)return n;n=r}return null}var ui=class{get rootNodes(){let e=this._lView,t=e[de];return Yc(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[On]}set context(e){this._lView[On]=e}get destroyed(){return(this._lView[ne]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[yt];if(Un(e)){let t=e[Uc],r=t?t.indexOf(this):-1;r>-1&&(lp(e,r),Fc(t,r))}this._attachedToViewContainer=!1}RD(this._lView[de],this._lView)}onDestroy(e){GE(this._lView,e)}markForCheck(){sg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ne]&=-129}reattach(){ep(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,eT(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new J(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Jf(this._lView),t=this._lView[yo];t!==null&&!e&&Xp(t,this._lView),xD(this._lView[de],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new J(902,!1);this._appRef=e;let t=Jf(this._lView),r=this._lView[yo];r!==null&&!t&&MD(r,this._lView),ep(this._lView)}},ag=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=oP;let n=e;return n})(),rP=ag,iP=class extends rP{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=HN(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new ui(i)}};function oP(){return sP(en(),nt())}function sP(n,e){return n.type&4?new iP(e,n,pl(n,e)):null}var Kq=new RegExp(`^(\\d+)*(${zR}|${qR})*(.*)`);var aP=()=>null;function tE(n,e){return aP(n,e)}var wo=class{},iT=new z("",{providedIn:"root",factory:()=>!1});var oT=new z(""),sT=new z(""),gp=class{},Zc=class{};function uP(n){let e=Error(`No component factory found for ${xt(n)}.`);return e[cP]=n,e}var cP="ngComponent";var mp=class{resolveComponentFactory(e){throw uP(e)}},Ig=class Ig{};Ig.NULL=new mp;var _o=Ig,Io=class{};var lP=(()=>{let e=class e{};e.\u0275prov=W({token:e,providedIn:"root",factory:()=>null});let n=e;return n})();function yp(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=AI(i,a);else if(o==2){let c=a,l=e[++s];r=AI(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Jc=class extends _o{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=fr(e);return new Eo(t,this.ngModule)}};function nE(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:hr.None;e?t.push({propName:s,templateName:r,isSignal:(a&hr.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function dP(n){let e=n.toLowerCase();return e==="svg"?HM:e==="math"?qM:null}var Eo=class extends Zc{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=nE(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return nE(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=IM(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=ve(null);try{i=i||this.ngModule;let s=i instanceof Mt?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new np(e,s):e,c=a.get(Io,null);if(c===null)throw new J(407,!1);let l=a.get(lP,null),h=a.get(wo,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=c.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",C=r?yN(m,r,this.componentDef.encapsulation,a):AD(m,y,dP(y)),A=512;this.componentDef.signals?A|=4096:this.componentDef.onPush||(A|=16);let R=null;C!==null&&(R=Zp(C,a,!0));let L=rg(0,null,null,1,0,null,null,null,null,null,null),$=wl(null,L,null,A,null,null,p,m,a,null,R);Vp($);let O,G,X=null;try{let Q=this.componentDef,I,v=null;Q.findHostDirectiveDefs?(I=[],v=new Map,Q.findHostDirectiveDefs(Q,I,v),I.push(Q)):I=[Q];let _=hP($,C);X=fP(_,C,Q,I,$,p,m),G=HE(L,pr),C&&mP(m,Q,C,r),t!==void 0&&yP(G,this.ngContentSelectors,t),O=gP(X,Q,I,v,$,[vP]),og(L,$,null)}catch(Q){throw X!==null&&up(X),up($),Q}finally{jp()}return new vp(this.componentType,O,pl(G,$),$,G)}finally{ve(o)}}},vp=class extends gp{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new ui(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;ig(o[de],o,i,e,t),this.previousInputValues.set(e,t);let s=ci(this._tNode.index,o);sg(s,1)}}get injector(){return new ri(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function hP(n,e){let t=n[de],r=pr;return n[r]=e,_l(t,r,2,"#host",null)}function fP(n,e,t,r,i,o,s){let a=i[de];pP(r,n,e,s);let c=null;e!==null&&(c=Zp(e,i[mo]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=wl(i,zD(t),null,h,i[n.index],n,o,l,null,null,c);return a.firstCreatePass&&hp(a,n,r.length-1),Il(i,p),i[n.index]=p}function pP(n,e,t,r){for(let i of n)e.mergedAttrs=Np(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(yp(e,e.mergedAttrs,!0),t!==null&&FD(r,t,e))}function gP(n,e,t,r,i,o){let s=en(),a=i[de],c=Xt(s,i);WD(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=da(i,a,p,s);ai(m,i)}KD(a,i,s),c&&ai(c,i);let l=da(i,a,s.directiveStart+s.componentOffset,s);if(n[On]=i[On]=l,o!==null)for(let h of o)h(l,e);return $D(a,s,i),l}function mP(n,e,t,r){if(r)Wf(n,t,["ng-version","18.2.4"]);else{let{attrs:i,classes:o}=EM(e.selectors[0]);i&&Wf(n,t,i),o&&o.length>0&&OD(n,t,o.join(" "))}}function yP(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function vP(){let n=en();Hp(nt()[de],n)}var ya=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=wP;let n=e;return n})();function wP(){let n=en();return IP(n,nt())}var _P=ya,aT=class extends _P{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return pl(this._hostTNode,this._hostLView)}get injector(){return new ri(this._hostTNode,this._hostLView)}get parentInjector(){let e=qp(this._hostTNode,this._hostLView);if(sD(e)){let t=zc(e,this._hostLView),r=qc(e),i=t[de].data[r+8];return new ri(i,t)}else return new ri(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=rE(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Ut}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=tE(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,eE(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!jM(e),a;if(s)a=t;else{let C=t||{};a=C.index,r=C.injector,i=C.projectableNodes,o=C.environmentInjector||C.ngModuleRef}let c=s?e:new Eo(fr(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let A=(s?l:this.parentInjector).get(Mt,null);A&&(o=A)}let h=fr(c.componentType??{}),p=tE(this._lContainer,h?.id??null),m=p?.firstChild??null,y=c.create(l,i,m,o);return this.insertImpl(y.hostView,a,eE(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(GM(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[yt],l=new aT(c,c[Jt],c[yt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return qN(s,i,o,r),e.attachToViewContainerRef(),IE($f(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=rE(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=lp(this._lContainer,t);r&&(Fc($f(this._lContainer),t),RD(r[de],r))}detach(e){let t=this._adjustIndex(e,-1),r=lp(this._lContainer,t);return r&&Fc($f(this._lContainer),t)!=null?new ui(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function rE(n){return n[Uc]}function $f(n){return n[Uc]||(n[Uc]=[])}function IP(n,e){let t,r=e[n.index];return Un(r)?t=r:(t=QD(r,e,null,n),e[n.index]=t,Il(e,t)),DP(t,e,n,r),new aT(t,n,e)}function EP(n,e){let t=n[Tt],r=t.createComment(""),i=Xt(e,n),o=PD(t,i);return Qc(t,o,r,sN(t,i),!1),r}var DP=bP,TP=()=>!1;function CP(n,e,t){return TP(n,e,t)}function bP(n,e,t,r){if(n[ii])return;let i;t.type&8?i=mn(r):i=EP(e,t),n[ii]=i}var iE=new Set;function ug(n){iE.has(n)||(iE.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function SP(n){let e=[],t=new Map;function r(i){let o=t.get(i);if(!o){let s=n(i);t.set(i,o=s.then(RP))}return o}return Xc.forEach((i,o)=>{let s=[];i.templateUrl&&s.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,h=i.styleUrls;i.styleUrls.forEach((p,m)=>{a.push(""),s.push(r(p).then(y=>{a[l+m]=y,h.splice(h.indexOf(p),1),h.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&s.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(s).then(()=>NP(o));e.push(c)}),xP(),Promise.all(e).then(()=>{})}var Xc=new Map,AP=new Set;function xP(){let n=Xc;return Xc=new Map,n}function MP(){return Xc.size===0}function RP(n){return typeof n=="string"?n:n.text()}function NP(n){AP.delete(n)}var gr=class{},ha=class{};var el=class extends gr{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Jc(this);let o=xE(e);this._bootstrapComponents=SD(o.bootstrap),this._r3Injector=mD(e,t,[{provide:gr,useValue:this},{provide:_o,useValue:this.componentFactoryResolver},...r],xt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},tl=class extends ha{constructor(e){super(),this.moduleType=e}create(e){return new el(this.moduleType,e,[])}};function PP(n,e,t){return new el(n,e,t,!1)}var wp=class extends gr{constructor(e){super(),this.componentFactoryResolver=new Jc(this),this.instance=null;let t=new ua([...e.providers,{provide:gr,useValue:this},{provide:_o,useValue:this.componentFactoryResolver}],e.parent||Op(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function El(n,e,t=null){return new wp({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function uT(n){return OP(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function kP(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function OP(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function _p(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function FP(n,e,t,r){let i=_p(n,e,t);return _p(n,e+1,r)||i}function LP(n){return(n.flags&32)===32}function VP(n,e,t,r,i,o,s,a,c){let l=e.consts,h=_l(e,n,4,s||null,a||null);GD(e,t,h,Hc(l,c)),Hp(e,h);let p=h.tView=rg(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function jP(n,e,t,r,i,o,s,a,c,l){let h=t+pr,p=e.firstCreatePass?VP(h,e,n,r,i,o,s,a,c):e.data[h];ma(p,!1);let m=UP(e,n,p,t);Bp()&&eg(e,n,m,p),ai(m,n);let y=QD(m,n,m,p);return n[h]=y,Il(n,y),CP(y,p,n),Fp(p)&&HD(e,n,p),c!=null&&qD(n,p,l),p}function cg(n,e,t,r,i,o,s,a){let c=nt(),l=li(),h=Hc(l.consts,o);return jP(c,l,n,e,t,r,i,h,s,a),cg}var UP=BP;function BP(n,e,t,r){return $p(!0),e[Tt].createComment("")}var lo=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(lo||{}),cT=(()=>{let e=class e{constructor(){this.impl=null}execute(){this.impl?.execute()}};e.\u0275prov=W({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})(),ti=class ti{constructor(){this.ngZone=j(he),this.scheduler=j(wo),this.errorHandler=j(Ln,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}execute(){this.executing=!0;for(let e of ti.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&this.sequences.delete(e);for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}};ti.PHASES=[lo.EarlyRead,lo.Write,lo.MixedReadWrite,lo.Read],ti.\u0275prov=W({token:ti,providedIn:"root",factory:()=>new ti});var Ip=ti,Ep=class{constructor(e,t,r,i){this.impl=e,this.hooks=t,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=i.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy()}};function lg(n,e){!e?.injector&&LM(lg);let t=e?.injector??j(Bt);return KR(t)?(ug("NgAfterNextRender"),HP(n,t,e,!0)):qP}function $P(n,e){if(n instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=n,t}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function HP(n,e,t,r){let i=e.get(cT);i.impl??=e.get(Ip);let o=t?.phase??lo.MixedReadWrite,s=new Ep(i.impl,$P(n,o),r,e.get(Gp));return i.impl.register(s),s}var qP={destroy(){}};function zP(n,e,t,r,i,o){let s=nR(),a=FP(n,s,t,i);return oR(2),a?e+Hf(t)+r+Hf(i)+o:vl}function dg(n,e,t){let r=nt(),i=iR();if(_p(r,i,e)){let o=li(),s=lR();DN(o,s,r,n,e,r[Tt],t,!1)}return dg}function oE(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";ig(n,t,o[s],s,r)}function GP(n,e,t,r,i,o){let s=e.consts,a=Hc(s,i),c=_l(e,n,2,r,a);return GD(e,t,c,Hc(s,o)),c.attrs!==null&&yp(c,c.attrs,!1),c.mergedAttrs!==null&&yp(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function Bn(n,e,t,r){let i=nt(),o=li(),s=pr+n,a=i[Tt],c=o.firstCreatePass?GP(s,o,i,e,t,r):o.data[s],l=WP(o,i,c,a,e,n);i[s]=l;let h=Fp(c);return ma(c,!0),FD(a,l,c),!LP(c)&&Bp()&&eg(o,i,l,c),KM()===0&&ai(l,i),QM(),h&&(HD(o,i,c),$D(o,c,i)),r!==null&&qD(i,c),Bn}function vr(){let n=en();YE()?tR():(n=n.parent,ma(n,!1));let e=n;JM(e)&&XM(),YM();let t=li();return t.firstCreatePass&&(Hp(t,n),VE(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&gR(e)&&oE(t,e,nt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&mR(e)&&oE(t,e,nt(),e.stylesWithoutHost,!1),vr}function va(n,e,t,r){return Bn(n,e,t,r),vr(),va}var WP=(n,e,t,r,i,o)=>($p(!0),AD(r,i,dR()));var nl="en-US";var KP=nl;function QP(n){typeof n=="string"&&(KP=n.toLowerCase().replace(/_/g,"-"))}var YP=(n,e,t)=>{};function Dl(n,e,t,r){let i=nt(),o=li(),s=en();return JP(o,i,i[Tt],s,n,e,r),Dl}function ZP(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[jc],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function JP(n,e,t,r,i,o,s){let a=Fp(r),l=n.firstCreatePass&&VN(n),h=e[On],p=LN(e),m=!0;if(r.type&3||s){let A=Xt(r,e),R=s?s(A):A,L=p.length,$=s?G=>s(mn(G[r.index])):r.index,O=null;if(!s&&a&&(O=ZP(n,e,i,r.index)),O!==null){let G=O.__ngLastListenerFn__||O;G.__ngNextListenerFn__=o,O.__ngLastListenerFn__=o,m=!1}else{o=aE(r,e,h,o),YP(A,i,o);let G=t.listen(R,i,o);p.push(o,G),l&&l.push(i,$,L,L+1)}}else o=aE(r,e,h,o);let y=r.outputs,C;if(m&&y!==null&&(C=y[i])){let A=C.length;if(A)for(let R=0;R<A;R+=2){let L=C[R],$=C[R+1],X=e[L][$].subscribe(o),Q=p.length;p.push(o,X),l&&l.push(i,r.index,Q,-(Q+1))}}}function sE(n,e,t,r){let i=ve(null);try{return hn(6,e,t),t(r)!==!1}catch(o){return ZD(n,o),!1}finally{hn(7,e,t),ve(i)}}function aE(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?ci(n.index,e):e;sg(s,5);let a=sE(e,t,r,o),c=i.__ngNextListenerFn__;for(;c;)a=sE(e,t,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function Co(n,e=""){let t=nt(),r=li(),i=n+pr,o=r.firstCreatePass?_l(r,i,1,e,null):r.data[i],s=XP(r,t,o,e,n);t[i]=s,Bp()&&eg(r,t,s,o),ma(o,!1)}var XP=(n,e,t,r,i)=>($p(!0),YR(e[Tt],r));function hg(n,e,t,r,i){let o=nt(),s=zP(o,n,e,t,r,i);return s!==vl&&jN(o,Up(),s),hg}var ek=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=NE(!1,r.type),o=i.length>0?El([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,o)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=W({token:e,providedIn:"environment",factory:()=>new e(F(Mt))});let n=e;return n})();function lT(n){ug("NgStandalone"),n.getStandaloneInjector=e=>e.get(ek).getOrCreateStandaloneInjector(n)}var Ac=null;function tk(n){Ac!==null&&(n.defaultEncapsulation!==Ac.defaultEncapsulation||n.preserveWhitespaces!==Ac.preserveWhitespaces)||(Ac=n)}var mr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},dT=new mr("18.2.4");var Tl=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var fg=new z(""),wa=new z(""),Cl=(()=>{let e=class e{constructor(r,i,o){this._ngZone=r,this.registry=i,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,pg||(nk(o),o.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,o){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),r()},i)),this._callbacks.push({doneCb:r,timeoutId:s,updateCb:o})}whenStable(r,i,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,o),this._runCallbacksIfReady()}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,o){return[]}};e.\u0275fac=function(i){return new(i||e)(F(he),F(bl),F(wa))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),bl=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return pg?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function nk(n){pg=n}var pg;function _a(n){return!!n&&typeof n.then=="function"}function hT(n){return!!n&&typeof n.subscribe=="function"}var Sl=new z(""),fT=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=j(Sl,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let o of this.appInits){let s=o();if(_a(s))r.push(s);else if(hT(s)){let a=new Promise((c,l)=>{s.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(o=>{this.reject(o)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gg=new z("");function rk(){nI(()=>{throw new J(600,!1)})}function ik(n){return n.isBoundToModule}var ok=10;function sk(n,e,t){try{let r=t();return _a(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function pT(n,e){return Array.isArray(e)?e.reduce(pT,n):q(q({},n),e)}var wr=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=j(LR),this.afterRenderManager=j(cT),this.zonelessEnabled=j(iT),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Ve,this.afterTick=new Ve,this.componentTypes=[],this.components=[],this.isStable=j(To).hasPendingTasks.pipe(ee(r=>!r)),this._injector=j(Mt)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let r;return new Promise(i=>{r=this.isStable.subscribe({next:o=>{o&&i()}})}).finally(()=>{r.unsubscribe()})}get injector(){return this._injector}bootstrap(r,i){let o=r instanceof Zc;if(!this._injector.get(fT).done){let y=!o&&AE(r),C=!1;throw new J(405,C)}let a;o?a=r:a=this._injector.get(_o).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=ik(a)?void 0:this._injector.get(gr),l=i||a.selector,h=a.create(Bt.NULL,[],l,c),p=h.location.nativeElement,m=h.injector.get(fg,null);return m?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),Pc(this.components,h),m?.unregisterApplication(p)}),this._loadComponent(h),h}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new J(101,!1);let r=ve(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,ve(r),this.afterTick.next()}}synchronize(){let r=null;this._injector.destroyed||(r=this._injector.get(Io,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let i=0;for(;this.dirtyFlags!==0&&i++<ok;)this.synchronizeOnce(r)}synchronizeOnce(r){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(i);for(let{_lView:o,notifyErrorHandler:s}of this._views)ak(o,s,i,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else r?.begin?.(),r?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:r})=>hl(r))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Pc(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(gg,[]);[...this._bootstrapListeners,...i].forEach(o=>o(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Pc(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new J(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Pc(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function ak(n,e,t,r){if(!t&&!hl(n))return;eT(n,e,t&&!r?0:1)}var Dp=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Al=(()=>{let e=class e{compileModuleSync(r){return new tl(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),o=xE(r),s=SD(o.declarations).reduce((a,c)=>{let l=fr(c);return l&&a.push(new Eo(l)),a},[]);return new Dp(i,s)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),uk=new z("");function ck(n,e,t){let r=new tl(t);return Promise.resolve(r)}function uE(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var lk=(()=>{let e=class e{constructor(){this.zone=j(he),this.changeDetectionScheduler=j(wo),this.applicationRef=j(wr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function dk({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new he(Ce(q({},gT()),{scheduleInRootZone:t})),[{provide:he,useFactory:n},{provide:go,multi:!0,useFactory:()=>{let r=j(lk,{optional:!0});return()=>r.initialize()}},{provide:go,multi:!0,useFactory:()=>{let r=j(hk);return()=>{r.initialize()}}},e===!0?{provide:oT,useValue:!0}:[],{provide:sT,useValue:t??yD}]}function gT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var hk=(()=>{let e=class e{constructor(){this.subscription=new Oe,this.initialized=!1,this.zone=j(he),this.pendingTasks=j(To)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{he.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{he.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var fk=(()=>{let e=class e{constructor(){this.appRef=j(wr),this.taskService=j(To),this.ngZone=j(he),this.zonelessEnabled=j(iT),this.disableScheduling=j(oT,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Oe,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Wc):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(j(sT,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Kc||!this.zoneIsDefined)}notify(r){if(!this.zonelessEnabled&&r===5)return;switch(r){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let i=this.useMicrotaskScheduler?GI:vD;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Wc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let r=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(r),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,GI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(r)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let r=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(r)}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function pk(){return typeof $localize<"u"&&$localize.locale||nl}var mg=new z("",{providedIn:"root",factory:()=>j(mg,ae.Optional|ae.SkipSelf)||pk()});var yg=new z("");function xc(n){return!!n.platformInjector}function gk(n){let e=xc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(he);return t.run(()=>{xc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Ln,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),xc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(yg);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else n.moduleRef.onDestroy(()=>{Pc(n.allPlatformModules,n.moduleRef),i.unsubscribe()});return sk(r,t,()=>{let o=e.get(fT);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(mg,nl);if(QP(s||nl),xc(n)){let a=e.get(wr);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return mk(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function mk(n,e){let t=n.injector.get(wr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new J(-403,!1);e.push(n)}var mT=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let o=i?.scheduleInRootZone,s=()=>FR(i?.ngZone,Ce(q({},gT({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing})),{scheduleInRootZone:o})),a=i?.ignoreChangesOutsideZone,c=[dk({ngZoneFactory:s,ignoreChangesOutsideZone:a}),{provide:wo,useExisting:fk}],l=PP(r.moduleType,this.injector,c);return gk({moduleRef:l,allPlatformModules:this._modules})}bootstrapModule(r,i=[]){let o=pT({},i);return ck(this.injector,o,r).then(s=>this.bootstrapModuleFactory(s,o))}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new J(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(yg,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(F(Bt))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),oa=null,yT=new z("");function yk(n){if(oa&&!oa.get(yT,!1))throw new J(400,!1);rk(),oa=n;let e=n.get(mT);return _k(n),e}function vg(n,e,t=[]){let r=`Platform: ${e}`,i=new z(r);return(o=[])=>{let s=vT();if(!s||s.injector.get(yT,!1)){let a=[...t,...o,{provide:i,useValue:!0}];n?n(a):yk(vk(a,r))}return wk(i)}}function vk(n=[],e){return Bt.create({name:e,providers:[{provide:ul,useValue:"platform"},{provide:yg,useValue:new Set([()=>oa=null])},...n]})}function wk(n){let e=vT();if(!e)throw new J(401,!1);return e}function vT(){return oa?.get(mT)??null}function _k(n){n.get(Qp,null)?.forEach(t=>t())}function wg(){return!1}var Ia=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Ik;let n=e;return n})();function Ik(n){return Ek(en(),nt(),(n&16)===16)}function Ek(n,e,t){if(ll(n)&&!t){let r=ci(n.index,e);return new ui(r,r)}else if(n.type&175){let r=e[gn];return new ui(r,e)}return null}var Tp=class{constructor(){}supports(e){return uT(e)}create(e){return new Cp(e)}},Dk=(n,e)=>e,Cp=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Dk}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<cE(r,i,o)?t:r,a=cE(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,h=c-i;if(l!=h){for(let m=0;m<l;m++){let y=m<o.length?o[m]:o[m]=0,C=y+m;h<=C&&C<l&&(o[m]=y+1)}let p=s.previousIndex;o[p]=h-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!uT(e))throw new J(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,kP(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new bp(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new rl),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new rl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},bp=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Sp=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},rl=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Sp,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function cE(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function lE(){return new _g([new Tp])}var _g=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let o=i.factories.slice();r=r.concat(o)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||lE()),deps:[[e,new Mp,new Do]]}}find(r){let i=this.factories.find(o=>o.supports(r));if(i!=null)return i;throw new J(901,!1)}};e.\u0275prov=W({token:e,providedIn:"root",factory:lE});let n=e;return n})();var wT=vg(null,"core",[]),_T=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(F(wr))},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({});let n=e;return n})();var IT=new z("");function ET(n){let e=fr(n);if(!e)return null;let t=new Eo(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var ST=null;function hi(){return ST}function AT(n){ST??=n}var xl=class{};var vt=new z(""),Cg=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(Ak),providedIn:"platform"});let n=e;return n})(),xT=new z(""),Ak=(()=>{let e=class e extends Cg{constructor(){super(),this._doc=j(vt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return hi().getBaseHref(this._doc)}onPopState(r){let i=hi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=hi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,o){this._history.pushState(r,i,o)}replaceState(r,i,o){this._history.replaceState(r,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function bg(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function DT(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function $n(n){return n&&n[0]!=="?"?"?"+n:n}var fi=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(Sg),providedIn:"root"});let n=e;return n})(),MT=new z(""),Sg=(()=>{let e=class e extends fi{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??j(vt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return bg(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+$n(this._platformLocation.search),o=this._platformLocation.hash;return o&&r?`${i}${o}`:i}pushState(r,i,o,s){let a=this.prepareExternalUrl(o+$n(s));this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){let a=this.prepareExternalUrl(o+$n(s));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(F(Cg),F(MT,8))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),RT=(()=>{let e=class e extends fi{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=bg(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,o,s){let a=this.prepareExternalUrl(o+$n(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){let a=this.prepareExternalUrl(o+$n(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(F(Cg),F(MT,8))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),bo=(()=>{let e=class e{constructor(r){this._subject=new mt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Rk(DT(TT(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+$n(i))}normalize(r){return e.stripTrailingSlash(Mk(this._basePath,TT(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",o=null){this._locationStrategy.pushState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+$n(i)),o)}replaceState(r,i="",o=null){this._locationStrategy.replaceState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+$n(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(o=>o(r,i))}subscribe(r,i,o){return this._subject.subscribe({next:r,error:i,complete:o})}};e.normalizeQueryParams=$n,e.joinWithSlash=bg,e.stripTrailingSlash=DT,e.\u0275fac=function(i){return new(i||e)(F(fi))},e.\u0275prov=W({token:e,factory:()=>xk(),providedIn:"root"});let n=e;return n})();function xk(){return new bo(F(fi))}function Mk(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function TT(n){return n.replace(/\/index.html$/,"")}function Rk(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function NT(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Eg=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},PT=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,o){this._viewContainer=r,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((o,s,a)=>{if(o.previousIndex==null)i.createEmbeddedView(this._template,new Eg(o.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(s===null?void 0:s);else if(s!==null){let c=i.get(s);i.move(c,a),CT(c,o)}});for(let o=0,s=i.length;o<s;o++){let c=i.get(o).context;c.index=o,c.count=s,c.ngForOf=this._ngForOf}r.forEachIdentityChange(o=>{let s=i.get(o.currentIndex);CT(s,o)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(yr(ya),yr(ag),yr(_g))},e.\u0275dir=al({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function CT(n,e){n.context.$implicit=e.item}var kT=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({});let n=e;return n})(),Ag="browser",Nk="server";function Pk(n){return n===Ag}function pi(n){return n===Nk}var OT=(()=>{let e=class e{};e.\u0275prov=W({token:e,providedIn:"root",factory:()=>Pk(j(Ct))?new Dg(j(vt),window):new Tg});let n=e;return n})(),Dg=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=kk(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function kk(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}var Tg=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Ml=class{};var Rg=class extends xl{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ng=class n extends Rg{static makeCurrent(){AT(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Lk();return t==null?null:Vk(t)}resetBaseElement(){Ea=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return NT(document.cookie,e)}},Ea=null;function Lk(){return Ea=Ea||document.querySelector("base"),Ea?Ea.getAttribute("href"):null}function Vk(n){return new URL(n,document.baseURI).pathname}var Pg=class{addToWindow(e){Vn.getAngularTestability=(r,i=!0)=>{let o=e.findTestabilityInTree(r,i);if(o==null)throw new J(5103,!1);return o},Vn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Vn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Vn.getAllAngularTestabilities(),o=i.length,s=function(){o--,o==0&&r()};i.forEach(a=>{a.whenStable(s)})};Vn.frameworkStabilizers||(Vn.frameworkStabilizers=[]),Vn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?hi().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},jk=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),Rl=new z(""),jT=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(o=>{o.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,o){return this._findPluginFor(i).addEventListener(r,i,o)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(s=>s.supports(r)),!i)throw new J(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(F(Rl),F(he))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),Da=class{constructor(e){this._doc=e}},xg="ng-app-id",UT=(()=>{let e=class e{constructor(r,i,o,s={}){this.doc=r,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=pi(s),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(o=>o.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${xg}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(o=>{o.textContent!=null&&i.set(o.textContent,o)}),i}return null}changeUsageCount(r,i){let o=this.styleRef;if(o.has(r)){let s=o.get(r);return s.usage+=i,s.usage}return o.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===r)return o.delete(i),s.removeAttribute(xg),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(xg,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let o=this.getStyleElement(r,i),s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(F(vt),F(ml),F(Yp,8),F(Ct))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),Mg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Og=/%COMP%/g,BT="%COMP%",Uk=`_nghost-${BT}`,Bk=`_ngcontent-${BT}`,$k=!0,Hk=new z("",{providedIn:"root",factory:()=>$k});function qk(n){return Bk.replace(Og,n)}function zk(n){return Uk.replace(Og,n)}function $T(n,e){return e.map(t=>t.replace(Og,n))}var FT=(()=>{let e=class e{constructor(r,i,o,s,a,c,l,h=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=pi(c),this.defaultRenderer=new Ta(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===pn.ShadowDom&&(i=Ce(q({},i),{encapsulation:pn.Emulated}));let o=this.getOrCreateRenderer(r,i);return o instanceof Nl?o.applyToHost(r):o instanceof Ca&&o.applyStyles(),o}getOrCreateRenderer(r,i){let o=this.rendererByCompId,s=o.get(i.id);if(!s){let a=this.doc,c=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case pn.Emulated:s=new Nl(l,h,i,this.appId,p,a,c,m);break;case pn.ShadowDom:return new kg(l,h,r,i,a,c,this.nonce,m);default:s=new Ca(l,h,i,p,a,c,m);break}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(F(jT),F(UT),F(ml),F(Hk),F(vt),F(Ct),F(he),F(Yp))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),Ta=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Mg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(LT(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(LT(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new J(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Mg[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Mg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(di.DashCase|di.Important)?e.style.setProperty(t,r,i&di.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&di.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=hi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function LT(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var kg=class extends Ta{constructor(e,t,r,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=$T(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ca=class extends Ta{constructor(e,t,r,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?$T(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Nl=class extends Ca{constructor(e,t,r,i,o,s,a,c){let l=i+"-"+r.id;super(e,t,r,o,s,a,c,l),this.contentAttr=qk(l),this.hostAttr=zk(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Gk=(()=>{let e=class e extends Da{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,o){return r.addEventListener(i,o,!1),()=>this.removeEventListener(r,i,o)}removeEventListener(r,i,o){return r.removeEventListener(i,o)}};e.\u0275fac=function(i){return new(i||e)(F(vt))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),Wk=(()=>{let e=class e extends Da{constructor(r){super(r),this.delegate=j(IT,{optional:!0})}supports(r){return this.delegate?this.delegate.supports(r):!1}addEventListener(r,i,o){return this.delegate.addEventListener(r,i,o)}removeEventListener(r,i,o){return this.delegate.removeEventListener(r,i,o)}};e.\u0275fac=function(i){return new(i||e)(F(vt))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})(),VT=["alt","control","meta","shift"],Kk={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Qk={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Yk=(()=>{let e=class e extends Da{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,o){let s=e.parseEventName(i),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hi().onAndCancel(r,s.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let s=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),VT.forEach(h=>{let p=i.indexOf(h);p>-1&&(i.splice(p,1),a+=h+".")}),a+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=o,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let o=Kk[r.key]||r.key,s="";return i.indexOf("code.")>-1&&(o=r.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),VT.forEach(a=>{if(a!==o){let c=Qk[a];c(r)&&(s+=a+".")}}),s+=o,s===i)}static eventCallback(r,i,o){return s=>{e.matchEventFullKeyCode(s,r)&&o.runGuarded(()=>i(s))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(F(vt))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})();function Zk(){Ng.makeCurrent()}function Jk(){return new Ln}function Xk(){return CD(document),document}var e1=[{provide:Ct,useValue:Ag},{provide:Qp,useValue:Zk,multi:!0},{provide:vt,useFactory:Xk,deps:[]}],HT=vg(wT,"browser",e1),t1=new z(""),n1=[{provide:wa,useClass:Pg,deps:[]},{provide:fg,useClass:Cl,deps:[he,bl,wa]},{provide:Cl,useClass:Cl,deps:[he,bl,wa]}],r1=[{provide:ul,useValue:"root"},{provide:Ln,useFactory:Jk,deps:[]},{provide:Rl,useClass:Gk,multi:!0,deps:[vt,he,Ct]},{provide:Rl,useClass:Yk,multi:!0,deps:[vt]},{provide:Rl,useClass:Wk,multi:!0},FT,UT,jT,{provide:Io,useExisting:FT},{provide:Ml,useClass:jk,deps:[]},[]],qT=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:ml,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(F(t1,12))},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({providers:[...r1,...n1],imports:[kT,_T]});let n=e;return n})();var zT=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(F(vt))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var i1="firebase",o1="10.13.1";sr(i1,o1,"app");var So=new mr("ANGULARFIRE2_VERSION");var s1=(n,e)=>{let t=e?[e]:J_(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},gi=class{constructor(){return s1(a1)}},a1="app-check";function Fg(){}var Pl=class{zone;delegate;constructor(e,t=bf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Lg=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Fg,{},Fg,Fg)),t.pipe(Qe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},kl=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Pl(Zone.current)),this.insideAngular=t.run(()=>new Pl(Zone.current,Xs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(F(he))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function u1(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function bt(n){return c1(u1())(n)}function c1(n){return function(t){return t=t.lift(new Lg(n.ngZone)),t.pipe(Qt(n.outsideAngular),Ot(n.insideAngular))}}var l1="firebase",d1="10.13.1";Et.registerVersion(l1,d1,"app-compat");var h1=["ngOnDestroy"],QT=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(h1.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var Ol=class{constructor(e){return e}},Ao=new z("angularfire2.app.options"),xo=new z("angularfire2.app.name");function ba(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Et.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Et.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;f1("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Ol(s)}var f1=(n,...e)=>{wg()&&typeof console<"u"&&console[n](...e)},p1={provide:Ol,useFactory:ba,deps:[Ao,he,[new Do,xo]]},YT=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Ao,useValue:t},{provide:xo,useValue:r}]}}constructor(t){Et.registerVersion("angularfire",So.full,"core"),Et.registerVersion("angularfire",So.full,"app-compat"),Et.registerVersion("angular",dT.full,t.toString())}static \u0275fac=function(r){return new(r||n)(F(Ct))};static \u0275mod=ct({type:n});static \u0275inj=ut({providers:[p1]})}return n})();function Fl(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return g1(i,s)||(KT("error",`${e} was already initialized on the ${t} Firebase App with different settings.${m1?" You may need to reload as Firebase is not HMR aware.":""}`),KT("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function g1(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var m1=typeof module<"u"&&!!module.hot,KT=(n,...e)=>{wg()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var w1=new Map,_1={activated:!1,tokenObservers:[]},I1={initialized:!1,enabled:!1};function nn(n){return w1.get(n)||Object.assign({},_1)}function tC(){return I1}var E1="https://content-firebaseappcheck.googleapis.com/v1";var D1="exchangeDebugToken",ZT={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},yz=24*60*60*1e3;var jg=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return N(this,null,function*(){this.stop();try{this.pending=new of,this.pending.promise.catch(t=>{}),yield T1(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new of,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function T1(n){return new Promise(e=>{setTimeout(e,n)})}var C1={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},_r=new Y_("appCheck","AppCheck",C1);function nC(n){if(!nn(n).activated)throw _r.create("use-before-activation",{appName:n.name})}function rC(r,i){return N(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let y=yield s.getHeartbeatsHeader();y&&(o["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(y){throw _r.create("fetch-network-error",{originalErrorMessage:y?.message})}if(c.status!==200)throw _r.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(y){throw _r.create("fetch-parse-error",{originalErrorMessage:y?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw _r.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function iC(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${E1}/projects/${t}/apps/${r}:${D1}?key=${i}`,body:{debug_token:e}}}var b1="firebase-app-check-database",S1=1,Ug="firebase-app-check-store";var Ll=null;function A1(){return Ll||(Ll=new Promise((n,e)=>{try{let t=indexedDB.open(b1,S1);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(_r.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ug,{keyPath:"compositeKey"})}}}catch(t){e(_r.create("storage-open",{originalErrorMessage:t?.message}))}}),Ll)}function x1(n,e){return M1(R1(n),e)}function M1(n,e){return N(this,null,function*(){let r=(yield A1()).transaction(Ug,"readwrite"),o=r.objectStore(Ug).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(_r.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function R1(n){return`${n.options.appId}-${n.name}`}var Bg=new rc("@firebase/app-check");function Vg(n,e){return nc()?x1(n,e).catch(t=>{Bg.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function oC(){return tC().enabled}function sC(){return N(this,null,function*(){let n=tC();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var N1={error:"UNKNOWN_ERROR"};function P1(n){return W_.encodeString(JSON.stringify(n),!1)}function $g(n,e=!1){return N(this,null,function*(){let t=n.app;nC(t);let r=nn(t),i=r.token,o;if(i&&!Sa(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Sa(c)?i=c:yield Vg(t,void 0))}if(!e&&i&&Sa(i))return{token:i.token};let s=!1;if(oC()){r.exchangeTokenPromise||(r.exchangeTokenPromise=rC(iC(t,yield sC()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield Vg(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield nn(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Bg.warn(c.message):Bg.error(c),o=c}let a;return i?o?Sa(i)?a={token:i.token,internalError:o}:a=XT(o):(a={token:i.token},r.token=i,yield Vg(t,i)):a=XT(o),s&&L1(t,a),a})}function k1(n){return N(this,null,function*(){let e=n.app;nC(e);let{provider:t}=nn(e);if(oC()){let r=yield sC(),{token:i}=yield rC(iC(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function O1(n,e,t,r){let{app:i}=n,o=nn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Sa(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),JT(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>JT(n))}function aC(n,e){let t=nn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function JT(n){let{app:e}=n,t=nn(e),r=t.tokenRefresher;r||(r=F1(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function F1(n){let{app:e}=n;return new jg(()=>N(this,null,function*(){let t=nn(e),r;if(t.token?r=yield $g(n,!0):r=yield $g(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=nn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},ZT.RETRIAL_MIN_WAIT,ZT.RETRIAL_MAX_WAIT)}function L1(n,e){let t=nn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Sa(n){return n.expireTimeMillis-Date.now()>0}function XT(n){return{token:P1(N1),error:n}}var Hg=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=nn(this.app);for(let t of e)aC(this.app,t.next);return Promise.resolve()}};function V1(n,e){return new Hg(n,e)}function j1(n){return{getToken:e=>$g(n,e),getLimitedUseToken:()=>k1(n),addTokenListener:e=>O1(n,"INTERNAL",e),removeTokenListener:e=>aC(n.app,e)}}var U1="@firebase/app-check",B1="0.8.7";var $1="app-check",eC="app-check-internal";function H1(){Qs(new Wr($1,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return V1(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(eC).initialize()})),Qs(new Wr(eC,n=>{let e=n.getProvider("app-check").getImmediate();return j1(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),sr(U1,B1)}H1();var q1=["localhost","0.0.0.0","127.0.0.1"],xz=typeof window<"u"&&q1.includes(window.location.hostname);var qg=new z("angularfire2.auth.use-emulator"),zg=new z("angularfire2.auth.settings"),Gg=new z("angularfire2.auth.tenant-id"),Wg=new z("angularfire2.auth.langugage-code"),Kg=new z("angularfire2.auth.use-device-language"),Qg=new z("angularfire.auth.persistence"),Yg=(n,e,t,r,i,o,s,a)=>Fl(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))c.settings[l]=h;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),cC=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,l,h,p,m,y){let C=new Ve,A=Z(void 0).pipe(Ot(s.outsideAngular),Fe(()=>o.runOutsideAngular(()=>import("./chunk-NYQ6UCC6.js"))),ee(()=>ba(t,o,r)),ee(R=>Yg(R,o,a,l,h,p,c,m)),Cc({bufferSize:1,refCount:!1}));if(pi(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Z(null);else{A.pipe(Ft()).subscribe();let R=A.pipe(Fe(O=>O.getRedirectResult().then(G=>G,()=>null)),bt,Cc({bufferSize:1,refCount:!1})),L=A.pipe(Fe(O=>new le(G=>({unsubscribe:o.runOutsideAngular(()=>O.onAuthStateChanged(X=>G.next(X),X=>G.error(X),()=>G.complete()))})))),$=A.pipe(Fe(O=>new le(G=>({unsubscribe:o.runOutsideAngular(()=>O.onIdTokenChanged(X=>G.next(X),X=>G.error(X),()=>G.complete()))}))));this.authState=R.pipe(bc(L),Qt(s.outsideAngular),Ot(s.insideAngular)),this.user=R.pipe(bc($),Qt(s.outsideAngular),Ot(s.insideAngular)),this.idToken=this.user.pipe(Fe(O=>O?we(O.getIdToken()):Z(null))),this.idTokenResult=this.user.pipe(Fe(O=>O?we(O.getIdTokenResult()):Z(null))),this.credential=xf(R,C,this.authState.pipe(tt(O=>!O))).pipe(ee(O=>O?.user?O:null),Qt(s.outsideAngular),Ot(s.insideAngular))}return QT(this,A,o,{spy:{apply:(R,L,$)=>{(R.startsWith("signIn")||R.startsWith("createUser"))&&$.then(O=>C.next(O))}}})}static \u0275fac=function(r){return new(r||n)(F(Ao),F(xo,8),F(Ct),F(he),F(kl),F(qg,8),F(zg,8),F(Gg,8),F(Wg,8),F(Kg,8),F(Qg,8),F(gi,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var lC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dC={};var Ir,Zg;(function(){var n;function e(I,v){function _(){}_.prototype=v.prototype,I.D=v.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(E,D,b){for(var w=Array(arguments.length-2),xn=2;xn<arguments.length;xn++)w[xn-2]=arguments[xn];return v.prototype[D].apply(E,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,_){_||(_=0);var E=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)E[D]=v.charCodeAt(_++)|v.charCodeAt(_++)<<8|v.charCodeAt(_++)<<16|v.charCodeAt(_++)<<24;else for(D=0;16>D;++D)E[D]=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24;v=I.g[0],_=I.g[1],D=I.g[2];var b=I.g[3],w=v+(b^_&(D^b))+E[0]+3614090360&4294967295;v=_+(w<<7&4294967295|w>>>25),w=b+(D^v&(_^D))+E[1]+3905402710&4294967295,b=v+(w<<12&4294967295|w>>>20),w=D+(_^b&(v^_))+E[2]+606105819&4294967295,D=b+(w<<17&4294967295|w>>>15),w=_+(v^D&(b^v))+E[3]+3250441966&4294967295,_=D+(w<<22&4294967295|w>>>10),w=v+(b^_&(D^b))+E[4]+4118548399&4294967295,v=_+(w<<7&4294967295|w>>>25),w=b+(D^v&(_^D))+E[5]+1200080426&4294967295,b=v+(w<<12&4294967295|w>>>20),w=D+(_^b&(v^_))+E[6]+2821735955&4294967295,D=b+(w<<17&4294967295|w>>>15),w=_+(v^D&(b^v))+E[7]+4249261313&4294967295,_=D+(w<<22&4294967295|w>>>10),w=v+(b^_&(D^b))+E[8]+1770035416&4294967295,v=_+(w<<7&4294967295|w>>>25),w=b+(D^v&(_^D))+E[9]+2336552879&4294967295,b=v+(w<<12&4294967295|w>>>20),w=D+(_^b&(v^_))+E[10]+4294925233&4294967295,D=b+(w<<17&4294967295|w>>>15),w=_+(v^D&(b^v))+E[11]+2304563134&4294967295,_=D+(w<<22&4294967295|w>>>10),w=v+(b^_&(D^b))+E[12]+1804603682&4294967295,v=_+(w<<7&4294967295|w>>>25),w=b+(D^v&(_^D))+E[13]+4254626195&4294967295,b=v+(w<<12&4294967295|w>>>20),w=D+(_^b&(v^_))+E[14]+2792965006&4294967295,D=b+(w<<17&4294967295|w>>>15),w=_+(v^D&(b^v))+E[15]+1236535329&4294967295,_=D+(w<<22&4294967295|w>>>10),w=v+(D^b&(_^D))+E[1]+4129170786&4294967295,v=_+(w<<5&4294967295|w>>>27),w=b+(_^D&(v^_))+E[6]+3225465664&4294967295,b=v+(w<<9&4294967295|w>>>23),w=D+(v^_&(b^v))+E[11]+643717713&4294967295,D=b+(w<<14&4294967295|w>>>18),w=_+(b^v&(D^b))+E[0]+3921069994&4294967295,_=D+(w<<20&4294967295|w>>>12),w=v+(D^b&(_^D))+E[5]+3593408605&4294967295,v=_+(w<<5&4294967295|w>>>27),w=b+(_^D&(v^_))+E[10]+38016083&4294967295,b=v+(w<<9&4294967295|w>>>23),w=D+(v^_&(b^v))+E[15]+3634488961&4294967295,D=b+(w<<14&4294967295|w>>>18),w=_+(b^v&(D^b))+E[4]+3889429448&4294967295,_=D+(w<<20&4294967295|w>>>12),w=v+(D^b&(_^D))+E[9]+568446438&4294967295,v=_+(w<<5&4294967295|w>>>27),w=b+(_^D&(v^_))+E[14]+3275163606&4294967295,b=v+(w<<9&4294967295|w>>>23),w=D+(v^_&(b^v))+E[3]+4107603335&4294967295,D=b+(w<<14&4294967295|w>>>18),w=_+(b^v&(D^b))+E[8]+1163531501&4294967295,_=D+(w<<20&4294967295|w>>>12),w=v+(D^b&(_^D))+E[13]+2850285829&4294967295,v=_+(w<<5&4294967295|w>>>27),w=b+(_^D&(v^_))+E[2]+4243563512&4294967295,b=v+(w<<9&4294967295|w>>>23),w=D+(v^_&(b^v))+E[7]+1735328473&4294967295,D=b+(w<<14&4294967295|w>>>18),w=_+(b^v&(D^b))+E[12]+2368359562&4294967295,_=D+(w<<20&4294967295|w>>>12),w=v+(_^D^b)+E[5]+4294588738&4294967295,v=_+(w<<4&4294967295|w>>>28),w=b+(v^_^D)+E[8]+2272392833&4294967295,b=v+(w<<11&4294967295|w>>>21),w=D+(b^v^_)+E[11]+1839030562&4294967295,D=b+(w<<16&4294967295|w>>>16),w=_+(D^b^v)+E[14]+4259657740&4294967295,_=D+(w<<23&4294967295|w>>>9),w=v+(_^D^b)+E[1]+2763975236&4294967295,v=_+(w<<4&4294967295|w>>>28),w=b+(v^_^D)+E[4]+1272893353&4294967295,b=v+(w<<11&4294967295|w>>>21),w=D+(b^v^_)+E[7]+4139469664&4294967295,D=b+(w<<16&4294967295|w>>>16),w=_+(D^b^v)+E[10]+3200236656&4294967295,_=D+(w<<23&4294967295|w>>>9),w=v+(_^D^b)+E[13]+681279174&4294967295,v=_+(w<<4&4294967295|w>>>28),w=b+(v^_^D)+E[0]+3936430074&4294967295,b=v+(w<<11&4294967295|w>>>21),w=D+(b^v^_)+E[3]+3572445317&4294967295,D=b+(w<<16&4294967295|w>>>16),w=_+(D^b^v)+E[6]+76029189&4294967295,_=D+(w<<23&4294967295|w>>>9),w=v+(_^D^b)+E[9]+3654602809&4294967295,v=_+(w<<4&4294967295|w>>>28),w=b+(v^_^D)+E[12]+3873151461&4294967295,b=v+(w<<11&4294967295|w>>>21),w=D+(b^v^_)+E[15]+530742520&4294967295,D=b+(w<<16&4294967295|w>>>16),w=_+(D^b^v)+E[2]+3299628645&4294967295,_=D+(w<<23&4294967295|w>>>9),w=v+(D^(_|~b))+E[0]+4096336452&4294967295,v=_+(w<<6&4294967295|w>>>26),w=b+(_^(v|~D))+E[7]+1126891415&4294967295,b=v+(w<<10&4294967295|w>>>22),w=D+(v^(b|~_))+E[14]+2878612391&4294967295,D=b+(w<<15&4294967295|w>>>17),w=_+(b^(D|~v))+E[5]+4237533241&4294967295,_=D+(w<<21&4294967295|w>>>11),w=v+(D^(_|~b))+E[12]+1700485571&4294967295,v=_+(w<<6&4294967295|w>>>26),w=b+(_^(v|~D))+E[3]+2399980690&4294967295,b=v+(w<<10&4294967295|w>>>22),w=D+(v^(b|~_))+E[10]+4293915773&4294967295,D=b+(w<<15&4294967295|w>>>17),w=_+(b^(D|~v))+E[1]+2240044497&4294967295,_=D+(w<<21&4294967295|w>>>11),w=v+(D^(_|~b))+E[8]+1873313359&4294967295,v=_+(w<<6&4294967295|w>>>26),w=b+(_^(v|~D))+E[15]+4264355552&4294967295,b=v+(w<<10&4294967295|w>>>22),w=D+(v^(b|~_))+E[6]+2734768916&4294967295,D=b+(w<<15&4294967295|w>>>17),w=_+(b^(D|~v))+E[13]+1309151649&4294967295,_=D+(w<<21&4294967295|w>>>11),w=v+(D^(_|~b))+E[4]+4149444226&4294967295,v=_+(w<<6&4294967295|w>>>26),w=b+(_^(v|~D))+E[11]+3174756917&4294967295,b=v+(w<<10&4294967295|w>>>22),w=D+(v^(b|~_))+E[2]+718787259&4294967295,D=b+(w<<15&4294967295|w>>>17),w=_+(b^(D|~v))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(D+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var _=v-this.blockSize,E=this.B,D=this.h,b=0;b<v;){if(D==0)for(;b<=_;)i(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<v;)if(E[D++]=I.charCodeAt(b++),D==this.blockSize){i(this,E),D=0;break}}else for(;b<v;)if(E[D++]=I[b++],D==this.blockSize){i(this,E),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var _=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=_&255,_/=256;for(this.u(I),I=Array(16),v=_=0;4>v;++v)for(var E=0;32>E;E+=8)I[_++]=this.g[v]>>>E&255;return I};function o(I,v){var _=a;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=v(I)}function s(I,v){this.h=v;for(var _=[],E=!0,D=I.length-1;0<=D;D--){var b=I[D]|0;E&&b==v||(_[D]=b,E=!1)}this.g=_}var a={};function c(I){return-128<=I&&128>I?o(I,function(v){return new s([v|0],0>v?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return R(l(-I));for(var v=[],_=1,E=0;I>=_;E++)v[E]=I/_|0,_*=4294967296;return new s(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return R(h(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(v,8)),E=p,D=0;D<I.length;D+=8){var b=Math.min(8,I.length-D),w=parseInt(I.substring(D,D+b),v);8>b?(b=l(Math.pow(v,b)),E=E.j(b).add(l(w))):(E=E.j(_),E=E.add(l(w)))}return E}var p=c(0),m=c(1),y=c(16777216);n=s.prototype,n.m=function(){if(A(this))return-R(this).m();for(var I=0,v=1,_=0;_<this.g.length;_++){var E=this.i(_);I+=(0<=E?E:4294967296+E)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C(this))return"0";if(A(this))return"-"+R(this).toString(I);for(var v=l(Math.pow(I,6)),_=this,E="";;){var D=G(_,v).g;_=L(_,D.j(v));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=D,C(_))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function C(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function A(I){return I.h==-1}n.l=function(I){return I=L(this,I),A(I)?-1:C(I)?0:1};function R(I){for(var v=I.g.length,_=[],E=0;E<v;E++)_[E]=~I.g[E];return new s(_,~I.h).add(m)}n.abs=function(){return A(this)?R(this):this},n.add=function(I){for(var v=Math.max(this.g.length,I.g.length),_=[],E=0,D=0;D<=v;D++){var b=E+(this.i(D)&65535)+(I.i(D)&65535),w=(b>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);E=w>>>16,b&=65535,w&=65535,_[D]=w<<16|b}return new s(_,_[_.length-1]&-2147483648?-1:0)};function L(I,v){return I.add(R(v))}n.j=function(I){if(C(this)||C(I))return p;if(A(this))return A(I)?R(this).j(R(I)):R(R(this).j(I));if(A(I))return R(this.j(R(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var v=this.g.length+I.g.length,_=[],E=0;E<2*v;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var D=0;D<I.g.length;D++){var b=this.i(E)>>>16,w=this.i(E)&65535,xn=I.i(D)>>>16,xs=I.i(D)&65535;_[2*E+2*D]+=w*xs,$(_,2*E+2*D),_[2*E+2*D+1]+=b*xs,$(_,2*E+2*D+1),_[2*E+2*D+1]+=w*xn,$(_,2*E+2*D+1),_[2*E+2*D+2]+=b*xn,$(_,2*E+2*D+2)}for(E=0;E<v;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=v;E<2*v;E++)_[E]=0;return new s(_,0)};function $(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function O(I,v){this.g=I,this.h=v}function G(I,v){if(C(v))throw Error("division by zero");if(C(I))return new O(p,p);if(A(I))return v=G(R(I),v),new O(R(v.g),R(v.h));if(A(v))return v=G(I,R(v)),new O(R(v.g),v.h);if(30<I.g.length){if(A(I)||A(v))throw Error("slowDivide_ only works with positive integers.");for(var _=m,E=v;0>=E.l(I);)_=X(_),E=X(E);var D=Q(_,1),b=Q(E,1);for(E=Q(E,2),_=Q(_,2);!C(E);){var w=b.add(E);0>=w.l(I)&&(D=D.add(_),b=w),E=Q(E,1),_=Q(_,1)}return v=L(I,D.j(v)),new O(D,v)}for(D=p;0<=I.l(v);){for(_=Math.max(1,Math.floor(I.m()/v.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=l(_),w=b.j(v);A(w)||0<w.l(I);)_-=E,b=l(_),w=b.j(v);C(b)&&(b=m),D=D.add(b),I=L(I,w)}return new O(D,I)}n.A=function(I){return G(this,I).h},n.and=function(I){for(var v=Math.max(this.g.length,I.g.length),_=[],E=0;E<v;E++)_[E]=this.i(E)&I.i(E);return new s(_,this.h&I.h)},n.or=function(I){for(var v=Math.max(this.g.length,I.g.length),_=[],E=0;E<v;E++)_[E]=this.i(E)|I.i(E);return new s(_,this.h|I.h)},n.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),_=[],E=0;E<v;E++)_[E]=this.i(E)^I.i(E);return new s(_,this.h^I.h)};function X(I){for(var v=I.g.length+1,_=[],E=0;E<v;E++)_[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(_,I.h)}function Q(I,v){var _=v>>5;v%=32;for(var E=I.g.length-_,D=[],b=0;b<E;b++)D[b]=0<v?I.i(b+_)>>>v|I.i(b+_+1)<<32-v:I.i(b+_);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Zg=dC.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,Ir=dC.Integer=s}).apply(typeof lC<"u"?lC:typeof self<"u"?self:typeof window<"u"?window:{});var Vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hn={};var Jg,Xg,Mo,em,Aa,jl,tm,nm,rm;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,d,f){return u==Array.prototype||u==Object.prototype||(u[d]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vl=="object"&&Vl];for(var d=0;d<u.length;++d){var f=u[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,d){if(d)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var T=u[g];if(!(T in f))break e;f=f[T]}u=u[u.length-1],g=f[u],d=d(g),d!=g&&d!=null&&e(f,u,{configurable:!0,writable:!0,value:d})}}function o(u,d){u instanceof String&&(u+="");var f=0,g=!1,T={next:function(){if(!g&&f<u.length){var M=f++;return{value:d(M,u[M]),done:!1}}return g=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(u){return u||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function c(u){var d=typeof u;return d=d!="object"?d:u?Array.isArray(u)?"array":d:"null",d=="array"||d=="object"&&typeof u.length=="number"}function l(u){var d=typeof u;return d=="object"&&u!=null||d=="function"}function h(u,d,f){return u.call.apply(u.bind,arguments)}function p(u,d,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,g),u.apply(d,T)}}return function(){return u.apply(d,arguments)}}function m(u,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function y(u,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function C(u,d){function f(){}f.prototype=d.prototype,u.aa=d.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,T,M){for(var V=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)V[Ee-2]=arguments[Ee];return d.prototype[T].apply(g,V)}}function A(u){let d=u.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=u[g];return f}return[]}function R(u,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let T=u.length||0,M=g.length||0;u.length=T+M;for(let V=0;V<M;V++)u[T+V]=g[V]}else u.push(g)}}class L{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function $(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function G(u){return G[" "](u),u}G[" "]=function(){};var X=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function Q(u,d,f){for(let g in u)d.call(f,u[g],g,u)}function I(u,d){for(let f in u)d.call(void 0,u[f],f,u)}function v(u){let d={};for(let f in u)d[f]=u[f];return d}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,d){let f,g;for(let T=1;T<arguments.length;T++){g=arguments[T];for(f in g)u[f]=g[f];for(let M=0;M<_.length;M++)f=_[M],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function D(u){var d=1;u=u.split(":");let f=[];for(;0<d&&u.length;)f.push(u.shift()),d--;return u.length&&f.push(u.join(":")),f}function b(u){a.setTimeout(()=>{throw u},0)}function w(){var u=Nh;let d=null;return u.g&&(d=u.g,u.g=u.g.next,u.g||(u.h=null),d.next=null),d}class xn{constructor(){this.h=this.g=null}add(d,f){let g=xs.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var xs=new L(()=>new VA,u=>u.reset());class VA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Ms,Rs=!1,Nh=new xn,Hw=()=>{let u=a.Promise.resolve(void 0);Ms=()=>{u.then(jA)}};var jA=()=>{for(var u;u=w();){try{u.h.call(u.g)}catch(f){b(f)}var d=xs;d.j(u),100>d.h&&(d.h++,u.next=d.g,d.g=u)}Rs=!1};function nr(){this.s=this.s,this.C=this.C}nr.prototype.s=!1,nr.prototype.ma=function(){this.s||(this.s=!0,this.N())},nr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function it(u,d){this.type=u,this.g=this.target=d,this.defaultPrevented=!1}it.prototype.h=function(){this.defaultPrevented=!0};var UA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,d=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return u}();function Ns(u,d){if(it.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=d,d=u.relatedTarget){if(X){e:{try{G(d.nodeName);var T=!0;break e}catch{}T=!1}T||(d=null)}}else f=="mouseover"?d=u.fromElement:f=="mouseout"&&(d=u.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:BA[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ns.aa.h.call(this)}}C(Ns,it);var BA={2:"touch",3:"pen",4:"mouse"};Ns.prototype.h=function(){Ns.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ps="closure_listenable_"+(1e6*Math.random()|0),$A=0;function HA(u,d,f,g,T){this.listener=u,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=T,this.key=++$A,this.da=this.fa=!1}function Vu(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ju(u){this.src=u,this.g={},this.h=0}ju.prototype.add=function(u,d,f,g,T){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var V=kh(u,d,g,T);return-1<V?(d=u[V],f||(d.fa=!1)):(d=new HA(d,this.src,M,!!g,T),d.fa=f,u.push(d)),d};function Ph(u,d){var f=d.type;if(f in u.g){var g=u.g[f],T=Array.prototype.indexOf.call(g,d,void 0),M;(M=0<=T)&&Array.prototype.splice.call(g,T,1),M&&(Vu(d),u.g[f].length==0&&(delete u.g[f],u.h--))}}function kh(u,d,f,g){for(var T=0;T<u.length;++T){var M=u[T];if(!M.da&&M.listener==d&&M.capture==!!f&&M.ha==g)return T}return-1}var Oh="closure_lm_"+(1e6*Math.random()|0),Fh={};function qw(u,d,f,g,T){if(g&&g.once)return Gw(u,d,f,g,T);if(Array.isArray(d)){for(var M=0;M<d.length;M++)qw(u,d[M],f,g,T);return null}return f=Uh(f),u&&u[Ps]?u.K(d,f,l(g)?!!g.capture:!!g,T):zw(u,d,f,!1,g,T)}function zw(u,d,f,g,T,M){if(!d)throw Error("Invalid event type");var V=l(T)?!!T.capture:!!T,Ee=Vh(u);if(Ee||(u[Oh]=Ee=new ju(u)),f=Ee.add(d,f,g,V,M),f.proxy)return f;if(g=qA(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)UA||(T=V),T===void 0&&(T=!1),u.addEventListener(d.toString(),g,T);else if(u.attachEvent)u.attachEvent(Kw(d.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function qA(){function u(f){return d.call(u.src,u.listener,f)}let d=zA;return u}function Gw(u,d,f,g,T){if(Array.isArray(d)){for(var M=0;M<d.length;M++)Gw(u,d[M],f,g,T);return null}return f=Uh(f),u&&u[Ps]?u.L(d,f,l(g)?!!g.capture:!!g,T):zw(u,d,f,!0,g,T)}function Ww(u,d,f,g,T){if(Array.isArray(d))for(var M=0;M<d.length;M++)Ww(u,d[M],f,g,T);else g=l(g)?!!g.capture:!!g,f=Uh(f),u&&u[Ps]?(u=u.i,d=String(d).toString(),d in u.g&&(M=u.g[d],f=kh(M,f,g,T),-1<f&&(Vu(M[f]),Array.prototype.splice.call(M,f,1),M.length==0&&(delete u.g[d],u.h--)))):u&&(u=Vh(u))&&(d=u.g[d.toString()],u=-1,d&&(u=kh(d,f,g,T)),(f=-1<u?d[u]:null)&&Lh(f))}function Lh(u){if(typeof u!="number"&&u&&!u.da){var d=u.src;if(d&&d[Ps])Ph(d.i,u);else{var f=u.type,g=u.proxy;d.removeEventListener?d.removeEventListener(f,g,u.capture):d.detachEvent?d.detachEvent(Kw(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=Vh(d))?(Ph(f,u),f.h==0&&(f.src=null,d[Oh]=null)):Vu(u)}}}function Kw(u){return u in Fh?Fh[u]:Fh[u]="on"+u}function zA(u,d){if(u.da)u=!0;else{d=new Ns(d,this);var f=u.listener,g=u.ha||u.src;u.fa&&Lh(u),u=f.call(g,d)}return u}function Vh(u){return u=u[Oh],u instanceof ju?u:null}var jh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Uh(u){return typeof u=="function"?u:(u[jh]||(u[jh]=function(d){return u.handleEvent(d)}),u[jh])}function ot(){nr.call(this),this.i=new ju(this),this.M=this,this.F=null}C(ot,nr),ot.prototype[Ps]=!0,ot.prototype.removeEventListener=function(u,d,f,g){Ww(this,u,d,f,g)};function ht(u,d){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=d.type||d,typeof d=="string")d=new it(d,u);else if(d instanceof it)d.target=d.target||u;else{var T=d;d=new it(g,u),E(d,T)}if(T=!0,f)for(var M=f.length-1;0<=M;M--){var V=d.g=f[M];T=Uu(V,g,!0,d)&&T}if(V=d.g=u,T=Uu(V,g,!0,d)&&T,T=Uu(V,g,!1,d)&&T,f)for(M=0;M<f.length;M++)V=d.g=f[M],T=Uu(V,g,!1,d)&&T}ot.prototype.N=function(){if(ot.aa.N.call(this),this.i){var u=this.i,d;for(d in u.g){for(var f=u.g[d],g=0;g<f.length;g++)Vu(f[g]);delete u.g[d],u.h--}}this.F=null},ot.prototype.K=function(u,d,f,g){return this.i.add(String(u),d,!1,f,g)},ot.prototype.L=function(u,d,f,g){return this.i.add(String(u),d,!0,f,g)};function Uu(u,d,f,g){if(d=u.i.g[String(d)],!d)return!0;d=d.concat();for(var T=!0,M=0;M<d.length;++M){var V=d[M];if(V&&!V.da&&V.capture==f){var Ee=V.listener,Xe=V.ha||V.src;V.fa&&Ph(u.i,V),T=Ee.call(Xe,g)!==!1&&T}}return T&&!g.defaultPrevented}function Qw(u,d,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(u,d||0)}function Yw(u){u.g=Qw(()=>{u.g=null,u.i&&(u.i=!1,Yw(u))},u.l);let d=u.h;u.h=null,u.m.apply(null,d)}class GA extends nr{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Yw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ks(u){nr.call(this),this.h=u,this.g={}}C(ks,nr);var Zw=[];function Jw(u){Q(u.g,function(d,f){this.g.hasOwnProperty(f)&&Lh(d)},u),u.g={}}ks.prototype.N=function(){ks.aa.N.call(this),Jw(this)},ks.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bh=a.JSON.stringify,WA=a.JSON.parse,KA=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function $h(){}$h.prototype.h=null;function Xw(u){return u.h||(u.h=u.i())}function e_(){}var Os={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hh(){it.call(this,"d")}C(Hh,it);function qh(){it.call(this,"c")}C(qh,it);var Hr={},t_=null;function Bu(){return t_=t_||new ot}Hr.La="serverreachability";function n_(u){it.call(this,Hr.La,u)}C(n_,it);function Fs(u){let d=Bu();ht(d,new n_(d))}Hr.STAT_EVENT="statevent";function r_(u,d){it.call(this,Hr.STAT_EVENT,u),this.stat=d}C(r_,it);function ft(u){let d=Bu();ht(d,new r_(d,u))}Hr.Ma="timingevent";function i_(u,d){it.call(this,Hr.Ma,u),this.size=d}C(i_,it);function Ls(u,d){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},d)}function Vs(){this.g=!0}Vs.prototype.xa=function(){this.g=!1};function QA(u,d,f,g,T,M){u.info(function(){if(u.g)if(M)for(var V="",Ee=M.split("&"),Xe=0;Xe<Ee.length;Xe++){var me=Ee[Xe].split("=");if(1<me.length){var st=me[0];me=me[1];var at=st.split("_");V=2<=at.length&&at[1]=="type"?V+(st+"="+me+"&"):V+(st+"=redacted&")}}else V=null;else V=M;return"XMLHTTP REQ ("+g+") [attempt "+T+"]: "+d+`
`+f+`
`+V})}function YA(u,d,f,g,T,M,V){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+T+"]: "+d+`
`+f+`
`+M+" "+V})}function zi(u,d,f,g){u.info(function(){return"XMLHTTP TEXT ("+d+"): "+JA(u,f)+(g?" "+g:"")})}function ZA(u,d){u.info(function(){return"TIMEOUT: "+d})}Vs.prototype.info=function(){};function JA(u,d){if(!u.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var T=g[1];if(Array.isArray(T)&&!(1>T.length)){var M=T[0];if(M!="noop"&&M!="stop"&&M!="close")for(var V=1;V<T.length;V++)T[V]=""}}}}return Bh(f)}catch{return d}}var $u={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},o_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zh;function Hu(){}C(Hu,$h),Hu.prototype.g=function(){return new XMLHttpRequest},Hu.prototype.i=function(){return{}},zh=new Hu;function rr(u,d,f,g){this.j=u,this.i=d,this.l=f,this.R=g||1,this.U=new ks(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new s_}function s_(){this.i=null,this.g="",this.h=!1}var a_={},Gh={};function Wh(u,d,f){u.L=1,u.v=Wu(Mn(d)),u.m=f,u.P=!0,u_(u,null)}function u_(u,d){u.F=Date.now(),qu(u),u.A=Mn(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),E_(f.i,"t",g),u.C=0,f=u.j.J,u.h=new s_,u.g=U_(u.j,f?d:null,!u.m),0<u.O&&(u.M=new GA(m(u.Y,u,u.g),u.O)),d=u.U,f=u.g,g=u.ca;var T="readystatechange";Array.isArray(T)||(T&&(Zw[0]=T.toString()),T=Zw);for(var M=0;M<T.length;M++){var V=qw(f,T[M],g||d.handleEvent,!1,d.h||d);if(!V)break;d.g[V.key]=V}d=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,d)):(u.u="GET",u.g.ea(u.A,u.u,null,d)),Fs(),QA(u.i,u.u,u.A,u.l,u.R,u.m)}rr.prototype.ca=function(u){u=u.target;let d=this.M;d&&Rn(u)==3?d.j():this.Y(u)},rr.prototype.Y=function(u){try{if(u==this.g)e:{let at=Rn(this.g);var d=this.g.Ba();let Ki=this.g.Z();if(!(3>at)&&(at!=3||this.g&&(this.h.h||this.g.oa()||x_(this.g)))){this.J||at!=4||d==7||(d==8||0>=Ki?Fs(3):Fs(2)),Kh(this);var f=this.g.Z();this.X=f;t:if(c_(this)){var g=x_(this.g);u="";var T=g.length,M=Rn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qr(this),js(this);var V="";break t}this.h.i=new a.TextDecoder}for(d=0;d<T;d++)this.h.h=!0,u+=this.h.i.decode(g[d],{stream:!(M&&d==T-1)});g.length=0,this.h.g+=u,this.C=0,V=this.h.g}else V=this.g.oa();if(this.o=f==200,YA(this.i,this.u,this.A,this.l,this.R,at,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ee,Xe=this.g;if((Ee=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(Ee)){var me=Ee;break t}}me=null}if(f=me)zi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qh(this,f);else{this.o=!1,this.s=3,ft(12),qr(this),js(this);break e}}if(this.P){f=!0;let Wt;for(;!this.J&&this.C<V.length;)if(Wt=XA(this,V),Wt==Gh){at==4&&(this.s=4,ft(14),f=!1),zi(this.i,this.l,null,"[Incomplete Response]");break}else if(Wt==a_){this.s=4,ft(15),zi(this.i,this.l,V,"[Invalid Chunk]"),f=!1;break}else zi(this.i,this.l,Wt,null),Qh(this,Wt);if(c_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),at!=4||V.length!=0||this.h.h||(this.s=1,ft(16),f=!1),this.o=this.o&&f,!f)zi(this.i,this.l,V,"[Invalid Chunked Response]"),qr(this),js(this);else if(0<V.length&&!this.W){this.W=!0;var st=this.j;st.g==this&&st.ba&&!st.M&&(st.j.info("Great, no buffering proxy detected. Bytes received: "+V.length),tf(st),st.M=!0,ft(11))}}else zi(this.i,this.l,V,null),Qh(this,V);at==4&&qr(this),this.o&&!this.J&&(at==4?F_(this.j,this):(this.o=!1,qu(this)))}else mx(this.g),f==400&&0<V.indexOf("Unknown SID")?(this.s=3,ft(12)):(this.s=0,ft(13)),qr(this),js(this)}}}catch{}finally{}};function c_(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function XA(u,d){var f=u.C,g=d.indexOf(`
`,f);return g==-1?Gh:(f=Number(d.substring(f,g)),isNaN(f)?a_:(g+=1,g+f>d.length?Gh:(d=d.slice(g,g+f),u.C=g+f,d)))}rr.prototype.cancel=function(){this.J=!0,qr(this)};function qu(u){u.S=Date.now()+u.I,l_(u,u.I)}function l_(u,d){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ls(m(u.ba,u),d)}function Kh(u){u.B&&(a.clearTimeout(u.B),u.B=null)}rr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(ZA(this.i,this.A),this.L!=2&&(Fs(),ft(17)),qr(this),this.s=2,js(this)):l_(this,this.S-u)};function js(u){u.j.G==0||u.J||F_(u.j,u)}function qr(u){Kh(u);var d=u.M;d&&typeof d.ma=="function"&&d.ma(),u.M=null,Jw(u.U),u.g&&(d=u.g,u.g=null,d.abort(),d.ma())}function Qh(u,d){try{var f=u.j;if(f.G!=0&&(f.g==u||Yh(f.h,u))){if(!u.K&&Yh(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var T=g;if(T[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Ju(f),Yu(f);else break e;ef(f),ft(18)}}else f.za=T[1],0<f.za-f.T&&37500>T[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ls(m(f.Za,f),6e3));if(1>=f_(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Gr(f,11)}else if((u.K||f.g==u)&&Ju(f),!$(d))for(T=f.Da.g.parse(d),d=0;d<T.length;d++){let me=T[d];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let st=me[3];st!=null&&(f.la=st,f.j.info("VER="+f.la));let at=me[4];at!=null&&(f.Aa=at,f.j.info("SVER="+f.Aa));let Ki=me[5];Ki!=null&&typeof Ki=="number"&&0<Ki&&(g=1.5*Ki,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Wt=u.g;if(Wt){let ec=Wt.g?Wt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var M=g.h;M.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Zh(M,M.h),M.h=null))}if(g.D){let nf=Wt.g?Wt.g.getResponseHeader("X-HTTP-Session-Id"):null;nf&&(g.ya=nf,Se(g.I,g.D,nf))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var V=u;if(g.qa=j_(g,g.J?g.ia:null,g.W),V.K){p_(g.h,V);var Ee=V,Xe=g.L;Xe&&(Ee.I=Xe),Ee.B&&(Kh(Ee),qu(Ee)),g.g=V}else k_(g);0<f.i.length&&Zu(f)}else me[0]!="stop"&&me[0]!="close"||Gr(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Gr(f,7):Xh(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}Fs(4)}catch{}}var ex=class{constructor(u,d){this.g=u,this.map=d}};function d_(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function h_(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function f_(u){return u.h?1:u.g?u.g.size:0}function Yh(u,d){return u.h?u.h==d:u.g?u.g.has(d):!1}function Zh(u,d){u.g?u.g.add(d):u.h=d}function p_(u,d){u.h&&u.h==d?u.h=null:u.g&&u.g.has(d)&&u.g.delete(d)}d_.prototype.cancel=function(){if(this.i=g_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function g_(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let d=u.i;for(let f of u.g.values())d=d.concat(f.D);return d}return A(u.i)}function tx(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var d=[],f=u.length,g=0;g<f;g++)d.push(u[g]);return d}d=[],f=0;for(g in u)d[f++]=u[g];return d}function nx(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var d=[];u=u.length;for(var f=0;f<u;f++)d.push(f);return d}d=[],f=0;for(let g in u)d[f++]=g;return d}}}function m_(u,d){if(u.forEach&&typeof u.forEach=="function")u.forEach(d,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,d,void 0);else for(var f=nx(u),g=tx(u),T=g.length,M=0;M<T;M++)d.call(void 0,g[M],f&&f[M],u)}var y_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rx(u,d){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),T=null;if(0<=g){var M=u[f].substring(0,g);T=u[f].substring(g+1)}else M=u[f];d(M,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function zr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof zr){this.h=u.h,zu(this,u.j),this.o=u.o,this.g=u.g,Gu(this,u.s),this.l=u.l;var d=u.i,f=new $s;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),v_(this,f),this.m=u.m}else u&&(d=String(u).match(y_))?(this.h=!1,zu(this,d[1]||"",!0),this.o=Us(d[2]||""),this.g=Us(d[3]||"",!0),Gu(this,d[4]),this.l=Us(d[5]||"",!0),v_(this,d[6]||"",!0),this.m=Us(d[7]||"")):(this.h=!1,this.i=new $s(null,this.h))}zr.prototype.toString=function(){var u=[],d=this.j;d&&u.push(Bs(d,w_,!0),":");var f=this.g;return(f||d=="file")&&(u.push("//"),(d=this.o)&&u.push(Bs(d,w_,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(Bs(f,f.charAt(0)=="/"?sx:ox,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",Bs(f,ux)),u.join("")};function Mn(u){return new zr(u)}function zu(u,d,f){u.j=f?Us(d,!0):d,u.j&&(u.j=u.j.replace(/:$/,""))}function Gu(u,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);u.s=d}else u.s=null}function v_(u,d,f){d instanceof $s?(u.i=d,cx(u.i,u.h)):(f||(d=Bs(d,ax)),u.i=new $s(d,u.h))}function Se(u,d,f){u.i.set(d,f)}function Wu(u){return Se(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Us(u,d){return u?d?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Bs(u,d,f){return typeof u=="string"?(u=encodeURI(u).replace(d,ix),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function ix(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var w_=/[#\/\?@]/g,ox=/[#\?:]/g,sx=/[#\?]/g,ax=/[#\?@]/g,ux=/#/g;function $s(u,d){this.h=this.g=null,this.i=u||null,this.j=!!d}function ir(u){u.g||(u.g=new Map,u.h=0,u.i&&rx(u.i,function(d,f){u.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=$s.prototype,n.add=function(u,d){ir(this),this.i=null,u=Gi(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(d),this.h+=1,this};function __(u,d){ir(u),d=Gi(u,d),u.g.has(d)&&(u.i=null,u.h-=u.g.get(d).length,u.g.delete(d))}function I_(u,d){return ir(u),d=Gi(u,d),u.g.has(d)}n.forEach=function(u,d){ir(this),this.g.forEach(function(f,g){f.forEach(function(T){u.call(d,T,g,this)},this)},this)},n.na=function(){ir(this);let u=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let T=u[g];for(let M=0;M<T.length;M++)f.push(d[g])}return f},n.V=function(u){ir(this);let d=[];if(typeof u=="string")I_(this,u)&&(d=d.concat(this.g.get(Gi(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)d=d.concat(u[f])}return d},n.set=function(u,d){return ir(this),this.i=null,u=Gi(this,u),I_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[d]),this.h+=1,this},n.get=function(u,d){return u?(u=this.V(u),0<u.length?String(u[0]):d):d};function E_(u,d,f){__(u,d),0<f.length&&(u.i=null,u.g.set(Gi(u,d),A(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let M=encodeURIComponent(String(g)),V=this.V(g);for(g=0;g<V.length;g++){var T=M;V[g]!==""&&(T+="="+encodeURIComponent(String(V[g]))),u.push(T)}}return this.i=u.join("&")};function Gi(u,d){return d=String(d),u.j&&(d=d.toLowerCase()),d}function cx(u,d){d&&!u.j&&(ir(u),u.i=null,u.g.forEach(function(f,g){var T=g.toLowerCase();g!=T&&(__(this,g),E_(this,T,f))},u)),u.j=d}function lx(u,d){let f=new Vs;if(a.Image){let g=new Image;g.onload=y(or,f,"TestLoadImage: loaded",!0,d,g),g.onerror=y(or,f,"TestLoadImage: error",!1,d,g),g.onabort=y(or,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=y(or,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else d(!1)}function dx(u,d){let f=new Vs,g=new AbortController,T=setTimeout(()=>{g.abort(),or(f,"TestPingServer: timeout",!1,d)},1e4);fetch(u,{signal:g.signal}).then(M=>{clearTimeout(T),M.ok?or(f,"TestPingServer: ok",!0,d):or(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(T),or(f,"TestPingServer: error",!1,d)})}function or(u,d,f,g,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),g(f)}catch{}}function hx(){this.g=new KA}function fx(u,d,f){let g=f||"";try{m_(u,function(T,M){let V=T;l(T)&&(V=Bh(T)),d.push(g+M+"="+encodeURIComponent(V))})}catch(T){throw d.push(g+"type="+encodeURIComponent("_badmap")),T}}function Hs(u){this.l=u.Ub||null,this.j=u.eb||!1}C(Hs,$h),Hs.prototype.g=function(){return new Ku(this.l,this.j)},Hs.prototype.i=function(u){return function(){return u}}({});function Ku(u,d){ot.call(this),this.D=u,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Ku,ot),n=Ku.prototype,n.open=function(u,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=d,this.readyState=1,zs(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(d.body=u),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,qs(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,zs(this)),this.g&&(this.readyState=3,zs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;D_(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function D_(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var d=u.value?u.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!u.done}))&&(this.response=this.responseText+=d)}u.done?qs(this):zs(this),this.readyState==3&&D_(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,qs(this))},n.Qa=function(u){this.g&&(this.response=u,qs(this))},n.ga=function(){this.g&&qs(this)};function qs(u){u.readyState=4,u.l=null,u.j=null,u.v=null,zs(u)}n.setRequestHeader=function(u,d){this.u.append(u,d)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=d.next();return u.join(`\r
`)};function zs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function T_(u){let d="";return Q(u,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Jh(u,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=T_(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Se(u,d,f))}function ke(u){ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(ke,ot);var px=/^https?$/i,gx=["POST","PUT"];n=ke.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);d=d?d.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zh.g(),this.v=this.o?Xw(this.o):Xw(zh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(u),!0),this.B=!1}catch(M){C_(this,M);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var T in g)f.set(T,g[T]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let M of g.keys())f.set(M,g.get(M));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(M=>M.toLowerCase()=="content-type"),T=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(gx,d,void 0))||g||T||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,V]of f)this.g.setRequestHeader(M,V);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{A_(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){C_(this,M)}};function C_(u,d){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=d,u.m=5,b_(u),Qu(u)}function b_(u){u.A||(u.A=!0,ht(u,"complete"),ht(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ht(this,"complete"),ht(this,"abort"),Qu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qu(this,!0)),ke.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?S_(this):this.bb())},n.bb=function(){S_(this)};function S_(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Rn(u)!=4||u.Z()!=2)){if(u.u&&Rn(u)==4)Qw(u.Ea,0,u);else if(ht(u,"readystatechange"),Rn(u)==4){u.h=!1;try{let V=u.Z();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=V===0){var T=String(u.D).match(y_)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),g=!px.test(T?T.toLowerCase():"")}f=g}if(f)ht(u,"complete"),ht(u,"success");else{u.m=6;try{var M=2<Rn(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",b_(u)}}finally{Qu(u)}}}}function Qu(u,d){if(u.g){A_(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,d||ht(u,"ready");try{f.onreadystatechange=g}catch{}}}function A_(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Rn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Rn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var d=this.g.responseText;return u&&d.indexOf(u)==0&&(d=d.substring(u.length)),WA(d)}};function x_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function mx(u){let d={};u=(u.g&&2<=Rn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if($(u[g]))continue;var f=D(u[g]);let T=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let M=d[T]||[];d[T]=M,M.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gs(u,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||d}function M_(u){this.Aa=0,this.i=[],this.j=new Vs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gs("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gs("baseRetryDelayMs",5e3,u),this.cb=Gs("retryDelaySeedMs",1e4,u),this.Wa=Gs("forwardChannelMaxRetries",2,u),this.wa=Gs("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new d_(u&&u.concurrentRequestLimit),this.Da=new hx,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=M_.prototype,n.la=8,n.G=1,n.connect=function(u,d,f,g){ft(0),this.W=u,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=j_(this,null,this.W),Zu(this)};function Xh(u){if(R_(u),u.G==3){var d=u.U++,f=Mn(u.I);if(Se(f,"SID",u.K),Se(f,"RID",d),Se(f,"TYPE","terminate"),Ws(u,f),d=new rr(u,u.j,d),d.L=2,d.v=Wu(Mn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=U_(d.j,null),d.g.ea(d.v)),d.F=Date.now(),qu(d)}V_(u)}function Yu(u){u.g&&(tf(u),u.g.cancel(),u.g=null)}function R_(u){Yu(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ju(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Zu(u){if(!h_(u.h)&&!u.s){u.s=!0;var d=u.Ga;Ms||Hw(),Rs||(Ms(),Rs=!0),Nh.add(d,u),u.B=0}}function yx(u,d){return f_(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=d.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ls(m(u.Ga,u,d),L_(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let T=new rr(this,this.j,u),M=this.o;if(this.S&&(M?(M=v(M),E(M,this.S)):M=this.S),this.m!==null||this.O||(T.H=M,M=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=P_(this,T,d),f=Mn(this.I),Se(f,"RID",u),Se(f,"CVER",22),this.D&&Se(f,"X-HTTP-Session-Id",this.D),Ws(this,f),M&&(this.O?d="headers="+encodeURIComponent(String(T_(M)))+"&"+d:this.m&&Jh(f,this.m,M)),Zh(this.h,T),this.Ua&&Se(f,"TYPE","init"),this.P?(Se(f,"$req",d),Se(f,"SID","null"),T.T=!0,Wh(T,f,null)):Wh(T,f,d),this.G=2}}else this.G==3&&(u?N_(this,u):this.i.length==0||h_(this.h)||N_(this))};function N_(u,d){var f;d?f=d.l:f=u.U++;let g=Mn(u.I);Se(g,"SID",u.K),Se(g,"RID",f),Se(g,"AID",u.T),Ws(u,g),u.m&&u.o&&Jh(g,u.m,u.o),f=new rr(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),d&&(u.i=d.D.concat(u.i)),d=P_(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Zh(u.h,f),Wh(f,g,d)}function Ws(u,d){u.H&&Q(u.H,function(f,g){Se(d,g,f)}),u.l&&m_({},function(f,g){Se(d,g,f)})}function P_(u,d,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var T=u.i;let M=-1;for(;;){let V=["count="+f];M==-1?0<f?(M=T[0].g,V.push("ofs="+M)):M=0:V.push("ofs="+M);let Ee=!0;for(let Xe=0;Xe<f;Xe++){let me=T[Xe].g,st=T[Xe].map;if(me-=M,0>me)M=Math.max(0,T[Xe].g-100),Ee=!1;else try{fx(st,V,"req"+me+"_")}catch{g&&g(st)}}if(Ee){g=V.join("&");break e}}}return u=u.i.splice(0,f),d.D=u,g}function k_(u){if(!u.g&&!u.u){u.Y=1;var d=u.Fa;Ms||Hw(),Rs||(Ms(),Rs=!0),Nh.add(d,u),u.v=0}}function ef(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ls(m(u.Fa,u),L_(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,O_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ls(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ft(10),Yu(this),O_(this))};function tf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function O_(u){u.g=new rr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var d=Mn(u.qa);Se(d,"RID","rpc"),Se(d,"SID",u.K),Se(d,"AID",u.T),Se(d,"CI",u.F?"0":"1"),!u.F&&u.ja&&Se(d,"TO",u.ja),Se(d,"TYPE","xmlhttp"),Ws(u,d),u.m&&u.o&&Jh(d,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=Wu(Mn(d)),f.m=null,f.P=!0,u_(f,u)}n.Za=function(){this.C!=null&&(this.C=null,Yu(this),ef(this),ft(19))};function Ju(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function F_(u,d){var f=null;if(u.g==d){Ju(u),tf(u),u.g=null;var g=2}else if(Yh(u.h,d))f=d.D,p_(u.h,d),g=1;else return;if(u.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var T=u.B;g=Bu(),ht(g,new i_(g,f)),Zu(u)}else k_(u);else if(T=d.s,T==3||T==0&&0<d.X||!(g==1&&yx(u,d)||g==2&&ef(u)))switch(f&&0<f.length&&(d=u.h,d.i=d.i.concat(f)),T){case 1:Gr(u,5);break;case 4:Gr(u,10);break;case 3:Gr(u,6);break;default:Gr(u,2)}}}function L_(u,d){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*d}function Gr(u,d){if(u.j.info("Error code "+d),d==2){var f=m(u.fb,u),g=u.Xa;let T=!g;g=new zr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zu(g,"https"),Wu(g),T?lx(g.toString(),f):dx(g.toString(),f)}else ft(2);u.G=0,u.l&&u.l.sa(d),V_(u),R_(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function V_(u){if(u.G=0,u.ka=[],u.l){let d=g_(u.h);(d.length!=0||u.i.length!=0)&&(R(u.ka,d),R(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function j_(u,d,f){var g=f instanceof zr?Mn(f):new zr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Gu(g,g.s);else{var T=a.location;g=T.protocol,d=d?d+"."+T.hostname:T.hostname,T=+T.port;var M=new zr(null);g&&zu(M,g),d&&(M.g=d),T&&Gu(M,T),f&&(M.l=f),g=M}return f=u.D,d=u.ya,f&&d&&Se(g,f,d),Se(g,"VER",u.la),Ws(u,g),g}function U_(u,d,f){if(d&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=u.Ca&&!u.pa?new ke(new Hs({eb:f})):new ke(u.pa),d.Ha(u.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function B_(){}n=B_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xu(){}Xu.prototype.g=function(u,d){return new At(u,d)};function At(u,d){ot.call(this),this.g=new M_(d),this.l=u,this.h=d&&d.messageUrlParams||null,u=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(u?u["X-WebChannel-Content-Type"]=d.messageContentType:u={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(u?u["X-WebChannel-Client-Profile"]=d.va:u={"X-WebChannel-Client-Profile":d.va}),this.g.S=u,(u=d&&d.Sb)&&!$(u)&&(this.g.m=u),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!$(d)&&(this.g.D=d,u=this.h,u!==null&&d in u&&(u=this.h,d in u&&delete u[d])),this.j=new Wi(this)}C(At,ot),At.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},At.prototype.close=function(){Xh(this.g)},At.prototype.o=function(u){var d=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=Bh(u),u=f);d.i.push(new ex(d.Ya++,u)),d.G==3&&Zu(d)},At.prototype.N=function(){this.g.l=null,delete this.j,Xh(this.g),delete this.g,At.aa.N.call(this)};function $_(u){Hh.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var d=u.__sm__;if(d){e:{for(let f in d){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,d=d!==null&&u in d?d[u]:void 0),this.data=d}else this.data=u}C($_,Hh);function H_(){qh.call(this),this.status=1}C(H_,qh);function Wi(u){this.g=u}C(Wi,B_),Wi.prototype.ua=function(){ht(this.g,"a")},Wi.prototype.ta=function(u){ht(this.g,new $_(u))},Wi.prototype.sa=function(u){ht(this.g,new H_)},Wi.prototype.ra=function(){ht(this.g,"b")},Xu.prototype.createWebChannel=Xu.prototype.g,At.prototype.send=At.prototype.o,At.prototype.open=At.prototype.m,At.prototype.close=At.prototype.close,rm=Hn.createWebChannelTransport=function(){return new Xu},nm=Hn.getStatEventTarget=function(){return Bu()},tm=Hn.Event=Hr,jl=Hn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$u.NO_ERROR=0,$u.TIMEOUT=8,$u.HTTP_ERROR=6,Aa=Hn.ErrorCode=$u,o_.COMPLETE="complete",em=Hn.EventType=o_,e_.EventType=Os,Os.OPEN="a",Os.CLOSE="b",Os.ERROR="c",Os.MESSAGE="d",ot.prototype.listen=ot.prototype.K,Mo=Hn.WebChannel=e_,Xg=Hn.FetchXmlHttpFactory=Hs,ke.prototype.listenOnce=ke.prototype.L,ke.prototype.getLastError=ke.prototype.Ka,ke.prototype.getLastErrorCode=ke.prototype.Ba,ke.prototype.getStatus=ke.prototype.Z,ke.prototype.getResponseJson=ke.prototype.Oa,ke.prototype.getResponseText=ke.prototype.oa,ke.prototype.send=ke.prototype.ea,ke.prototype.setWithCredentials=ke.prototype.Ha,Jg=Hn.XhrIo=ke}).apply(typeof Vl<"u"?Vl:typeof self<"u"?self:typeof window<"u"?window:{});var hC="@firebase/firestore";var Ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ge.UNAUTHENTICATED=new Ge(null),Ge.GOOGLE_CREDENTIALS=new Ge("google-credentials-uid"),Ge.FIRST_PARTY=new Ge("first-party-uid"),Ge.MOCK_USER=new Ge("mock-user");var as="10.13.1";var Ar=new rc("@firebase/firestore");function Oo(){return Ar.logLevel}function pb(n){Ar.setLogLevel(n)}function k(n,...e){if(Ar.logLevel<=cn.DEBUG){let t=e.map(uv);Ar.debug(`Firestore (${as}): ${n}`,...t)}}function je(n,...e){if(Ar.logLevel<=cn.ERROR){let t=e.map(uv);Ar.error(`Firestore (${as}): ${n}`,...t)}}function Ht(n,...e){if(Ar.logLevel<=cn.WARN){let t=e.map(uv);Ar.warn(`Firestore (${as}): ${n}`,...t)}}function uv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function H(n="Unexpected state"){let e=`FIRESTORE (${as}) INTERNAL ASSERTION FAILED: `+n;throw je(e),new Error(e)}function K(n,e){n||H()}function gb(n,e){n||H()}function U(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends Q_{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var We=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Yl=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},um=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ge.UNAUTHENTICATED))}shutdown(){}},cm=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},lm=class{constructor(e){this.t=e,this.currentUser=Ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new We;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new We,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>N(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new We)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new Yl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new Ge(e)}},dm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ge.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},hm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new dm(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},fm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pm=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(K(typeof t.token=="string"),this.R=t.token,new fm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function G1(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Zl=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=G1(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function qo(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function mb(n){return n+"\0"}var Pe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Pe(0,0))}static max(){return new n(new Pe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Jl=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(),r===void 0?r=e.length-t:r>e.length-t&&H(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},pe=class n extends Jl{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},W1=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ue=class n extends Jl{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return W1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var zo=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function gm(n){return n.fields.find(e=>e.kind===2)}function yi(n){return n.fields.filter(e=>e.kind!==2)}zo.UNKNOWN_ID=-1;var Bo=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ua=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,qt.min())}};function yb(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new qt(i,B.empty(),e)}function vb(n){return new qt(n.readTime,n.key,-1)}var qt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Y.min(),B.empty(),-1)}static max(){return new n(Y.max(),B.empty(),-1)}};function cv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var wb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Xl=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Vr(n){return N(this,null,function*(){if(n.code!==x.FAILED_PRECONDITION||n.message!==wb)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var ed=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new We,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Di(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=lv(r.target.error);this.V.reject(new Di(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Di(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new ym(t)}},xr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Ks())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),vi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!nc())return!1;if(n.v())return!0;let e=Ks(),t=n.S(e),r=0<t&&t<10,i=_b(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return N(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Di(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Di(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return N(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=ed.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),S.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function _b(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var mm=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return vi(this.B.delete())}},Di=class extends P{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function jr(n){return n.name==="IndexedDbTransactionError"}var ym=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),vi(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),vi(this.store.add(e))}get(e){return vi(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),vi(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),vi(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new S((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,c)=>{s.push(c)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=o=>{let s=lv(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new S((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new mm(a),l=t(a.primaryKey,a.value,c);if(l instanceof S){let h=l.catch(p=>(c.done(),S.reject(p)));r.push(h)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function vi(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=lv(r.target.error);t(i)}})}var fC=!1;function lv(n){let e=xr.S(Ks());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fC||(fC=!0,setTimeout(()=>{throw r},0)),r}}return n}var vm=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>N(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){jr(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Vr(t)}yield this.X(6e4)}))}},wm=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return N(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return S.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=vb(o);cv(s,r)>0&&(r=s)}),new qt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Rt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function cu(n){return n==null}function Ba(n){return n===0&&1/n==-1/0}function Ib(n){return typeof n=="number"&&Number.isInteger(n)&&!Ba(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function wt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pC(e)),e=K1(n.get(t),e);return pC(e)}function K1(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function pC(n){return n+""}function vn(n){let e=n.length;if(K(e>=2),e===2)return K(n.charAt(0)===""&&n.charAt(1)===""),pe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&H(),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:H()}o=s+2}return new pe(r)}var gC=["userId","batchId"];function ql(n,e){return[n,wt(e)]}function Eb(n,e,t){return[n,wt(e),t]}var Q1={},Y1=["prefixPath","collectionGroup","readTime","documentId"],Z1=["prefixPath","collectionGroup","documentId"],J1=["collectionGroup","readTime","prefixPath","documentId"],X1=["canonicalId","targetId"],eO=["targetId","path"],tO=["path","targetId"],nO=["collectionId","parent"],rO=["indexId","uid"],iO=["uid","sequenceNumber"],oO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],sO=["indexId","uid","orderedDocumentKey"],aO=["userId","collectionPath","documentId"],uO=["userId","collectionPath","largestBatchId"],cO=["userId","collectionGroup","largestBatchId"],Db=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],lO=[...Db,"documentOverlays"],Tb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Cb=Tb,dv=[...Cb,"indexConfiguration","indexState","indexEntries"],dO=dv,hO=[...dv,"globals"];var $a=class extends Xl{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ye(n,e){let t=U(n);return xr.F(t._e,e)}function mC(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Oi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function bb(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ae=class n{constructor(e,t){this.comparator=e,this.root=t||_n.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Uo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Uo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Uo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Uo(this.root,e,this.comparator,!0)}},Uo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},_n=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();let e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}};_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(e,t,r,i,o){return this}insert(e,t,r){return new _n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Te=class n{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new td(this.data.getIterator())}getIteratorFrom(e){return new td(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},td=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ro(n){return n.hasNext()?n.getNext():void 0}var Nt=class n{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new n([])}unionWith(e){let t=new Te(Ue.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qo(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var nd=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Sb(){return typeof atob<"u"}var $e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new nd("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};$e.EMPTY_BYTE_STRING=new $e("");var fO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gn(n){if(K(!!n),typeof n=="string"){let e=0,t=fO.exec(n);if(K(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xe(n.seconds),nanos:xe(n.nanos)}}function xe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Mr(n){return typeof n=="string"?$e.fromBase64String(n):$e.fromUint8Array(n)}function Gd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function hv(n){let e=n.mapValue.fields.__previous_value__;return Gd(e)?hv(e):e}function Ha(n){let e=Gn(n.mapValue.fields.__local_write_time__.timestampValue);return new Pe(e.seconds,e.nanos)}var _m=class{constructor(e,t,r,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Rr=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var br={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},zl={nullValue:"NULL_VALUE"};function Ti(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gd(n)?4:Ab(n)?9007199254740991:Wd(n)?10:11:H()}function Dn(n,e){if(n===e)return!0;let t=Ti(n);if(t!==Ti(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ha(n).isEqual(Ha(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Gn(i.timestampValue),a=Gn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Mr(i.bytesValue).isEqual(Mr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return xe(i.geoPointValue.latitude)===xe(o.geoPointValue.latitude)&&xe(i.geoPointValue.longitude)===xe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return xe(i.integerValue)===xe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=xe(i.doubleValue),a=xe(o.doubleValue);return s===a?Ba(s)===Ba(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return qo(n.arrayValue.values||[],e.arrayValue.values||[],Dn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(mC(s)!==mC(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!Dn(s[c],a[c])))return!1;return!0}(n,e);default:return H()}}function qa(n,e){return(n.values||[]).find(t=>Dn(t,e))!==void 0}function Nr(n,e){if(n===e)return 0;let t=Ti(n),r=Ti(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=xe(o.integerValue||o.doubleValue),c=xe(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return yC(n.timestampValue,e.timestampValue);case 4:return yC(Ha(n),Ha(e));case 5:return re(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Mr(o),c=Mr(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=re(a[l],c[l]);if(h!==0)return h}return re(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=re(xe(o.latitude),xe(s.latitude));return a!==0?a:re(xe(o.longitude),xe(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vC(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,h;let p=o.fields||{},m=s.fields||{},y=(a=p.value)===null||a===void 0?void 0:a.arrayValue,C=(c=m.value)===null||c===void 0?void 0:c.arrayValue,A=re(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((h=C?.values)===null||h===void 0?void 0:h.length)||0);return A!==0?A:vC(y,C)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===br.mapValue&&s===br.mapValue)return 0;if(o===br.mapValue)return 1;if(s===br.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let m=re(c[p],h[p]);if(m!==0)return m;let y=Nr(a[c[p]],l[h[p]]);if(y!==0)return y}return re(c.length,h.length)}(n.mapValue,e.mapValue);default:throw H()}}function yC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=Gn(n),r=Gn(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function vC(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Nr(t[i],r[i]);if(o)return o}return re(t.length,r.length)}function Go(n){return Im(n)}function Im(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Gn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Mr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Im(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${Im(t.fields[s])}`;return i+"}"}(n.mapValue):H()}function Ci(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Em(n){return!!n&&"integerValue"in n}function za(n){return!!n&&"arrayValue"in n}function wC(n){return!!n&&"nullValue"in n}function _C(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Gl(n){return!!n&&"mapValue"in n}function Wd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Oa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Oi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Oa(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oa(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ab(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var xb={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function pO(n){return"nullValue"in n?zl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ci(Rr.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Wd(n)?xb:{mapValue:{}}:H()}function gO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ci(Rr.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?xb:"mapValue"in n?Wd(n)?{mapValue:{}}:br:H()}function IC(n,e){let t=Nr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function EC(n,e){let t=Nr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var dt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Gl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oa(t)}setAll(e){let t=Ue.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=Oa(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Gl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Gl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Oi(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Oa(this.value))}};function Mb(n){let e=[];return Oi(n.fields,(t,r)=>{let i=new Ue([t]);if(Gl(r)){let o=Mb(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Nt(e)}var Ke=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Y.min(),Y.min(),Y.min(),dt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Y.min(),Y.min(),dt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Y.min(),Y.min(),dt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Tn=class{constructor(e,t){this.position=e,this.inclusive=t}};function DC(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Nr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function TC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dn(n.position[t],e.position[t]))return!1;return!0}var bi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function mO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var rd=class{},ce=class n extends rd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Cm(e,t,r):t==="array-contains"?new Am(e,r):t==="in"?new id(e,r):t==="not-in"?new xm(e,r):t==="array-contains-any"?new Mm(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bm(e,r):new Sm(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Nr(t,this.value)):t!==null&&Ti(this.value)===Ti(t)&&this.matchesComparison(Nr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ie=class n extends rd{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Wo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Wo(n){return n.op==="and"}function Dm(n){return n.op==="or"}function fv(n){return Rb(n)&&Wo(n)}function Rb(n){for(let e of n.filters)if(e instanceof Ie)return!1;return!0}function Tm(n){if(n instanceof ce)return n.field.canonicalString()+n.op.toString()+Go(n.value);if(fv(n))return n.filters.map(e=>Tm(e)).join(",");{let e=n.filters.map(t=>Tm(t)).join(",");return`${n.op}(${e})`}}function Nb(n,e){return n instanceof ce?function(r,i){return i instanceof ce&&r.op===i.op&&r.field.isEqual(i.field)&&Dn(r.value,i.value)}(n,e):n instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&Nb(s,i.filters[a]),!0):!1}(n,e):void H()}function Pb(n,e){let t=n.filters.concat(e);return Ie.create(t,n.op)}function kb(n){return n instanceof ce?function(t){return`${t.field.canonicalString()} ${t.op} ${Go(t.value)}`}(n):n instanceof Ie?function(t){return t.op.toString()+" {"+t.getFilters().map(kb).join(" ,")+"}"}(n):"Filter"}var Cm=class extends ce{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},bm=class extends ce{constructor(e,t){super(e,"in",t),this.keys=Ob("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Sm=class extends ce{constructor(e,t){super(e,"not-in",t),this.keys=Ob("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ob(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var Am=class extends ce{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return za(t)&&qa(t.arrayValue,this.value)}},id=class extends ce{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&qa(this.value.arrayValue,t)}},xm=class extends ce{constructor(e,t){super(e,"not-in",t)}matches(e){if(qa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!qa(this.value.arrayValue,t)}},Mm=class extends ce{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!za(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>qa(this.value.arrayValue,r))}};var Rm=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function Nm(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Rm(n,e,t,r,i,o,s)}function Si(n){let e=U(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Tm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),cu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Go(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Go(r)).join(",")),e.ue=t}return e.ue}function lu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Nb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!TC(n.startAt,e.startAt)&&TC(n.endAt,e.endAt)}function od(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function sd(n,e){return n.filters.filter(t=>t instanceof ce&&t.field.isEqual(e))}function CC(n,e,t){let r=zl,i=!0;for(let o of sd(n,e)){let s=zl,a=!0;switch(o.op){case"<":case"<=":s=pO(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=zl}IC({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];IC({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function bC(n,e,t){let r=br,i=!0;for(let o of sd(n,e)){let s=br,a=!0;switch(o.op){case">=":case">":s=gO(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=br}EC({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];EC({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var rn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Fb(n,e,t,r,i,o,s,a){return new rn(n,e,t,r,i,o,s,a)}function us(n){return new rn(n)}function SC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pv(n){return n.collectionGroup!==null}function $o(n){let e=U(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Te(Ue.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new bi(o,r))}),t.has(Ue.keyField().canonicalString())||e.ce.push(new bi(Ue.keyField(),r))}return e.ce}function _t(n){let e=U(n);return e.le||(e.le=yO(e,$o(n))),e.le}function yO(n,e){if(n.limitType==="F")return Nm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new bi(i.field,o)});let t=n.endAt?new Tn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Tn(n.startAt.position,n.startAt.inclusive):null;return Nm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Pm(n,e){let t=n.filters.concat([e]);return new rn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ad(n,e,t){return new rn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function du(n,e){return lu(_t(n),_t(e))&&n.limitType===e.limitType}function Lb(n){return`${Si(_t(n))}|lt:${n.limitType}`}function Fo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>kb(i)).join(", ")}]`),cu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Go(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Go(i)).join(",")),`Target(${r})`}(_t(n))}; limitType=${n.limitType})`}function hu(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of $o(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=DC(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,$o(r),i)||r.endAt&&!function(s,a,c){let l=DC(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,$o(r),i))}(n,e)}function Vb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jb(n){return(e,t)=>{let r=!1;for(let i of $o(n)){let o=vO(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function vO(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?Nr(c,l):H()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}var Cn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Oi(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return bb(this.inner)}size(){return this.innerSize}};var wO=new Ae(B.comparator);function St(){return wO}var Ub=new Ae(B.comparator);function Pa(...n){let e=Ub;for(let t of n)e=e.insert(t.key,t);return e}function Bb(n){let e=Ub;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function wn(){return Fa()}function $b(){return Fa()}function Fa(){return new Cn(n=>n.toString(),(n,e)=>n.isEqual(e))}var _O=new Ae(B.comparator),IO=new Te(B.comparator);function ie(...n){let e=IO;for(let t of n)e=e.add(t);return e}var EO=new Te(re);function gv(){return EO}function mv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ba(e)?"-0":e}}function Hb(n){return{integerValue:""+n}}function qb(n,e){return Ib(e)?Hb(e):mv(n,e)}var Ko=class{constructor(){this._=void 0}};function DO(n,e,t){return n instanceof Pr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Gd(o)&&(o=hv(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof Wn?Gb(n,e):n instanceof Kn?Wb(n,e):function(i,o){let s=zb(i,o),a=AC(s)+AC(i.Pe);return Em(s)&&Em(i.Pe)?Hb(a):mv(i.serializer,a)}(n,e)}function TO(n,e,t){return n instanceof Wn?Gb(n,e):n instanceof Kn?Wb(n,e):t}function zb(n,e){return n instanceof kr?function(r){return Em(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Pr=class extends Ko{},Wn=class extends Ko{constructor(e){super(),this.elements=e}};function Gb(n,e){let t=Kb(e);for(let r of n.elements)t.some(i=>Dn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Kn=class extends Ko{constructor(e){super(),this.elements=e}};function Wb(n,e){let t=Kb(e);for(let r of n.elements)t=t.filter(i=>!Dn(i,r));return{arrayValue:{values:t}}}var kr=class extends Ko{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function AC(n){return xe(n.integerValue||n.doubleValue)}function Kb(n){return za(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Ai=class{constructor(e,t){this.field=e,this.transform=t}};function CO(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Wn&&i instanceof Wn||r instanceof Kn&&i instanceof Kn?qo(r.elements,i.elements,Dn):r instanceof kr&&i instanceof kr?Dn(r.Pe,i.Pe):r instanceof Pr&&i instanceof Pr}(n.transform,e.transform)}var km=class{constructor(e,t){this.version=e,this.transformResults=t}},Le=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Wl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Qo=class{};function Qb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Fr(n.key,Le.none()):new Or(n.key,n.data,Le.none());{let t=n.data,r=dt.empty(),i=new Te(Ue.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new on(n.key,r,new Nt(i.toArray()),Le.none())}}function bO(n,e,t){n instanceof Or?function(i,o,s){let a=i.value.clone(),c=MC(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof on?function(i,o,s){if(!Wl(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=MC(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(Yb(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function La(n,e,t,r){return n instanceof Or?function(o,s,a,c){if(!Wl(o.precondition,s))return a;let l=o.value.clone(),h=RC(o.fieldTransforms,c,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof on?function(o,s,a,c){if(!Wl(o.precondition,s))return a;let l=RC(o.fieldTransforms,c,s),h=s.data;return h.setAll(Yb(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return Wl(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function SO(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=zb(r.transform,i||null);o!=null&&(t===null&&(t=dt.empty()),t.set(r.field,o))}return t||null}function xC(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qo(r,i,(o,s)=>CO(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Or=class extends Qo{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},on=class extends Qo{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Yb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function MC(n,e,t){let r=new Map;K(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,TO(s,a,t[i]))}return r}function RC(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,DO(o,s,e))}return r}var Fr=class extends Qo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ga=class extends Qo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Wa=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&bO(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=La(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=La(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=$b();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=Qb(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&qo(this.mutations,e.mutations,(t,r)=>xC(t,r))&&qo(this.baseMutations,e.baseMutations,(t,r)=>xC(t,r))}},Om=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){K(e.mutations.length===r.length);let i=function(){return _O}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var Ka=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Fm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var qe,fe;function Zb(n){switch(n){default:return H();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function Jb(n){if(n===void 0)return je("GRPC error has no .code"),x.UNKNOWN;switch(n){case qe.OK:return x.OK;case qe.CANCELLED:return x.CANCELLED;case qe.UNKNOWN:return x.UNKNOWN;case qe.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case qe.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case qe.INTERNAL:return x.INTERNAL;case qe.UNAVAILABLE:return x.UNAVAILABLE;case qe.UNAUTHENTICATED:return x.UNAUTHENTICATED;case qe.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case qe.NOT_FOUND:return x.NOT_FOUND;case qe.ALREADY_EXISTS:return x.ALREADY_EXISTS;case qe.PERMISSION_DENIED:return x.PERMISSION_DENIED;case qe.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case qe.ABORTED:return x.ABORTED;case qe.OUT_OF_RANGE:return x.OUT_OF_RANGE;case qe.UNIMPLEMENTED:return x.UNIMPLEMENTED;case qe.DATA_LOSS:return x.DATA_LOSS;default:return H()}}(fe=qe||(qe={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var NC=null;function Xb(){return new TextEncoder}var AO=new Ir([4294967295,4294967295],0);function PC(n){let e=Xb().encode(n),t=new Zg;return t.update(e),new Uint8Array(t.digest())}function kC(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ir([t,r],0),new Ir([i,o],0)]}var Lm=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ei(`Invalid padding: ${t}`);if(r<0)throw new Ei(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ei(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ei(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ir.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ir.fromNumber(r)));return i.compare(AO)===1&&(i=new Ir([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=PC(e),[r,i]=kC(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=PC(e),[r,i]=kC(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ei=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Qa=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ya.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Y.min(),i,new Ae(re),St(),ie())}},Ya=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ie(),ie(),ie())}};var Ho=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},ud=class{constructor(e,t){this.targetId=e,this.me=t}},cd=class{constructor(e,t,r=$e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ld=class{constructor(){this.fe=0,this.ge=FC(),this.pe=$e.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ie(),t=ie(),r=ie();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H()}}),new Ya(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=FC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,K(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Vm=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=St(),this.qe=OC(),this.Qe=new Ae(re)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:H()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(od(o))if(r===0){let s=new B(o.path);this.Ue(t,s,Ke.newNoDocument(s,Y.min()))}else K(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),c=a?this.Xe(a,e,s):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}NC?.et(function(h,p,m,y,C){var A,R,L,$,O,G;let X={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},Q=p.unchangedNames;return Q&&(X.bloomFilter={applied:C===0,hashCount:(A=Q?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:($=(L=(R=Q?.bits)===null||R===void 0?void 0:R.bitmap)===null||L===void 0?void 0:L.length)!==null&&$!==void 0?$:0,padding:(G=(O=Q?.bits)===null||O===void 0?void 0:O.padding)!==null&&G!==void 0?G:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),X}(s,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Mr(r).toUint8Array()}catch(c){if(c instanceof nd)return Ht("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Lm(s,i,o)}catch(c){return Ht(c instanceof Ei?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&od(a.target)){let c=new B(a.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,Ke.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ie();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new Qa(e,t,this.Qe,this.ke,r);return this.ke=St(),this.qe=OC(),this.Qe=new Ae(re),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ld,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Te(re),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ld),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function OC(){return new Ae(B.comparator)}function FC(){return new Ae(B.comparator)}var xO={asc:"ASCENDING",desc:"DESCENDING"},MO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RO={and:"AND",or:"OR"},jm=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Um(n,e){return n.useProto3Json||cu(e)?e:{value:e}}function Yo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function e0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function NO(n,e){return Yo(n,e.toTimestamp())}function Be(n){return K(!!n),Y.fromTimestamp(function(t){let r=Gn(t);return new Pe(r.seconds,r.nanos)}(n))}function yv(n,e){return Bm(n,e).canonicalString()}function Bm(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function t0(n){let e=pe.fromString(n);return K(d0(e)),e}function Za(n,e){return yv(n.databaseId,e.path)}function In(n,e){let t=t0(e);if(t.get(1)!==n.databaseId.projectId)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(i0(t))}function n0(n,e){return yv(n.databaseId,e)}function r0(n){let e=t0(n);return e.length===4?pe.emptyPath():i0(e)}function $m(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function i0(n){return K(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function LC(n,e,t){return{name:Za(n,e),fields:t.value.mapValue.fields}}function o0(n,e,t){let r=In(n,e.name),i=Be(e.updateTime),o=e.createTime?Be(e.createTime):Y.min(),s=new dt({mapValue:{fields:e.fields}}),a=Ke.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function PO(n,e){return"found"in e?function(r,i){K(!!i.found),i.found.name,i.found.updateTime;let o=In(r,i.found.name),s=Be(i.found.updateTime),a=i.found.createTime?Be(i.found.createTime):Y.min(),c=new dt({mapValue:{fields:i.found.fields}});return Ke.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){K(!!i.missing),K(!!i.readTime);let o=In(r,i.missing),s=Be(i.readTime);return Ke.newNoDocument(o,s)}(n,e):H()}function kO(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(K(h===void 0||typeof h=="string"),$e.fromBase64String(h||"")):(K(h===void 0||h instanceof Buffer||h instanceof Uint8Array),$e.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?x.UNKNOWN:Jb(l.code);return new P(h,l.message||"")}(s);t=new cd(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=In(n,r.document.name),o=Be(r.document.updateTime),s=r.document.createTime?Be(r.document.createTime):Y.min(),a=new dt({mapValue:{fields:r.document.fields}}),c=Ke.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Ho(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=In(n,r.document),o=r.readTime?Be(r.readTime):Y.min(),s=Ke.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Ho([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=In(n,r.document),o=r.removedTargetIds||[];t=new Ho([],o,i,null)}else{if(!("filter"in e))return H();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Fm(i,o),a=r.targetId;t=new ud(a,s)}}return t}function Ja(n,e){let t;if(e instanceof Or)t={update:LC(n,e.key,e.value)};else if(e instanceof Fr)t={delete:Za(n,e.key)};else if(e instanceof on)t={update:LC(n,e.key,e.data),updateMask:UO(e.fieldMask)};else{if(!(e instanceof Ga))return H();t={verify:Za(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Pr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Wn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Kn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof kr)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw H()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:NO(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:H()}(n,e.precondition)),t}function Hm(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Le.updateTime(Be(o.updateTime)):o.exists!==void 0?Le.exists(o.exists):Le.none()}(e.currentDocument):Le.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)K(a.setToServerValue==="REQUEST_TIME"),c=new Pr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new Wn(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new Kn(h)}else"increment"in a?c=new kr(s,a.increment):H();let l=Ue.fromServerFormat(a.fieldPath);return new Ai(l,c)}(n,i)):[];if(e.update){e.update.name;let i=In(n,e.update.name),o=new dt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new Nt(l.map(h=>Ue.fromServerFormat(h)))}(e.updateMask);return new on(i,o,s,t,r)}return new Or(i,o,t,r)}if(e.delete){let i=In(n,e.delete);return new Fr(i,t)}if(e.verify){let i=In(n,e.verify);return new Ga(i,t)}return H()}function OO(n,e){return n&&n.length>0?(K(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?Be(i.updateTime):Be(o);return s.isEqual(Y.min())&&(s=Be(o)),new km(s,i.transformResults||[])}(t,e))):[]}function s0(n,e){return{documents:[n0(n,e.path)]}}function a0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=n0(n,i);let o=function(l){if(l.length!==0)return l0(Ie.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Lo(m.field),direction:LO(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Um(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function u0(n){let e=r0(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){K(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=c0(p);return m instanceof Ie&&fv(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(C){return new bi(Vo(C.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,cu(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,y=p.values||[];return new Tn(y,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,y=p.values||[];return new Tn(y,m)}(t.endAt)),Fb(e,i,s,o,a,"F",c,l)}function FO(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function c0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Vo(t.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Vo(t.unaryFilter.field);return ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Vo(t.unaryFilter.field);return ce.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Vo(t.unaryFilter.field);return ce.create(s,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(n):n.fieldFilter!==void 0?function(t){return ce.create(Vo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ie.create(t.compositeFilter.filters.map(r=>c0(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H()}}(t.compositeFilter.op))}(n):H()}function LO(n){return xO[n]}function VO(n){return MO[n]}function jO(n){return RO[n]}function Lo(n){return{fieldPath:n.canonicalString()}}function Vo(n){return Ue.fromServerFormat(n.fieldPath)}function l0(n){return n instanceof ce?function(t){if(t.op==="=="){if(_C(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NAN"}};if(wC(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(_C(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NAN"}};if(wC(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lo(t.field),op:VO(t.op),value:t.value}}}(n):n instanceof Ie?function(t){let r=t.getFilters().map(i=>l0(i));return r.length===1?r[0]:{compositeFilter:{op:jO(t.op),filters:r}}}(n):H()}function UO(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function d0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Zo=class n{constructor(e,t,r,i,o=Y.min(),s=Y.min(),a=$e.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var dd=class{constructor(e){this.ct=e}};function BO(n,e){let t;if(e.document)t=o0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=Mi(e.noDocument.readTime);t=Ke.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return H();{let r=B.fromSegments(e.unknownDocument.path),i=Mi(e.unknownDocument.version);t=Ke.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Pe(i[0],i[1]);return Y.fromTimestamp(o)}(e.readTime)),t}function VC(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:hd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:Za(o,s.key),fields:s.data.value.mapValue.fields,updateTime:Yo(o,s.version.toTimestamp()),createTime:Yo(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:xi(e.version)};else{if(!e.isUnknownDocument())return H();r.unknownDocument={path:t.path.toArray(),version:xi(e.version)}}return r}function hd(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function xi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Mi(n){let e=new Pe(n.seconds,n.nanoseconds);return Y.fromTimestamp(e)}function wi(n,e){let t=(e.baseMutations||[]).map(o=>Hm(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>Hm(n.ct,o)),i=Pe.fromMillis(e.localWriteTimeMs);return new Wa(e.batchId,i,t,r)}function ka(n){let e=Mi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Mi(n.lastLimboFreeSnapshotVersion):Y.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return K(o.documents.length===1),_t(us(r0(o.documents[0])))}(n.query):function(o){return _t(u0(o))}(n.query),new Zo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,$e.fromBase64String(n.resumeToken))}function h0(n,e){let t=xi(e.snapshotVersion),r=xi(e.lastLimboFreeSnapshotVersion),i;i=od(e.target)?s0(n.ct,e.target):a0(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Si(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function vv(n){let e=u0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ad(e,e.limit,"L"):e}function im(n,e){return new Ka(e.largestBatchId,Hm(n.ct,e.overlayMutation))}function jC(n,e){let t=e.path.lastSegment();return[n,wt(e.path.popLast()),t]}function UC(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:xi(r.readTime),documentKey:wt(r.documentKey.path),largestBatchId:r.largestBatchId}}var qm=class{getBundleMetadata(e,t){return BC(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Mi(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return BC(e).put(function(i){return{bundleId:i.id,createTime:xi(Be(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return $C(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:vv(o.bundledQuery),readTime:Mi(o.readTime)}}(r)})}saveNamedQuery(e,t){return $C(e).put(function(i){return{name:i.name,readTime:xi(Be(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function BC(n){return Ye(n,"bundles")}function $C(n){return Ye(n,"namedQueries")}var fd=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return xa(e).get(jC(this.userId,t)).next(r=>r?im(this.serializer,r):null)}getOverlays(e,t){let r=wn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new Ka(t,s);i.push(this.ht(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(wt(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(xa(e).j("collectionPathOverlayIndex",a))}),S.waitFor(o)}getOverlaysForCollection(e,t,r){let i=wn(),o=wt(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return xa(e).U("collectionPathOverlayIndex",s).next(a=>{for(let c of a){let l=im(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=wn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xa(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,h)=>{let p=im(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return xa(e).put(function(i,o,s){let[a,c,l]=jC(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Ja(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function xa(n){return Ye(n,"documentOverlays")}var zm=class{Pt(e){return Ye(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?$e.fromUint8Array(r):$e.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var qn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(xe(e.integerValue));else if("doubleValue"in e){let r=xe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ba(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Gn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Mr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Ab(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Wd(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):H()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(xe(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};qn.vt=new qn;function $O(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function HC(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=$O(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var Gm=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=HC(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=HC(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Wm=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},Km=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},_i=class{constructor(){this.jt=new Gm,this.Ht=new Wm(this.jt),this.Jt=new Km(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Ii=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Er(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=qC(n.arrayValue,e.arrayValue),t!==0?t:(t=qC(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function qC(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var pd=class{constructor(e){this.Xt=new Te((t,r)=>Ue.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(K(e.collectionGroup===this.collectionId),this.nn)return!1;let t=gm(e);if(t!==void 0&&!this.sn(t))return!1;let r=yi(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.on(a,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Te(Ue.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Bo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Bo(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Bo(r.field,r.dir==="asc"?0:1)));return new zo(zo.UNKNOWN_ID,this.collectionId,t,Ua.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function f0(n){var e,t;if(K(n instanceof ce||n instanceof Ie),n instanceof ce){if(n instanceof id){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>ce.create(n.field,"==",o)))||[];return Ie.create(i,"or")}return n}let r=n.filters.map(i=>f0(i));return Ie.create(r,n.op)}function HO(n){if(n.getFilters().length===0)return[];let e=Zm(f0(n));return K(p0(e)),Qm(e)||Ym(e)?[e]:e.getFilters()}function Qm(n){return n instanceof ce}function Ym(n){return n instanceof Ie&&fv(n)}function p0(n){return Qm(n)||Ym(n)||function(t){if(t instanceof Ie&&Dm(t)){for(let r of t.getFilters())if(!Qm(r)&&!Ym(r))return!1;return!0}return!1}(n)}function Zm(n){if(K(n instanceof ce||n instanceof Ie),n instanceof ce)return n;if(n.filters.length===1)return Zm(n.filters[0]);let e=n.filters.map(r=>Zm(r)),t=Ie.create(e,n.op);return t=gd(t),p0(t)?t:(K(t instanceof Ie),K(Wo(t)),K(t.filters.length>1),t.filters.reduce((r,i)=>wv(r,i)))}function wv(n,e){let t;return K(n instanceof ce||n instanceof Ie),K(e instanceof ce||e instanceof Ie),t=n instanceof ce?e instanceof ce?function(i,o){return Ie.create([i,o],"and")}(n,e):zC(n,e):e instanceof ce?zC(e,n):function(i,o){if(K(i.filters.length>0&&o.filters.length>0),Wo(i)&&Wo(o))return Pb(i,o.getFilters());let s=Dm(i)?i:o,a=Dm(i)?o:i,c=s.filters.map(l=>wv(l,a));return Ie.create(c,"or")}(n,e),gd(t)}function zC(n,e){if(Wo(e))return Pb(e,n.getFilters());{let t=e.filters.map(r=>wv(n,r));return Ie.create(t,"or")}}function gd(n){if(K(n instanceof ce||n instanceof Ie),n instanceof ce)return n;let e=n.getFilters();if(e.length===1)return gd(e[0]);if(Rb(n))return n;let t=e.map(i=>gd(i)),r=[];return t.forEach(i=>{i instanceof ce?r.push(i):i instanceof Ie&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ie.create(r,n.op)}var Jm=class{constructor(){this.un=new Xa}addToCollectionParentIndex(e,t){return this.un.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(qt.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(qt.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},Xa=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Te(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Te(pe.comparator)).toArray()}};var Ul=new Uint8Array(0),Xm=class{constructor(e,t){this.databaseId=t,this.cn=new Xa,this.ln=new Cn(r=>Si(r),(r,i)=>lu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:wt(i)};return GC(e).put(o)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[mb(t),""],!1,!0);return GC(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(vn(s.parent))}return r})}addFieldIndex(e,t){let r=Ma(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Po(e);return o.next(a=>{s.put(UC(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Ma(e),i=Po(e),o=No(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ma(e),r=No(e),i=Po(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return S.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new pd(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=No(e),i=!0,o=new Map;return S.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ie(),a=[];return S.forEach(o,(c,l)=>{k("IndexedDbIndexManager",`Using index ${function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`}(c)} to execute ${Si(t)}`);let h=function(O,G){let X=gm(G);if(X===void 0)return null;for(let Q of sd(O,X.fieldPath))switch(Q.op){case"array-contains-any":return Q.value.arrayValue.values||[];case"array-contains":return[Q.value]}return null}(l,c),p=function(O,G){let X=new Map;for(let Q of yi(G))for(let I of sd(O,Q.fieldPath))switch(I.op){case"==":case"in":X.set(Q.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return X.set(Q.fieldPath.canonicalString(),I.value),Array.from(X.values())}return null}(l,c),m=function(O,G){let X=[],Q=!0;for(let I of yi(G)){let v=I.kind===0?CC(O,I.fieldPath,O.startAt):bC(O,I.fieldPath,O.startAt);X.push(v.value),Q&&(Q=v.inclusive)}return new Tn(X,Q)}(l,c),y=function(O,G){let X=[],Q=!0;for(let I of yi(G)){let v=I.kind===0?bC(O,I.fieldPath,O.endAt):CC(O,I.fieldPath,O.endAt);X.push(v.value),Q&&(Q=v.inclusive)}return new Tn(X,Q)}(l,c),C=this.In(c,l,m),A=this.In(c,l,y),R=this.Tn(c,l,p),L=this.En(c.indexId,h,C,m.inclusive,A,y.inclusive,R);return S.forEach(L,$=>r.G($,t.limit).next(O=>{O.forEach(G=>{let X=B.fromSegments(G.documentKey);s.has(X)||(s=s.add(X),a.push(X))})}))}).next(()=>a)}return S.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=HO(Ie.create(e.filters,"and")).map(r=>Nm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){let m=t?this.dn(t[p/l]):Ul,y=this.An(e,m,r[p%l],i),C=this.Rn(e,m,o[p%l],s),A=a.map(R=>this.An(e,m,R,!0));h.push(...this.createRange(y,C,A))}return h}An(e,t,r,i){let o=new Ii(e,B.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new Ii(e,B.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new pd(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return S.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new Te(Ue.comparator),h=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new _i;for(let i of yi(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);qn.vt.It(o,s)}return r.zt()}dn(e){let t=new _i;return qn.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new _i;return qn.vt.It(Ci(this.databaseId,t),r.Yt(function(o){let s=yi(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new _i);let o=0;for(let s of yi(e)){let a=r[o++];for(let c of i)if(this.fn(t,s.fieldPath)&&za(a))i=this.gn(i,s,a);else{let l=c.Yt(s.kind);qn.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new _i;c.seed(a.zt()),qn.vt.It(s,c.Yt(t.kind)),o.push(c)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof ce&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ma(e),i=Po(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return S.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(h,p){let m=p?new Ua(p.sequenceNumber,new qt(Mi(p.readTime),new B(vn(p.documentKey)),p.largestBatchId)):Ua.empty(),y=h.fields.map(([C,A])=>new Bo(Ue.fromServerFormat(C),A));return new zo(h.indexId,h.collectionGroup,y,m)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:re(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ma(e),o=Po(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,c=>o.put(UC(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?S.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,c=>this.wn(e,i,c).next(l=>{let h=this.Sn(o,c);return l.isEqual(h)?S.resolve():this.bn(e,o,c,l,h)}))))})}Dn(e,t,r,i){return No(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return No(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=No(e),o=new Te(Er);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new Ii(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Te(Er),i=this.Vn(t,e);if(i==null)return r;let o=gm(t);if(o!=null){let s=e.data.field(o.fieldPath);if(za(s))for(let a of s.arrayValue.values||[])r=r.add(new Ii(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Ii(t.indexId,e.key,Ul,i));return r}bn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(c,l,h,p,m){let y=c.getIterator(),C=l.getIterator(),A=Ro(y),R=Ro(C);for(;A||R;){let L=!1,$=!1;if(A&&R){let O=h(A,R);O<0?$=!0:O>0&&(L=!0)}else A!=null?$=!0:L=!0;L?(p(R),R=Ro(C)):$?(m(A),A=Ro(y)):(A=Ro(y),R=Ro(C))}}(i,o,Er,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),S.waitFor(s)}yn(e){let t=1;return Po(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Er(s,a)).filter((s,a,c)=>!a||Er(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Er(s,e),c=Er(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Ul,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Ul,[]];o.push(IDBKeyRange.bound(a,c))}return o}Cn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(WC)}getMinOffset(e,t){return S.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||H())).next(WC)}};function GC(n){return Ye(n,"collectionParents")}function No(n){return Ye(n,"indexEntries")}function Ma(n){return Ye(n,"indexConfiguration")}function Po(n){return Ye(n,"indexState")}function WC(n){K(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;cv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new qt(e.readTime,e.documentKey,t)}var KC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$t=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function g0(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(c.next(()=>{K(a===1)}));let l=[];for(let h of t.mutations){let p=Eb(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return S.waitFor(o).next(()=>l)}function md(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw H();e=n.noDocument}return JSON.stringify(e).length}$t.DEFAULT_COLLECTION_PERCENTILE=10,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$t.DEFAULT=new $t(41943040,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$t.DISABLED=new $t(-1,0,0);var yd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){K(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=jo(e),s=Dr(e);return s.add({}).next(a=>{K(typeof a=="number");let c=new Wa(a,t,r,i),l=function(y,C,A){let R=A.baseMutations.map($=>Ja(y.ct,$)),L=A.mutations.map($=>Ja(y.ct,$));return{userId:C,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:R,mutations:L}}(this.serializer,this.userId,c),h=[],p=new Te((m,y)=>re(m.canonicalString(),y.canonicalString()));for(let m of i){let y=Eb(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(y,Q1))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),S.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return Dr(e).get(t).next(r=>r?(K(r.userId===this.userId),wi(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?S.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Dr(e).J({index:"userMutationsIndex",range:i},(s,a,c)=>{a.userId===this.userId&&(K(a.batchId>=r),o=wi(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Dr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).U("userMutationsIndex",t).next(r=>r.map(i=>wi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=ql(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return jo(e).J({range:i},(s,a,c)=>{let[l,h,p]=s,m=vn(h);if(l===this.userId&&t.path.isEqual(m))return Dr(e).get(p).next(y=>{if(!y)throw H();K(y.userId===this.userId),o.push(wi(this.serializer,y))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(re),i=[];return t.forEach(o=>{let s=ql(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=jo(e).J({range:a},(l,h,p)=>{let[m,y,C]=l,A=vn(y);m===this.userId&&o.path.isEqual(A)?r=r.add(C):p.done()});i.push(c)}),S.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=ql(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Te(re);return jo(e).J({range:s},(c,l,h)=>{let[p,m,y]=c,C=vn(m);p===this.userId&&r.isPrefixOf(C)?C.length===i&&(a=a.add(y)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Dr(e).get(o).next(s=>{if(s===null)throw H();K(s.userId===this.userId),r.push(wi(this.serializer,s))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return g0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return jo(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=vn(o[1]);i.push(c)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,t){return m0(e,this.userId,t)}Nn(e){return y0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function m0(n,e,t){let r=ql(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return jo(n).J({range:o,H:!0},(a,c,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function Dr(n){return Ye(n,"mutations")}function jo(n){return Ye(n,"documentMutations")}function y0(n){return Ye(n,"mutationQueues")}var Jo=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var ey=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new Jo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Y.fromTimestamp(new Pe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ko(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return ko(e).J((s,a)=>{let c=ka(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>S.waitFor(o)).next(()=>i)}forEachTarget(e,t){return ko(e).J((r,i)=>{let o=ka(i);t(o)})}qn(e){return QC(e).get("targetGlobalKey").next(t=>(K(t!==null),t))}Qn(e,t){return QC(e).put("targetGlobalKey",t)}Kn(e,t){return ko(e).put(h0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Si(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ko(e).J({range:i,index:"queryTargetsIndex"},(s,a,c)=>{let l=ka(a);lu(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=Tr(e);return t.forEach(s=>{let a=wt(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=Tr(e);return S.forEach(t,o=>{let s=wt(o.path);return S.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=Tr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Tr(e),o=ie();return i.J({range:r,H:!0},(s,a,c)=>{let l=vn(s[1]),h=new B(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=wt(t.path),i=IDBKeyRange.bound([r],[mb(r)],!1,!0),o=0;return Tr(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return ko(e).get(t).next(r=>r?ka(r):null)}};function ko(n){return Ye(n,"targets")}function QC(n){return Ye(n,"targetGlobal")}function Tr(n){return Ye(n,"targetDocuments")}function YC([n,e],[t,r]){let i=re(n,t);return i===0?re(e,r):i}var ty=class{constructor(e){this.Un=e,this.buffer=new Te(YC),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();YC(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},ny=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>N(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){jr(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Vr(t)}yield this.Hn(3e5)}))}},ry=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(Rt.oe);let r=new ty(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(KC)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),KC):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,c,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Oo()<=cn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function qO(n,e){return new ry(n,e)}var iy=class{constructor(e,t){this.db=e,this.garbageCollector=qO(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Bl(e,r)}removeReference(e,t,r){return Bl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Bl(e,t)}nr(e,t){return function(i,o){let s=!1;return y0(i).Y(a=>m0(i,a,o).next(c=>(c&&(s=!0),S.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let c=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,Y.min()),Tr(e).delete(function(p){return[0,wt(p.path)]}(s))))});i.push(c)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Bl(e,t)}tr(e,t){let r=Tr(e),i,o=Rt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==Rt.oe&&t(new B(vn(i)),o),o=l,i=c):o=Rt.oe}).next(()=>{o!==Rt.oe&&t(new B(vn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Bl(n,e){return Tr(n).put(function(r,i){return{targetId:0,path:wt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var vd=class{constructor(){this.changes=new Cn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ke.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var oy=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return mi(e).put(r)}removeEntry(e,t,r){return mi(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],hd(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ke.newInvalidDocument(t);return mi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ra(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:Ke.newInvalidDocument(t)};return mi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ra(t))},(i,o)=>{r={document:this.ir(t,o),size:md(o)}}).next(()=>r)}getEntries(e,t){let r=St();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=St(),i=new Ae(B.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,md(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return S.resolve();let i=new Te(XC);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(Ra(i.first()),Ra(i.last())),s=i.getIterator(),a=s.getNext();return mi(e).J({index:"documentKeyIndex",range:o},(c,l,h)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&XC(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Ra(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),hd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return mi(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=St();for(let p of l){let m=this.ir(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(hu(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=St(),s=JC(t,r),a=JC(t,qt.max());return mi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(c,l,h)=>{let p=this.ir(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new sy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ZC(e).get("remoteDocumentGlobalKey").next(t=>(K(!!t),t))}rr(e,t){return ZC(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=BO(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Y.min())))return r}return Ke.newInvalidDocument(e)}};function v0(n){return new oy(n)}var sy=class extends vd{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Cn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Te((o,s)=>re(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=VC(this.cr.serializer,s);i=i.add(o.path.popLast());let l=md(c);r+=l-a.size,t.push(this.cr.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=VC(this.cr.serializer,s.convertToNoDocument(Y.min()));t.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function ZC(n){return Ye(n,"remoteDocumentGlobal")}function mi(n){return Ye(n,"remoteDocumentsV14")}function Ra(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function JC(n,e){let t=e.documentKey.path.toArray();return[n,hd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function XC(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=re(t[o],r[o]),i)return i;return i=re(t.length,r.length),i||(i=re(t[t.length-2],r[r.length-2]),i||re(t[t.length-1],r[r.length-1]))}var ay=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var wd=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&La(r.mutation,i,Nt.empty(),Pe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){let i=wn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Pa();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=wn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=St(),s=Fa(),a=function(){return Fa()}();return t.forEach((c,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof on)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),La(h.mutation,l,h.mutation.getFieldMask(),Pe.now())):s.set(l.key,Nt.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new ay(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Fa(),i=new Ae((s,a)=>s-a),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let h=r.get(c)||Nt.empty();h=a.applyToLocalView(l,h),r.set(c,h);let p=(i.get(a.batchId)||ie()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,p=$b();h.forEach(m=>{if(!o.has(m)){let y=Qb(t.get(m),r.get(m));y!==null&&p.set(m,y),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return S.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):S.resolve(wn()),a=-1,c=o;return s.next(l=>S.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?S.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,ie())).next(h=>({batchId:a,changes:Bb(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Pa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Pa();return this.indexManager.getCollectionParents(e,o).next(a=>S.forEach(a,c=>{let l=function(p,m){return new rn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Ke.newInvalidDocument(h)))});let a=Pa();return s.forEach((c,l)=>{let h=o.get(c);h!==void 0&&La(h.mutation,l,Nt.empty(),Pe.now()),hu(t,l)&&(a=a.insert(c,l))}),a})}};var uy=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return S.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Be(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:vv(i.bundledQuery),readTime:Be(i.readTime)}}(t)),S.resolve()}};var cy=class{constructor(){this.overlays=new Ae(B.comparator),this.Ir=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=wn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=wn(),o=t.length+1,s=new B(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ae((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=wn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=wn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return S.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Ka(t,r));let o=this.Ir.get(t);o===void 0&&(o=ie(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var ly=class{constructor(){this.sessionToken=$e.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var eu=class{constructor(){this.Tr=new Te(ze.Er),this.dr=new Te(ze.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new ze(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ze(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new pe([])),r=new ze(t,e),i=new ze(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new pe([])),r=new ze(t,e),i=new ze(t,e+1),o=ie();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new ze(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ze=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||re(e.wr,t.wr)}static Ar(e,t){return re(e.wr,t.wr)||B.comparator(e.key,t.key)}};var dy=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Te(ze.Er)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Wa(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new ze(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return S.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ze(t,0),i=new ze(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),S.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(re);return t.forEach(i=>{let o=new ze(i,0),s=new ze(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),S.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new ze(new B(o),0),a=new Te(re);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},s),S.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){K(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return S.forEach(t.mutations,i=>{let o=new ze(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new ze(t,0),i=this.br.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var hy=class{constructor(e){this.Mr=e,this.docs=function(){return new Ae(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Ke.newInvalidDocument(t))}getEntries(e,t){let r=St();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ke.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=St(),s=t.path,a=new B(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||cv(vb(h),r)<=0||(i.has(h.key)||hu(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return S.resolve(o)}getAllFromCollectionGroup(e,t,r,i){H()}Or(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new fy(this)}getSize(e){return S.resolve(this.size)}},fy=class extends vd{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var py=class{constructor(e){this.persistence=e,this.Nr=new Cn(t=>Si(t),lu),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Lr=0,this.Br=new eu,this.targetCount=0,this.kr=Jo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),S.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Jo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.Kn(t),S.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(o).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),S.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.Br.containsKey(t))}};var _d=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Rt(0),this.Kr=!1,this.Kr=!0,this.$r=new ly,this.referenceDelegate=e(this),this.Ur=new py(this),this.indexManager=new Jm,this.remoteDocumentCache=function(i){return new hy(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new dd(t),this.Gr=new uy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new cy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new dy(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new gy(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return S.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},gy=class extends Xl{constructor(e){super(),this.currentSequenceNumber=e}},Id=class n{constructor(e){this.persistence=e,this.Jr=new eu,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw H()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),S.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,Y.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return S.or([()=>S.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var my=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new ed("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gC,{unique:!0}),c.createObjectStore("documentMutations")}(e),eb(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=S.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),eb(e)),s=s.next(()=>function(c){let l=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gC,{unique:!0});let p=l.store("mutations"),m=h.map(y=>p.put(y));return S.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:aO});l.createIndex("collectionPathOverlayIndex",uO,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",cO,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:Y1});l.createIndex("documentKeyIndex",Z1),l.createIndex("collectionGroupIndex",J1)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:rO}).createIndex("sequenceNumberIndex",iO,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:oO}).createIndex("documentKeyIndex",sO,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=md(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>S.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>S.forEach(a,c=>{K(c.userId===o.userId);let l=wi(this.serializer,c);return g0(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let c=new pe(s),l=function(p){return[0,wt(p)]}(c);o.push(t.get(l).next(h=>h?S.resolve():(p=>t.put({targetId:0,path:wt(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>S.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:nO});let r=t.store("collectionParents"),i=new Xa,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:wt(c)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let c=new pe(s);return o(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,c],l)=>{let h=vn(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=ka(i),s=h0(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),c=function(p){return p.document?new B(pe.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):H()}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>S.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=v0(this.serializer),o=new _d(Id.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();wi(this.serializer,c).keys().forEach(p=>h=h.add(p)),a.set(c.userId,h)}),S.forEach(a,(c,l)=>{let h=new Ge(l),p=fd.lt(this.serializer,h),m=o.getIndexManager(h),y=yd.lt(h,this.serializer,m,o.referenceDelegate);return new wd(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new $a(t,Rt.oe),c).next()})})}};function eb(n){n.createObjectStore("targetDocuments",{keyPath:eO}).createIndex("documentTargetsIndex",tO,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",X1,{unique:!0}),n.createObjectStore("targetGlobal")}var om="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yy=class n{constructor(e,t,r,i,o,s,a,c,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new P(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new iy(this,i),this.Ai=t+"main",this.serializer=new dd(c),this.Ri=new xr(this.Ai,this.hi,new my(this.serializer)),this.$r=new zm,this.Ur=new ey(this.referenceDelegate,this.serializer),this.remoteDocumentCache=v0(this.serializer),this.Gr=new qm,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,om);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Rt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>N(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>N(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>N(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$l(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(jr(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Na(e).get("owner").next(t=>S.resolve(this.vi(t)))}Ci(e){return $l(e).delete(this.clientId)}Fi(){return N(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ye(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return S.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?S.resolve(!0):Na(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,om);return!1}}return!(!this.networkEnabled||!this.inForeground)||$l(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return N(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new $a(e,Rt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>$l(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return yd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Xm(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return fd.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?hO:c===16?dO:c===15?dv:c===14?Cb:c===13?Tb:c===12?lO:c===11?Db:void H()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new $a(a,this.Qr?this.Qr.next():Rt.oe),t==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new P(x.FAILED_PRECONDITION,wb);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return Na(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(x.FAILED_PRECONDITION,om)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Na(e).put("owner",t)}static D(){return xr.D()}bi(e){let t=Na(e);return t.get("owner").next(r=>this.vi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):S.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;sf()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Na(n){return Ye(n,"owner")}function $l(n){return Ye(n,"clientMetadata")}function _v(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var vy=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ie(),i=ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var wy=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ed=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return sf()?8:_b(Ks())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new wy;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Oo()<=cn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Fo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),S.resolve()):(Oo()<=cn.DEBUG&&k("QueryEngine","Query:",Fo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Oo()<=cn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Fo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_t(t))):S.resolve())}Yi(e,t){if(SC(t))return S.resolve(null);let r=_t(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ad(t,null,"F"),r=_t(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ie(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,s,c.readTime)?this.Yi(e,ad(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return SC(t)||i.isEqual(Y.min())?S.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?S.resolve(null):(Oo()<=cn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fo(t)),this.rs(e,s,t,yb(i,-1)).next(a=>a))})}ts(e,t){let r=new Te(jb(e));return t.forEach((i,o)=>{hu(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Oo()<=cn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Fo(t)),this.Ji.getDocumentsMatchingQuery(e,t,qt.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var _y=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ae(re),this._s=new Cn(o=>Si(o),lu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wd(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function w0(n,e,t,r){return new _y(n,e,t,r)}function _0(n,e){return N(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=ie();for(let l of i){s.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function zO(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let p=l.batch,m=p.keys(),y=S.resolve();return m.forEach(C=>{y=y.next(()=>h.getEntry(c,C)).next(A=>{let R=l.docVersions.get(C);K(R!==null),A.version.compareTo(R)<0&&(p.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),h.addEntry(A)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function I0(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function GO(n,e){let t=U(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let y=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken($e.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(A,R,L){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(m,y,h)&&a.push(t.Ur.updateTargetData(o,y))});let c=St(),l=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(E0(o,s,e.documentUpdates).next(h=>{c=h.Ps,l=h.Is})),!r.isEqual(Y.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return S.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.os=i,o))}function E0(n,e,t){let r=ie(),i=ie();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=St();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Y.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function WO(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Xo(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,S.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new Zo(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function es(n,e,t){return N(this,null,function*(){let r=U(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!jr(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Dd(n,e,t){let r=U(n),i=Y.min(),o=ie();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,h){let p=U(c),m=p._s.get(h);return m!==void 0?S.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,_t(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:Y.min(),t?o:ie())).next(a=>(C0(r,Vb(e),a),{documents:a,Ts:o})))}function D0(n,e){let t=U(n),r=U(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function T0(n,e){let t=U(n),r=t.us.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,yb(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(C0(t,e,i),i))}function C0(n,e,t){let r=n.us.get(e)||Y.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function KO(n,e,t,r){return N(this,null,function*(){let i=U(n),o=ie(),s=St();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield Xo(i,function(h){return _t(us(pe.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>E0(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function QO(r,i){return N(this,arguments,function*(n,e,t=ie()){let o=yield Xo(n,_t(vv(e.bundledQuery))),s=U(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=Be(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken($e.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function tb(n,e){return`firestore_clients_${n}_${e}`}function nb(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function sm(n,e){return`firestore_targets_${n}_${e}`}var Td=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Va=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Cd=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=gv();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=Ib(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Iy=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}},tu=class{constructor(){this.activeTargetIds=gv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},ja=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ae(re),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=tb(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new tu),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return N(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(tb(this.persistenceKey,r));if(i){let o=Cd.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(sm(this.persistenceKey,e));if(r){let i=Va.Rs(e,r);i&&(t=i.state)}}return this.Ks.fs(e),this.Ns(),t}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(sm(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>N(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=Rt.oe;if(o!=null)try{let a=JSON.parse(o);K(typeof a=="number"),s=a}catch(a){je("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==Rt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Td(this.currentUser,e,t,r),o=nb(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=nb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=sm(this.persistenceKey,e),o=new Va(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return Cd.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Td.Rs(new Ge(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Va.Rs(i,t)}Ls(e){return Iy.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return N(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=gv();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},bd=class{constructor(){this.so=new tu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new tu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ey=class{_o(e){}shutdown(){}};var Sd=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Hl=null;function am(){return Hl===null?Hl=function(){return 268435456+Math.round(2147483648*Math.random())}():Hl++,"0x"+Hl.toString(16)}var YO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Dy=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var lt="WebChannelConnection",Ty=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=am(),c=this.xo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,c,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Ht("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+as}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=YO[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=am();return new Promise((s,a)=>{let c=new Jg;c.setWithCredentials(!0),c.listenOnce(em.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Aa.NO_ERROR:let h=c.getResponseJson();k(lt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Aa.TIMEOUT:k(lt,`RPC '${e}' ${o} timed out`),a(new P(x.DEADLINE_EXCEEDED,"Request time out"));break;case Aa.HTTP_ERROR:let p=c.getStatus();if(k(lt,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let y=m?.error;if(y&&y.status&&y.message){let C=function(R){let L=R.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(L)>=0?L:x.UNKNOWN}(y.status);a(new P(C,y.message))}else a(new P(x.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(x.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{k(lt,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(lt,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=am(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=rm(),a=nm(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Xg({})),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=o.join("");k(lt,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=s.createWebChannel(h,c),m=!1,y=!1,C=new Dy({Io:R=>{y?k(lt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(m||(k(lt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(lt,`RPC '${e}' stream ${i} sending:`,R),p.send(R))},To:()=>p.close()}),A=(R,L,$)=>{R.listen(L,O=>{try{$(O)}catch(G){setTimeout(()=>{throw G},0)}})};return A(p,Mo.EventType.OPEN,()=>{y||(k(lt,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),A(p,Mo.EventType.CLOSE,()=>{y||(y=!0,k(lt,`RPC '${e}' stream ${i} transport closed`),C.So())}),A(p,Mo.EventType.ERROR,R=>{y||(y=!0,Ht(lt,`RPC '${e}' stream ${i} transport errored:`,R),C.So(new P(x.UNAVAILABLE,"The operation could not be completed")))}),A(p,Mo.EventType.MESSAGE,R=>{var L;if(!y){let $=R.data[0];K(!!$);let O=$,G=O.error||((L=O[0])===null||L===void 0?void 0:L.error);if(G){k(lt,`RPC '${e}' stream ${i} received error:`,G);let X=G.status,Q=function(_){let E=qe[_];if(E!==void 0)return Jb(E)}(X),I=G.message;Q===void 0&&(Q=x.INTERNAL,I="Unknown error status: "+X+" with message "+G.message),y=!0,C.So(new P(Q,I)),p.close()}else k(lt,`RPC '${e}' stream ${i} received:`,$),C.bo($)}}),A(a,tm.STAT_EVENT,R=>{R.stat===jl.PROXY?k(lt,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===jl.NOPROXY&&k(lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}};function b0(){return typeof window<"u"?window:null}function Kl(){return typeof document<"u"?document:null}function fu(n){return new jm(n,!0)}var nu=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Ad=class{constructor(e,t,r,i,o,s,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new nu(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return N(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return N(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return N(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(je(t.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new P(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>N(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Cy=class extends Ad{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=kO(this.serializer,e),r=function(o){if(!("targetChange"in o))return Y.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Y.min():s.readTime?Be(s.readTime):Y.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=$m(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=od(c)?{documents:s0(o,c)}:{query:a0(o,c)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=e0(o,s.resumeToken);let l=Um(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(Y.min())>0){a.readTime=Yo(o,s.snapshotVersion.toTimestamp());let l=Um(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=FO(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=$m(this.serializer),t.removeTarget=e,this.a_(t)}},by=class extends Ad{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return K(!!e.streamToken),this.lastStreamToken=e.streamToken,K(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=OO(e.writeResults,e.commitTime),r=Be(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=$m(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ja(this.serializer,r))};this.a_(t)}};var Sy=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Bm(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(x.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Bm(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(x.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Ay=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(je(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var xy=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>N(this,null,function*(){Ur(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return N(this,null,function*(){let l=U(c);l.L_.add(4),yield cs(l),l.q_.set("Unknown"),l.L_.delete(4),yield pu(l)})}(this))}))}),this.q_=new Ay(r,i)}};function pu(n){return N(this,null,function*(){if(Ur(n))for(let e of n.B_)yield e(!0)})}function cs(n){return N(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Kd(n,e){let t=U(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Dv(t)?Ev(t):ds(t).r_()&&Iv(t,e))}function ts(n,e){let t=U(n),r=ds(t);t.N_.delete(e),r.r_()&&S0(t,e),t.N_.size===0&&(r.r_()?r.o_():Ur(t)&&t.q_.set("Unknown"))}function Iv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ds(n).A_(e)}function S0(n,e){n.Q_.xe(e),ds(n).R_(e)}function Ev(n){n.Q_=new Vm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ds(n).start(),n.q_.v_()}function Dv(n){return Ur(n)&&!ds(n).n_()&&n.N_.size>0}function Ur(n){return U(n).L_.size===0}function A0(n){n.Q_=void 0}function ZO(n){return N(this,null,function*(){n.q_.set("Online")})}function JO(n){return N(this,null,function*(){n.N_.forEach((e,t)=>{Iv(n,e)})})}function XO(n,e){return N(this,null,function*(){A0(n),Dv(n)?(n.q_.M_(e),Ev(n)):n.q_.set("Unknown")})}function eF(n,e,t){return N(this,null,function*(){if(n.q_.set("Online"),e instanceof cd&&e.state===2&&e.cause)try{yield function(i,o){return N(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield xd(n,r)}else if(e instanceof Ho?n.Q_.Ke(e):e instanceof ud?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Y.min()))try{let r=yield I0(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken($e.EMPTY_BYTE_STRING,h.snapshotVersion)),S0(o,c);let p=new Zo(h.target,c,l,h.sequenceNumber);Iv(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield xd(n,r)}})}function xd(n,e,t){return N(this,null,function*(){if(!jr(e))throw e;n.L_.add(1),yield cs(n),n.q_.set("Offline"),t||(t=()=>I0(n.localStore)),n.asyncQueue.enqueueRetryable(()=>N(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield pu(n)}))})}function x0(n,e){return e().catch(t=>xd(n,t,e))}function ls(n){return N(this,null,function*(){let e=U(n),t=Lr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;tF(e);)try{let i=yield WO(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,nF(e,i)}catch(i){yield xd(e,i)}M0(e)&&R0(e)})}function tF(n){return Ur(n)&&n.O_.length<10}function nF(n,e){n.O_.push(e);let t=Lr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function M0(n){return Ur(n)&&!Lr(n).n_()&&n.O_.length>0}function R0(n){Lr(n).start()}function rF(n){return N(this,null,function*(){Lr(n).p_()})}function iF(n){return N(this,null,function*(){let e=Lr(n);for(let t of n.O_)e.m_(t.mutations)})}function oF(n,e,t){return N(this,null,function*(){let r=n.O_.shift(),i=Om.from(r,e,t);yield x0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ls(n)})}function sF(n,e){return N(this,null,function*(){e&&Lr(n).V_&&(yield function(r,i){return N(this,null,function*(){if(function(s){return Zb(s)&&s!==x.ABORTED}(i.code)){let o=r.O_.shift();Lr(r).s_(),yield x0(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield ls(r)}})}(n,e)),M0(n)&&R0(n)})}function rb(n,e){return N(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=Ur(t);t.L_.add(3),yield cs(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield pu(t)})}function My(n,e){return N(this,null,function*(){let t=U(n);e?(t.L_.delete(2),yield pu(t)):e||(t.L_.add(2),yield cs(t),t.q_.set("Unknown"))})}function ds(n){return n.K_||(n.K_=function(t,r,i){let o=U(t);return o.w_(),new Cy(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:ZO.bind(null,n),Ro:JO.bind(null,n),mo:XO.bind(null,n),d_:eF.bind(null,n)}),n.B_.push(e=>N(this,null,function*(){e?(n.K_.s_(),Dv(n)?Ev(n):n.q_.set("Unknown")):(yield n.K_.stop(),A0(n))}))),n.K_}function Lr(n){return n.U_||(n.U_=function(t,r,i){let o=U(t);return o.w_(),new by(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rF.bind(null,n),mo:sF.bind(null,n),f_:iF.bind(null,n),g_:oF.bind(null,n)}),n.B_.push(e=>N(this,null,function*(){e?(n.U_.s_(),yield ls(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Ry=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function hs(n,e){if(je("AsyncQueue",`${e}: ${n}`),jr(n))return new P(x.UNAVAILABLE,`${e}: ${n}`);throw n}var Md=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Pa(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Rd=class{constructor(){this.W_=new Ae(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):H():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},ns=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Md.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&du(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Ny=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Py=class{constructor(){this.queries=ib(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=U(t),o=i.queries;i.queries=ib(),o.forEach((s,a)=>{for(let c of a.j_)c.onError(r)})})(this,new P(x.ABORTED,"Firestore shutting down"))}};function ib(){return new Cn(n=>Lb(n),du)}function Tv(n,e){return N(this,null,function*(){let t=U(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Ny,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=hs(s,`Initialization of query '${Fo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&bv(t)})}function Cv(n,e){return N(this,null,function*(){let t=U(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function aF(n,e){let t=U(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&bv(t)}function uF(n,e,t){let r=U(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function bv(n){n.Y_.forEach(e=>{e.next()})}var ky,ob;(ob=ky||(ky={})).ea="default",ob.Cache="cache";var ru=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ns(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ns.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ky.Cache}};var Oy=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Nd=class{constructor(e){this.serializer=e}Es(e){return In(this.serializer,e)}ds(e){return e.metadata.exists?o0(this.serializer,e.document,!1):Ke.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Be(e)}},Fy=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=N0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=pe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Nd(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ie()).add(o);t.set(s,a)}}return t}complete(){return N(this,null,function*(){let e=yield KO(this.localStore,new Nd(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield QO(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function N0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Pd=class{constructor(e){this.key=e}},kd=class{constructor(e){this.key=e}},Od=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ie(),this.mutatedKeys=ie(),this.Aa=jb(e),this.Ra=new Md(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Rd,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),y=hu(this.query,p)?p:null,C=!!m&&this.mutatedKeys.has(m.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),R=!1;m&&y?m.data.isEqual(y.data)?C!==A&&(r.track({type:3,doc:y}),R=!0):this.ga(m,y)||(r.track({type:2,doc:y}),R=!0,(c&&this.Aa(y,c)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),R=!0):m&&!y&&(r.track({type:1,doc:m}),R=!0,(c||l)&&(a=!0)),R&&(y?(s=s.add(y),o=A?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(y,C){let A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return A(y)-A(C)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,s.length!==0||l?{snapshot:new ns(this.query,e.Ra,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Rd,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new kd(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Pd(r))}),t}ba(e){this.Ta=e.Ts,this.da=ie();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ns.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Ly=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Vy=class{constructor(e){this.key=e,this.va=!1}},jy=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Cn(a=>Lb(a),du),this.Ma=new Map,this.xa=new Set,this.Oa=new Ae(B.comparator),this.Na=new Map,this.La=new eu,this.Ba={},this.ka=new Map,this.qa=Jo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function cF(n,e,t=!0){return N(this,null,function*(){let r=Qd(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield P0(r,e,t,!0),i})}function lF(n,e){return N(this,null,function*(){let t=Qd(n);yield P0(t,e,!0,!1)})}function P0(n,e,t,r){return N(this,null,function*(){let i=yield Xo(n.localStore,_t(e)),o=i.targetId,s=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",a;return r&&(a=yield Sv(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Kd(n.remoteStore,i),a})}function Sv(n,e,t,r,i){return N(this,null,function*(){n.Ka=(p,m,y)=>function(A,R,L,$){return N(this,null,function*(){let O=R.view.ma(L);O.ns&&(O=yield Dd(A.localStore,R.query,!1).then(({documents:I})=>R.view.ma(I,O)));let G=$&&$.targetChanges.get(R.targetId),X=$&&$.targetMismatches.get(R.targetId)!=null,Q=R.view.applyChanges(O,A.isPrimaryClient,G,X);return Uy(A,R.targetId,Q.wa),Q.snapshot})}(n,p,m,y);let o=yield Dd(n.localStore,e,!0),s=new Od(e,o.Ts),a=s.ma(o.documents),c=Ya.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);Uy(n,t,l.wa);let h=new Ly(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function dF(n,e,t){return N(this,null,function*(){let r=U(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!du(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield es(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ts(r.remoteStore,i.targetId),rs(r,i.targetId)}).catch(Vr))):(rs(r,i.targetId),yield es(r.localStore,i.targetId,!0))})}function hF(n,e){return N(this,null,function*(){let t=U(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ts(t.remoteStore,r.targetId))})}function fF(n,e,t){return N(this,null,function*(){let r=Rv(n);try{let i=yield function(s,a){let c=U(s),l=Pe.now(),h=a.reduce((y,C)=>y.add(C.key),ie()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=St(),A=ie();return c.cs.getEntries(y,h).next(R=>{C=R,C.forEach((L,$)=>{$.isValidDocument()||(A=A.add(L))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,C)).next(R=>{p=R;let L=[];for(let $ of a){let O=SO($,p.get($.key).overlayedDocument);O!=null&&L.push(new on($.key,O,Mb(O.value.mapValue),Le.exists(!0)))}return c.mutationQueue.addMutationBatch(y,l,L,a)}).next(R=>{m=R;let L=R.applyToLocalDocumentSet(p,A);return c.documentOverlayCache.saveOverlays(y,R.batchId,L)})}).then(()=>({batchId:m.batchId,changes:Bb(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Ba[s.currentUser.toKey()];l||(l=new Ae(re)),l=l.insert(a,c),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield Zn(r,i.changes),yield ls(r.remoteStore)}catch(i){let o=hs(i,"Failed to persist write");t.reject(o)}})}function k0(n,e){return N(this,null,function*(){let t=U(n);try{let r=yield GO(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?K(s.va):i.removedDocuments.size>0&&(K(s.va),s.va=!1))}),yield Zn(t,r,e)}catch(r){yield Vr(r)}})}function sb(n,e,t){let r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=U(s);c.onlineState=a;let l=!1;c.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&bv(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function pF(n,e,t){return N(this,null,function*(){let r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new Ae(B.comparator);s=s.insert(o,Ke.newNoDocument(o,Y.min()));let a=ie().add(o),c=new Qa(Y.min(),new Map,new Ae(re),s,a);yield k0(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),Mv(r)}else yield es(r.localStore,e,!1).then(()=>rs(r,e,t)).catch(Vr)})}function gF(n,e){return N(this,null,function*(){let t=U(n),r=e.batch.batchId;try{let i=yield zO(t.localStore,e);xv(t,r,null),Av(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Zn(t,i)}catch(i){yield Vr(i)}})}function mF(n,e,t){return N(this,null,function*(){let r=U(n);try{let i=yield function(s,a){let c=U(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(K(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,e);xv(r,e,t),Av(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Zn(r,i)}catch(i){yield Vr(i)}})}function yF(n,e){return N(this,null,function*(){let t=U(n);Ur(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=U(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=hs(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Av(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function xv(n,e,t){let r=U(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function rs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||O0(n,r)})}function O0(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ts(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Mv(n))}function Uy(n,e,t){for(let r of t)r instanceof Pd?(n.La.addReference(r.key,e),vF(n,r)):r instanceof kd?(k("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||O0(n,r.key)):H()}function vF(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(r),Mv(n))}function Mv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(pe.fromString(e)),r=n.qa.next();n.Na.set(r,new Vy(t)),n.Oa=n.Oa.insert(t,r),Kd(n.remoteStore,new Zo(_t(us(t.path)),r,"TargetPurposeLimboResolution",Rt.oe))}}function Zn(n,e,t){return N(this,null,function*(){let r=U(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{s.push(r.Ka(c,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=vy.Wi(c.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(c,l){return N(this,null,function*(){let h=U(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(l,m=>S.forEach(m.$i,y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>S.forEach(m.Ui,y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!jr(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let y=h.os.get(m),C=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(C);h.os=h.os.insert(m,A)}}})}(r.localStore,o))})}function wF(n,e){return N(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield _0(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(c=>{c.reject(new P(x.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Zn(t,r.hs)}})}function _F(n,e){let t=U(n),r=t.Na.get(e);if(r&&r.va)return ie().add(r.key);{let i=ie(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function IF(n,e){return N(this,null,function*(){let t=U(n),r=yield Dd(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&Uy(t,e.targetId,i.wa),i})}function EF(n,e){return N(this,null,function*(){let t=U(n);return T0(t.localStore,e).then(r=>Zn(t,r))})}function DF(n,e,t,r){return N(this,null,function*(){let i=U(n),o=yield function(a,c){let l=U(a),h=U(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield ls(i.remoteStore):t==="acknowledged"||t==="rejected"?(xv(i,e,r||null),Av(i,e),function(a,c){U(U(a).mutationQueue).On(c)}(i.localStore,e)):H(),yield Zn(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function TF(n,e){return N(this,null,function*(){let t=U(n);if(Qd(t),Rv(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield ab(t,r.toArray());t.Qa=!0,yield My(t.remoteStore,!0);for(let o of i)Kd(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(rs(t,s),es(t.localStore,s,!0))),ts(t.remoteStore,s)}),yield i,yield ab(t,r),function(s){let a=U(s);a.Na.forEach((c,l)=>{ts(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Ae(B.comparator)}(t),t.Qa=!1,yield My(t.remoteStore,!1)}})}function ab(n,e,t){return N(this,null,function*(){let r=U(n),i=[],o=[];for(let s of e){let a,c=r.Ma.get(s);if(c&&c.length!==0){a=yield Xo(r.localStore,_t(c[0]));for(let l of c){let h=r.Fa.get(l),p=yield IF(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield D0(r.localStore,s);a=yield Xo(r.localStore,l),yield Sv(r,F0(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function F0(n){return Fb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function CF(n){return function(t){return U(U(t).persistence).Qi()}(U(n).localStore)}function bF(n,e,t,r){return N(this,null,function*(){let i=U(n);if(i.Qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield T0(i.localStore,Vb(o[0])),a=Qa.createSynthesizedRemoteEventForCurrentChange(e,t==="current",$e.EMPTY_BYTE_STRING);yield Zn(i,s,a);break}case"rejected":yield es(i.localStore,e,!0),rs(i,e,r);break;default:H()}})}function SF(n,e,t){return N(this,null,function*(){let r=Qd(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield D0(r.localStore,i),s=yield Xo(r.localStore,o);yield Sv(r,F0(o),s.targetId,!1,s.resumeToken),Kd(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield es(r.localStore,i,!1).then(()=>{ts(r.remoteStore,i),rs(r,i)}).catch(Vr))}})}function Qd(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=k0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_F.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pF.bind(null,e),e.Ca.d_=aF.bind(null,e.eventManager),e.Ca.$a=uF.bind(null,e.eventManager),e}function Rv(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mF.bind(null,e),e}function AF(n,e,t){let r=U(n);(function(o,s,a){return N(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(y,C){let A=U(y),R=Be(C.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",L=>A.Gr.getBundleMetadata(L,C.id)).then(L=>!!L&&L.createTime.compareTo(R)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(N0(c));let l=new Fy(c,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield Zn(o,p.Ia,void 0),yield function(y,C){let A=U(y);return A.persistence.runTransaction("Save bundle","readwrite",R=>A.Gr.saveBundleMetadata(R,C))}(o.localStore,c),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(c){return Ht("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var iu=class{constructor(){this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){this.serializer=fu(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return w0(this.persistence,new Ed,e.initialUser,this.serializer)}createPersistence(e){return new _d(Id.Zr,this.serializer)}createSharedClientState(e){return new bd}terminate(){return N(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Fd=class n extends iu{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return N(this,null,function*(){yield rf(n.prototype,this,"initialize").call(this,e),yield this.Wa.initialize(this,e),yield Rv(this.Wa.syncEngine),yield ls(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return w0(this.persistence,new Ed,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new ny(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new wm(t,this.persistence);return new vm(e.asyncQueue,r)}createPersistence(e){let t=_v(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?$t.withCacheSize(this.cacheSizeBytes):$t.DEFAULT;return new yy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,b0(),Kl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new bd}},By=class n extends Fd{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return N(this,null,function*(){yield rf(n.prototype,this,"initialize").call(this,e);let t=this.Wa.syncEngine;this.sharedClientState instanceof ja&&(this.sharedClientState.syncEngine={no:DF.bind(null,t),ro:bF.bind(null,t),io:SF.bind(null,t),Qi:CF.bind(null,t),eo:EF.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>N(this,null,function*(){yield TF(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=b0();if(!ja.D(t))throw new P(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=_v(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ja(t,e.asyncQueue,r,e.clientId,e.initialUser)}},ou=class{initialize(e,t){return N(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=wF.bind(null,this.syncEngine),yield My(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Py}()}createDatastore(e){let t=fu(e.databaseInfo.databaseId),r=function(o){return new Ty(o)}(e.databaseInfo);return function(o,s,a,c){return new Sy(o,s,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,s,a){return new xy(r,i,o,s,a)}(this.localStore,this.datastore,e.asyncQueue,t=>sb(this.syncEngine,t,0),function(){return Sd.D()?new Sd:new Ey}())}createSyncEngine(e,t){return function(i,o,s,a,c,l,h){let p=new jy(i,o,s,a,c,l);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return N(this,null,function*(){var e,t;yield function(i){return N(this,null,function*(){let o=U(i);k("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield cs(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function ub(n,e=10240){let t=0;return{read(){return N(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return N(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var is=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var $y=class{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new We,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}getMetadata(){return N(this,null,function*(){return this.metadata.promise})}Ua(){return N(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return N(this,null,function*(){let e=yield this.Ya();if(e===null)return null;let t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);let i=yield this.Xa(r);return new Oy(JSON.parse(i),e.length+r)})}eu(){return this.buffer.findIndex(e=>e===123)}Ya(){return N(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Xa(e){return N(this,null,function*(){for(;this.buffer.length<e;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}tu(){return N(this,null,function*(){let e=yield this.ja.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Hy=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return N(this,null,function*(){let s=U(i),a={documents:o.map(p=>Za(s.serializer,p))},c=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,pe.emptyPath(),a,o.length),l=new Map;c.forEach(p=>{let m=PO(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());K(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Fr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return N(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new Ga(i,this.precondition(i)))}),yield function(r,i){return N(this,null,function*(){let o=U(r),s={writes:i.map(a=>Ja(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,pe.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw H();t=Y.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?Le.exists(!1):Le.updateTime(t):Le.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new P(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Le.updateTime(t)}return Le.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var qy=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.nu=r.maxAttempts,this.t_=new nu(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>N(this,null,function*(){let e=new Hy(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})}))}su(e){try{let t=this.updateFunction(e);return!cu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Zb(t)}return!1}};var zy=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ge.UNAUTHENTICATED,this.clientId=Zl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>N(this,null,function*(){k("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(k("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=hs(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ql(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>N(this,null,function*(){r.isEqual(i)||(yield _0(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Gy(n,e){return N(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Nv(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>rb(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>rb(e.remoteStore,i)),n._onlineComponents=e})}function L0(n){return n.name==="FirebaseError"?n.code===x.FAILED_PRECONDITION||n.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function Nv(n){return N(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ql(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!L0(t))throw t;Ht("Error using user provided cache. Falling back to memory cache: "+t),yield Ql(n,new iu)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Ql(n,new iu);return n._offlineComponents})}function Yd(n){return N(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield Gy(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield Gy(n,new ou))),n._onlineComponents})}function V0(n){return Nv(n).then(e=>e.persistence)}function Pv(n){return Nv(n).then(e=>e.localStore)}function j0(n){return Yd(n).then(e=>e.remoteStore)}function kv(n){return Yd(n).then(e=>e.syncEngine)}function xF(n){return Yd(n).then(e=>e.datastore)}function os(n){return N(this,null,function*(){let e=yield Yd(n),t=e.eventManager;return t.onListen=cF.bind(null,e.syncEngine),t.onUnlisten=dF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=lF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=hF.bind(null,e.syncEngine),t})}function MF(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield V0(n),t=yield j0(n);return e.setNetworkEnabled(!0),function(i){let o=U(i);return o.L_.delete(0),pu(o)}(t)}))}function RF(n){return n.asyncQueue.enqueue(()=>N(this,null,function*(){let e=yield V0(n),t=yield j0(n);return e.setNetworkEnabled(!1),function(i){return N(this,null,function*(){let o=U(i);o.L_.add(0),yield cs(o),o.q_.set("Offline")})}(t)}))}function NF(n,e){let t=new We;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield function(l,h){let p=U(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=hs(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield Pv(n),e,t)})),t.promise}function U0(n,e,t={}){let r=new We;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,c,l){let h=new is({next:m=>{s.enqueueAndForget(()=>Cv(o,p));let y=m.docs.has(a);!y&&m.fromCache?l.reject(new P(x.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ru(us(a.path),h,{includeMetadataChanges:!0,_a:!0});return Tv(o,p)}(yield os(n),n.asyncQueue,e,t,r)})),r.promise}function PF(n,e){let t=new We;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o,s){return N(this,null,function*(){try{let a=yield Dd(i,o,!0),c=new Od(o,a.Ts),l=c.ma(a.documents),h=c.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let c=hs(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield Pv(n),e,t)})),t.promise}function B0(n,e,t={}){let r=new We;return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(o,s,a,c,l){let h=new is({next:m=>{s.enqueueAndForget(()=>Cv(o,p)),m.fromCache&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new ru(a,h,{includeMetadataChanges:!0,_a:!0});return Tv(o,p)}(yield os(n),n.asyncQueue,e,t,r)})),r.promise}function kF(n,e){let t=new is(e);return n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){U(i).Y_.add(o),o.next()}(yield os(n),t)})),()=>{t.za(),n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return function(i,o){U(i).Y_.delete(o)}(yield os(n),t)}))}}function OF(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?Xb().encode(s):s,function(h,p){return new $y(h,p)}(function(h,p){if(h instanceof Uint8Array)return ub(h,p);if(h instanceof ArrayBuffer)return ub(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,fu(e));n.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){AF(yield kv(n),i,r)}))}function FF(n,e){return n.asyncQueue.enqueue(()=>N(this,null,function*(){return function(r,i){let o=U(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield Pv(n),e)}))}function $0(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var cb=new Map;function Ov(n,e,t){if(!t)throw new P(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Fv(n,e,t,r){if(e===!0&&r===!0)throw new P(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function lb(n){if(!B.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function db(n){if(B.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Zd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H()}function ge(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Zd(n);throw new P(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function H0(n,e){if(e<=0)throw new P(x.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Ld=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ri=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ld({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ld(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new um;switch(r.type){case"firstParty":return new hm(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=cb.get(t);r&&(k("ComponentProvider","Removing Datastore"),cb.delete(t),r.terminate())}(this),Promise.resolve()}};function q0(n,e,t,r={}){var i;let o=(n=ge(n,Ri))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Ht("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ge.MOCK_USER;else{a=K_(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ge(l)}n._authCredentials=new cm(new Yl(a,c))}}var rt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new En(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},En=class n extends rt{constructor(e,t,r){super(e,t,us(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new be(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Lv(n,e,...t){if(n=Re(n),Ov("collection","path",e),n instanceof Ri){let r=pe.fromString(e,...t);return db(r),new En(n,null,r)}{if(!(n instanceof be||n instanceof En))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return db(r),new En(n.firestore,null,r)}}function z0(n,e){if(n=ge(n,Ri),Ov("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rt(n,null,function(r){return new rn(pe.emptyPath(),r)}(e))}function gu(n,e,...t){if(n=Re(n),arguments.length===1&&(e=Zl.newId()),Ov("doc","path",e),n instanceof Ri){let r=pe.fromString(e,...t);return lb(r),new be(n,null,new B(r))}{if(!(n instanceof be||n instanceof En))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return lb(r),new be(n.firestore,n instanceof En?n.converter:null,new B(r))}}function Vv(n,e){return n=Re(n),e=Re(e),(n instanceof be||n instanceof En)&&(e instanceof be||e instanceof En)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function jv(n,e){return n=Re(n),e=Re(e),n instanceof rt&&e instanceof rt&&n.firestore===e.firestore&&du(n._query,e._query)&&n.converter===e.converter}var Wy=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new nu(this,"async_queue_retry"),this.Eu=()=>{let t=Kl();t&&k("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Kl();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Kl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new We;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return N(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!jr(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=Ry.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&H()}verifyOperationInProgress(){}mu(){return N(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function Ky(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Qy=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new We,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var G0=-1,Me=class extends Ri{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Wy}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||W0(this),this._firestoreClient.terminate()}};function Ze(n){return n._firestoreClient||W0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function W0(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,h){return new _m(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,$0(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new zy(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function K0(n,e){rS(n=ge(n,Me));let t=Ze(n);if(t._uninitializedComponentsProvider)throw new P(x.FAILED_PRECONDITION,"SDK cache is already specified.");Ht("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new ou;return Y0(t,i,new Fd(i,r.cacheSizeBytes,e?.forceOwnership))}function Q0(n){rS(n=ge(n,Me));let e=Ze(n);if(e._uninitializedComponentsProvider)throw new P(x.FAILED_PRECONDITION,"SDK cache is already specified.");Ht("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new ou;return Y0(e,r,new By(r,t.cacheSizeBytes))}function Y0(n,e,t){let r=new We;return n.asyncQueue.enqueue(()=>N(this,null,function*(){try{yield Ql(n,t),yield Gy(n,e),r.resolve()}catch(i){let o=i;if(!L0(o))throw o;Ht("Error enabling indexeddb cache. Falling back to memory cache: "+o),r.reject(o)}})).then(()=>r.promise)}function Z0(n){if(n._initialized&&!n._terminated)throw new P(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new We;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>N(this,null,function*(){try{yield function(r){return N(this,null,function*(){if(!xr.D())return Promise.resolve();let i=r+"main";yield xr.delete(i)})}(_v(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function J0(n){return function(t){let r=new We;return t.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return yF(yield kv(t),r)})),r.promise}(Ze(n=ge(n,Me)))}function X0(n){return MF(Ze(n=ge(n,Me)))}function eS(n){return RF(Ze(n=ge(n,Me)))}function tS(n,e){let t=Ze(n=ge(n,Me)),r=new Qy;return OF(t,n._databaseId,e,r),r}function nS(n,e){return FF(Ze(n=ge(n,Me)),e).then(t=>t?new rt(n,null,t.query):null)}function rS(n){if(n._initialized||n._terminated)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var bn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n($e.fromBase64String(e))}catch(t){throw new P(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var sn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Qn=class{constructor(e){this._methodName=e}};var Ni=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var su=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var LF=/^__.*__$/,Yy=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new on(e,this.data,this.fieldMask,t,this.fieldTransforms):new Or(e,this.data,t,this.fieldTransforms)}},Vd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new on(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function iS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}var jd=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Ud(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(iS(this.wu)&&LF.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Zy=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||fu(e)}Nu(e,t,r,i=!1){return new jd({wu:e,methodName:t,Ou:r,path:Ue.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Fi(n){let e=n._freezeSettings(),t=fu(n._databaseId);return new Zy(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Jd(n,e,t,r,i,o={}){let s=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);$v("Data must be an object, but it was:",s,r);let a=aS(r,s),c,l;if(o.merge)c=new Nt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=nv(e,p,t);if(!s.contains(m))throw new P(x.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);cS(h,m)||h.push(m)}c=new Nt(h),l=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=s.fieldTransforms;return new Yy(new dt(a),c,l)}var au=class n extends Qn{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function oS(n,e,t){return new jd({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Jy=class n extends Qn{_toFieldTransform(e){return new Ai(e.path,new Pr)}isEqual(e){return e instanceof n}},Xy=class n extends Qn{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=oS(this,e,!0),r=this.Lu.map(o=>Li(o,t)),i=new Wn(r);return new Ai(e.path,i)}isEqual(e){return e instanceof n&&af(this.Lu,e.Lu)}},ev=class n extends Qn{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=oS(this,e,!0),r=this.Lu.map(o=>Li(o,t)),i=new Kn(r);return new Ai(e.path,i)}isEqual(e){return e instanceof n&&af(this.Lu,e.Lu)}},tv=class n extends Qn{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){let t=new kr(e.serializer,qb(e.serializer,this.Bu));return new Ai(e.path,t)}isEqual(e){return e instanceof n&&this.Bu===e.Bu}};function Uv(n,e,t,r){let i=n.Nu(1,e,t);$v("Data must be an object, but it was:",i,r);let o=[],s=dt.empty();Oi(r,(c,l)=>{let h=Hv(e,c,t);l=Re(l);let p=i.Cu(h);if(l instanceof au)o.push(h);else{let m=Li(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new Nt(o);return new Vd(s,a,i.fieldTransforms)}function Bv(n,e,t,r,i,o){let s=n.Nu(1,e,t),a=[nv(e,r,t)],c=[i];if(o.length%2!=0)throw new P(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(nv(e,o[m])),c.push(o[m+1]);let l=[],h=dt.empty();for(let m=a.length-1;m>=0;--m)if(!cS(l,a[m])){let y=a[m],C=c[m];C=Re(C);let A=s.Cu(y);if(C instanceof au)l.push(y);else{let R=Li(C,A);R!=null&&(l.push(y),h.set(y,R))}}let p=new Nt(l);return new Vd(h,p,s.fieldTransforms)}function sS(n,e,t,r=!1){return Li(t,n.Nu(r?4:3,e))}function Li(n,e){if(uS(n=Re(n)))return $v("Unsupported field value:",e,n),aS(n,e);if(n instanceof Qn)return function(r,i){if(!iS(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=Li(a,i.Fu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Pe.fromDate(r);return{timestampValue:Yo(i.serializer,o)}}if(r instanceof Pe){let o=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Yo(i.serializer,o)}}if(r instanceof Ni)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof bn)return{bytesValue:e0(i.serializer,r._byteString)};if(r instanceof be){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Mu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:yv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof su)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return mv(a.serializer,c)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Zd(r)}`)}(n,e)}function aS(n,e){let t={};return bb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oi(n,(r,i)=>{let o=Li(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function uS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof Ni||n instanceof bn||n instanceof be||n instanceof Qn||n instanceof su)}function $v(n,e,t){if(!uS(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Zd(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function nv(n,e,t){if((e=Re(e))instanceof sn)return e._internalPath;if(typeof e=="string")return Hv(n,e);throw Ud("Field path arguments must be of type string or ",n,!1,void 0,t)}var VF=new RegExp("[~\\*/\\[\\]]");function Hv(n,e,t){if(e.search(VF)>=0)throw Ud(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new sn(...e.split("."))._internalPath}catch{throw Ud(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ud(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new P(x.INVALID_ARGUMENT,a+n+c)}function cS(n,e){return n.some(t=>t.isEqual(e))}var Pi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new rv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Xd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},rv=class extends Pi{data(){return super.data()}};function Xd(n,e){return typeof e=="string"?Hv(n,e):e instanceof sn?e._internalPath:e._delegate._internalPath}function lS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var uu=class{},ki=class extends uu{};function Jn(n,e,...t){let r=[];e instanceof uu&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof iv).length,a=o.filter(c=>c instanceof Bd).length;if(s>1||s>0&&a>0)throw new P(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Bd=class n extends ki{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return _S(e._query,t),new rt(e.firestore,e.converter,Pm(e._query,t))}_parse(e){let t=Fi(e.firestore);return function(o,s,a,c,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){fb(p,h);let y=[];for(let C of p)y.push(hb(c,o,C));m={arrayValue:{values:y}}}else m=hb(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||fb(p,h),m=sS(a,s,p,h==="in"||h==="not-in");return ce.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function dS(n,e,t){let r=e,i=Xd("where",n);return Bd._create(i,r,t)}var iv=class n extends uu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ie.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)_S(s,c),s=Pm(s,c)}(e._query,t),new rt(e.firestore,e.converter,Pm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ov=class n extends ki{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bi(o,s)}(e._query,this._field,this._direction);return new rt(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new rn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function hS(n,e="asc"){let t=e,r=Xd("orderBy",n);return ov._create(r,t)}var $d=class n extends ki{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new rt(e.firestore,e.converter,ad(e._query,this._limit,this._limitType))}};function fS(n){return H0("limit",n),$d._create("limit",n,"F")}function pS(n){return H0("limitToLast",n),$d._create("limitToLast",n,"L")}var Hd=class n extends ki{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=wS(e,this.type,this._docOrFields,this._inclusive);return new rt(e.firestore,e.converter,function(i,o){return new rn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function gS(...n){return Hd._create("startAt",n,!0)}function mS(...n){return Hd._create("startAfter",n,!1)}var qd=class n extends ki{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=wS(e,this.type,this._docOrFields,this._inclusive);return new rt(e.firestore,e.converter,function(i,o){return new rn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function yS(...n){return qd._create("endBefore",n,!1)}function vS(...n){return qd._create("endAt",n,!0)}function wS(n,e,t,r){if(t[0]=Re(t[0]),t[0]instanceof Pi)return function(o,s,a,c,l){if(!c)throw new P(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of $o(o))if(p.field.isKeyField())h.push(Ci(s,c.key));else{let m=c.data.field(p.field);if(Gd(m))throw new P(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let y=p.field.canonicalString();throw new P(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new Tn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Fi(n.firestore);return function(s,a,c,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(x.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let C=0;C<h.length;C++){let A=h[C];if(m[C].field.isKeyField()){if(typeof A!="string")throw new P(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!pv(s)&&A.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let R=s.path.child(pe.fromString(A));if(!B.isDocumentKey(R))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let L=new B(R);y.push(Ci(a,L))}else{let R=sS(c,l,A);y.push(R)}}return new Tn(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function hb(n,e,t){if(typeof(t=Re(t))=="string"){if(t==="")throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pv(e)&&t.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!B.isDocumentKey(r))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ci(n,new B(r))}if(t instanceof be)return Ci(n,t._key);throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zd(t)}.`)}function fb(n,e){if(!Array.isArray(n)||n.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _S(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var ss=class{convertValue(e,t="none"){switch(Ti(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Mr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Oi(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>xe(s.doubleValue));return new su(o)}convertGeoPoint(e){return new Ni(xe(e.latitude),xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=hv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ha(e));default:return null}}convertTimestamp(e){let t=Gn(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);K(d0(r));let i=new Rr(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||je(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function eh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var sv=class extends ss{constructor(e){super(),this.firestore=e}convertBytes(e){return new bn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};var zn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},zt=class extends Pi{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Sr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Xd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Sr=class extends zt{data(e={}){return super.data(e)}},an=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new zn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Sr(this._firestore,this._userDataWriter,r.key,r,new zn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Sr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Sr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:jF(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function jF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}function qv(n,e){return n instanceof zt&&e instanceof zt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof an&&e instanceof an&&n._firestore===e._firestore&&jv(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function IS(n){n=ge(n,be);let e=ge(n.firestore,Me);return U0(Ze(e),n._key).then(t=>Kv(e,n,t))}var Yn=class extends ss{constructor(e){super(),this.firestore=e}convertBytes(e){return new bn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,t)}};function ES(n){n=ge(n,be);let e=ge(n.firestore,Me),t=Ze(e),r=new Yn(e);return NF(t,n._key).then(i=>new zt(e,r,n._key,i,new zn(i!==null&&i.hasLocalMutations,!0),n.converter))}function DS(n){n=ge(n,be);let e=ge(n.firestore,Me);return U0(Ze(e),n._key,{source:"server"}).then(t=>Kv(e,n,t))}function TS(n){n=ge(n,rt);let e=ge(n.firestore,Me),t=Ze(e),r=new Yn(e);return lS(n._query),B0(t,n._query).then(i=>new an(e,r,n,i))}function CS(n){n=ge(n,rt);let e=ge(n.firestore,Me),t=Ze(e),r=new Yn(e);return PF(t,n._query).then(i=>new an(e,r,n,i))}function bS(n){n=ge(n,rt);let e=ge(n.firestore,Me),t=Ze(e),r=new Yn(e);return B0(t,n._query,{source:"server"}).then(i=>new an(e,r,n,i))}function zv(n,e,t){n=ge(n,be);let r=ge(n.firestore,Me),i=eh(n.converter,e,t);return fs(r,[Jd(Fi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Le.none())])}function Gv(n,e,t,...r){n=ge(n,be);let i=ge(n.firestore,Me),o=Fi(i),s;return s=typeof(e=Re(e))=="string"||e instanceof sn?Bv(o,"updateDoc",n._key,e,t,r):Uv(o,"updateDoc",n._key,e),fs(i,[s.toMutation(n._key,Le.exists(!0))])}function SS(n){return fs(ge(n.firestore,Me),[new Fr(n._key,Le.none())])}function AS(n,e){let t=ge(n.firestore,Me),r=gu(n),i=eh(n.converter,e);return fs(t,[Jd(Fi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Le.exists(!1))]).then(()=>r)}function Wv(n,...e){var t,r,i;n=Re(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Ky(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Ky(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,h;if(n instanceof be)l=ge(n.firestore,Me),h=us(n._key.path),c={next:p=>{e[s]&&e[s](Kv(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=ge(n,rt);l=ge(p.firestore,Me),h=p._query;let m=new Yn(l);c={next:y=>{e[s]&&e[s](new an(l,m,p,y))},error:e[s+1],complete:e[s+2]},lS(n._query)}return function(m,y,C,A){let R=new is(A),L=new ru(y,R,C);return m.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return Tv(yield os(m),L)})),()=>{R.za(),m.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return Cv(yield os(m),L)}))}}(Ze(l),h,a,c)}function xS(n,e){return kF(Ze(n=ge(n,Me)),Ky(e)?e:{next:e})}function fs(n,e){return function(r,i){let o=new We;return r.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){return fF(yield kv(r),i,o)})),o.promise}(Ze(n),e)}function Kv(n,e,t){let r=t.docs.get(e._key),i=new Yn(n);return new zt(n,i,e._key,r,new zn(t.hasPendingWrites,t.fromCache),e.converter)}var UF={maxAttempts:5};var zd=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fi(e)}set(e,t,r){this._verifyNotCommitted();let i=Cr(e,this._firestore),o=eh(i.converter,t,r),s=Jd(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Le.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Cr(e,this._firestore),s;return s=typeof(t=Re(t))=="string"||t instanceof sn?Bv(this._dataReader,"WriteBatch.update",o._key,t,r,i):Uv(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Le.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Cr(e,this._firestore);return this._mutations=this._mutations.concat(new Fr(t._key,Le.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Cr(n,e){if((n=Re(n)).firestore!==e)throw new P(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var av=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Fi(t)}get(t){let r=Cr(t,this._firestore),i=new sv(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return H();let s=o[0];if(s.isFoundDocument())return new Pi(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Pi(this._firestore,i,r._key,null,r.converter);throw H()})}set(t,r,i){let o=Cr(t,this._firestore),s=eh(o.converter,r,i),a=Jd(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Cr(t,this._firestore),a;return a=typeof(r=Re(r))=="string"||r instanceof sn?Bv(this._dataReader,"Transaction.update",s._key,r,i,o):Uv(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Cr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Cr(e,this._firestore),r=new Yn(this._firestore);return super.get(e).then(i=>new zt(this._firestore,r,t._key,i._document,new zn(!1,!1),t.converter))}};function MS(n,e,t){n=ge(n,Me);let r=Object.assign(Object.assign({},UF),t);return function(o){if(o.maxAttempts<1)throw new P(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new We;return o.asyncQueue.enqueueAndForget(()=>N(this,null,function*(){let l=yield xF(o);new qy(o.asyncQueue,l,a,s,c).ru()})),c.promise}(Ze(n),i=>e(new av(n,i)),r)}function RS(){return new au("deleteField")}function NS(){return new Jy("serverTimestamp")}function PS(...n){return new Xy("arrayUnion",n)}function kS(...n){return new ev("arrayRemove",n)}function OS(n){return new tv("increment",n)}(function(e,t=!0){(function(i){as=i})(Z_),Qs(new Wr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Me(new lm(r.getProvider("auth-internal")),new pm(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rr(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),sr(hC,"4.7.1",e),sr(hC,"4.7.1","esm2017")})();var BF="@firebase/firestore-compat",$F="0.3.36";function ew(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function FS(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function LS(){if(!Sb())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var th=class n{constructor(e){this._delegate=e}static fromBase64String(e){return LS(),new n(bn.fromBase64String(e))}static fromUint8Array(e){return FS(),new n(bn.fromUint8Array(e))}toBase64(){return LS(),this._delegate.toBase64()}toUint8Array(){return FS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Qv(n){return HF(n,["next","error","complete"])}function HF(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Yv=class{enableIndexedDbPersistence(e,t){return K0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Q0(e._delegate)}clearIndexedDbPersistence(e){return Z0(e._delegate)}},nh=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Rr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ht("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){q0(this._delegate,e,t,r)}enableNetwork(){return X0(this._delegate)}disableNetwork(){return eS(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Fv("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return J0(this._delegate)}onSnapshotsInSync(e){return xS(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ms(this,Lv(this._delegate,e))}catch(t){throw It(t,"collection()","Firestore.collection()")}}doc(e){try{return new Sn(this,gu(this._delegate,e))}catch(t){throw It(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Bi(this,z0(this._delegate,e))}catch(t){throw It(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return MS(this._delegate,t=>e(new rh(this,t)))}batch(){return Ze(this._delegate),new ih(new zd(this._delegate,e=>fs(this._delegate,e)))}loadBundle(e){return tS(this._delegate,e)}namedQuery(e){return nS(this._delegate,e).then(t=>t?new Bi(this,t):null)}},ps=class extends ss{constructor(e){super(),this.firestore=e}convertBytes(e){return new th(new bn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Sn.forKey(t,this.firestore,null)}};function qF(n){pb(n)}var rh=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ps(e)}get(e){let t=Vi(e);return this._delegate.get(t).then(r=>new ji(this._firestore,new zt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Vi(e);return r?(ew("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Vi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Vi(e);return this._delegate.delete(t),this}},ih=class{constructor(e){this._delegate=e}set(e,t,r){let i=Vi(e);return r?(ew("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=Vi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=Vi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},gs=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Sr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ui(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new ps(e),t),i.set(t,o)),o}};gs.INSTANCES=new WeakMap;var Sn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ps(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new be(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new be(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ms(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ms(this.firestore,Lv(this._delegate,e))}catch(t){throw It(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Re(e),e instanceof be?Vv(this._delegate,e):!1}set(e,t){t=ew("DocumentReference.set",t);try{return t?zv(this._delegate,e,t):zv(this._delegate,e)}catch(r){throw It(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Gv(this._delegate,e):Gv(this._delegate,e,t,...r)}catch(i){throw It(i,"updateDoc()","DocumentReference.update()")}}delete(){return SS(this._delegate)}onSnapshot(...e){let t=VS(e),r=jS(e,i=>new ji(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Wv(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=ES(this._delegate):e?.source==="server"?t=DS(this._delegate):t=IS(this._delegate),t.then(r=>new ji(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function It(n,e,t){return n.message=n.message.replace(e,t),n}function VS(n){for(let e of n)if(typeof e=="object"&&!Qv(e))return e;return{}}function jS(n,e){var t,r;let i;return Qv(n[0])?i=n[0]:Qv(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ji=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Sn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return qv(this._delegate,e._delegate)}},Ui=class extends ji{data(e){let t=this._delegate.data(e);return this._delegate._converter||gb(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Bi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ps(e)}where(e,t,r){try{return new n(this.firestore,Jn(this._delegate,dS(e,t,r)))}catch(i){throw It(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Jn(this._delegate,hS(e,t)))}catch(r){throw It(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Jn(this._delegate,fS(e)))}catch(t){throw It(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Jn(this._delegate,pS(e)))}catch(t){throw It(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Jn(this._delegate,gS(...e)))}catch(t){throw It(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Jn(this._delegate,mS(...e)))}catch(t){throw It(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Jn(this._delegate,yS(...e)))}catch(t){throw It(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Jn(this._delegate,vS(...e)))}catch(t){throw It(t,"endAt()","Query.endAt()")}}isEqual(e){return jv(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=CS(this._delegate):e?.source==="server"?t=bS(this._delegate):t=TS(this._delegate),t.then(r=>new mu(this.firestore,new an(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=VS(e),r=jS(e,i=>new mu(this.firestore,new an(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Wv(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Zv=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ui(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},mu=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Bi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ui(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Zv(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ui(this._firestore,r))})}isEqual(e){return qv(this._delegate,e._delegate)}},ms=class n extends Bi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Sn(this.firestore,e):null}doc(e){try{return e===void 0?new Sn(this.firestore,gu(this._delegate)):new Sn(this.firestore,gu(this._delegate,e))}catch(t){throw It(t,"doc()","CollectionReference.doc()")}}add(e){return AS(this._delegate,e).then(t=>new Sn(this.firestore,t))}isEqual(e){return Vv(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Vi(n){return ge(n,be)}var Jv=class n{constructor(...e){this._delegate=new sn(...e)}static documentId(){return new n(Ue.keyField().canonicalString())}isEqual(e){return e=Re(e),e instanceof sn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Xv=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=NS();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=RS();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=PS(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=kS(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=OS(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var zF={Firestore:nh,GeoPoint:Ni,Timestamp:Pe,Blob:th,Transaction:rh,WriteBatch:ih,DocumentReference:Sn,DocumentSnapshot:ji,Query:Bi,QueryDocumentSnapshot:Ui,QuerySnapshot:mu,CollectionReference:ms,FieldPath:Jv,FieldValue:Xv,setLogLevel:qF,CACHE_SIZE_UNLIMITED:G0};function GF(n,e){n.INTERNAL.registerComponent(new Wr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},zF)))}function WF(n){GF(n,(e,t)=>new nh(e,t,new Yv)),n.registerVersion(BF,$F)}WF(Et);function KF(n,e=Xs){return new le(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function US(n,e){return KF(n,e)}function QF(n,e){return US(n,e).pipe(Xr(void 0),na(),ee(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function rw(n,e){return US(n,e).pipe(ee(t=>({payload:t,type:"query"})))}var oh=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=zS(r,t);return new ah(i,o,this.afs)}snapshotChanges(){return QF(this.ref,this.afs.schedulers.outsideAngular).pipe(bt)}valueChanges(e={}){return this.snapshotChanges().pipe(ee(({payload:t})=>e.idField?Ce(q({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return we(this.ref.get(e)).pipe(bt)}};function sh(n,e){return rw(n,e).pipe(Xr(void 0),na(),ee(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function BS(n,e,t){return sh(n,t).pipe(Jr((r,i)=>YF(r,i.map(o=>o.payload),e),[]),Rf(),ee(r=>r.map(i=>({type:i.type,payload:i}))))}function YF(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=ZF(n,r))}),n}function tw(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function ZF(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return tw(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return tw(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return tw(n,e.oldIndex,1);break}return n}function $S(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var ah=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=sh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(ee(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Xr(void 0),na(),tt(([r,i])=>i.length>0||!r),ee(([,r])=>r),bt)}auditTrail(e){return this.stateChanges(e).pipe(Jr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=$S(e);return BS(this.query,t,this.afs.schedulers.outsideAngular).pipe(bt)}valueChanges(e={}){return rw(this.query,this.afs.schedulers.outsideAngular).pipe(ee(t=>t.payload.docs.map(r=>e.idField?Ce(q({},r.data()),{[e.idField]:r.id}):r.data())),bt)}get(e){return we(this.query.get(e)).pipe(bt)}add(e){return this.ref.add(e)}doc(e){return new oh(this.ref.doc(e),this.afs)}},nw=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?sh(this.query,this.afs.schedulers.outsideAngular).pipe(bt):sh(this.query,this.afs.schedulers.outsideAngular).pipe(ee(t=>t.filter(r=>e.indexOf(r.type)>-1)),tt(t=>t.length>0),bt)}auditTrail(e){return this.stateChanges(e).pipe(Jr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=$S(e);return BS(this.query,t,this.afs.schedulers.outsideAngular).pipe(bt)}valueChanges(e={}){return rw(this.query,this.afs.schedulers.outsideAngular).pipe(ee(r=>r.payload.docs.map(i=>e.idField?q({[e.idField]:i.id},i.data()):i.data())),bt)}get(e){return we(this.query.get(e)).pipe(bt)}},HS=new z("angularfire2.enableFirestorePersistence"),qS=new z("angularfire2.firestore.persistenceSettings"),JF=new z("angularfire2.firestore.settings"),XF=new z("angularfire2.firestore.use-emulator");function zS(n,e=t=>t){return{query:e(n),ref:n}}var iw=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,o,s,a,c,l,h,p,m,y,C,A,R,L,$){this.schedulers=c;let O=ba(t,a,r),G=h;p&&Yg(O,a,m,C,A,R,y,L),[this.firestore,this.persistenceEnabled$]=Fl(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{let X=a.runOutsideAngular(()=>O.firestore());if(o&&X.settings(o),G&&X.useEmulator(...G),i&&!pi(s)){let Q=()=>{try{return we(X.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),Z(!1)}};return[X,a.runOutsideAngular(Q)]}else return[X,Z(!1)]},[o,G,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=zS(i,r),a=this.schedulers.ngZone.run(()=>o);return new ah(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new nw(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new oh(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(F(Ao),F(xo,8),F(HS,8),F(JF,8),F(Ct),F(he),F(kl),F(qS,8),F(XF,8),F(cC,8),F(qg,8),F(zg,8),F(Gg,8),F(Wg,8),F(Kg,8),F(Qg,8),F(gi,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),GS=(()=>{class n{constructor(){Et.registerVersion("angularfire",So.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:HS,useValue:!0},{provide:qS,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=ct({type:n});static \u0275inj=ut({providers:[iw]})}return n})();var WS={apiKey:"AIzaSyBia2IEyDJQ19hnNah3x3FI9s0omrWITZk",authDomain:"dsa-roadmap.firebaseapp.com",projectId:"dsa-roadmap",storageBucket:"dsa-roadmap.appspot.com",messagingSenderId:"914631704450",appId:"1:914631704450:web:266e2b4f1f53ef12d3d99b"};var oe="primary",Ru=Symbol("RouteTitle"),cw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Es(n){return new cw(n)}function tL(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function nL(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!An(n[t],e[t]))return!1;return!0}function An(n,e){let t=n?lw(n):void 0,r=e?lw(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!iA(n[i],e[i]))return!1;return!0}function lw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function iA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function oA(n){return n.length>0?n[n.length-1]:null}function $r(n){return Af(n)?n:_a(n)?we(Promise.resolve(n)):Z(n)}var rL={exact:aA,subset:uA},sA={exact:iL,subset:oL,ignored:()=>!0};function KS(n,e,t){return rL[t.paths](n.root,e.root,t.matrixParams)&&sA[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function iL(n,e){return An(n,e)}function aA(n,e,t){if(!Hi(n.segments,e.segments)||!lh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!aA(n.children[r],e.children[r],t))return!1;return!0}function oL(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>iA(n[t],e[t]))}function uA(n,e,t){return cA(n,e,e.segments,t)}function cA(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Hi(i,t)||e.hasChildren()||!lh(i,t,r))}else if(n.segments.length===t.length){if(!Hi(n.segments,t)||!lh(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!uA(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Hi(n.segments,i)||!lh(n.segments,i,r)||!n.children[oe]?!1:cA(n.children[oe],e,o,r)}}function lh(n,e,t){return e.every((r,i)=>sA[t](n[i].parameters,r.parameters))}var er=class{constructor(e=new _e([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Es(this.queryParams),this._queryParamMap}toString(){return uL.serialize(this)}},_e=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dh(this)}},$i=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Es(this.parameters),this._parameterMap}toString(){return dA(this)}};function sL(n,e){return Hi(n,e)&&n.every((t,r)=>An(t.parameters,e[r].parameters))}function Hi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function aL(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var Nu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>new Ds,providedIn:"root"});let n=e;return n})(),Ds=class{parse(e){let t=new hw(e);return new er(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${yu(e.root,!0)}`,r=dL(e.queryParams),i=typeof e.fragment=="string"?`#${cL(e.fragment)}`:"";return`${t}${r}${i}`}},uL=new Ds;function dh(n){return n.segments.map(e=>dA(e)).join("/")}function yu(n,e){if(!n.hasChildren())return dh(n);if(e){let t=n.children[oe]?yu(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==oe&&r.push(`${i}:${yu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=aL(n,(r,i)=>i===oe?[yu(n.children[oe],!1)]:[`${i}:${yu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${dh(n)}/${t[0]}`:`${dh(n)}/(${t.join("//")})`}}function lA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function uh(n){return lA(n).replace(/%3B/gi,";")}function cL(n){return encodeURI(n)}function dw(n){return lA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hh(n){return decodeURIComponent(n)}function QS(n){return hh(n.replace(/\+/g,"%20"))}function dA(n){return`${dw(n.path)}${lL(n.parameters)}`}function lL(n){return Object.entries(n).map(([e,t])=>`;${dw(e)}=${dw(t)}`).join("")}function dL(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${uh(t)}=${uh(i)}`).join("&"):`${uh(t)}=${uh(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var hL=/^[^\/()?;#]+/;function ow(n){let e=n.match(hL);return e?e[0]:""}var fL=/^[^\/()?;=#]+/;function pL(n){let e=n.match(fL);return e?e[0]:""}var gL=/^[^=?&#]+/;function mL(n){let e=n.match(gL);return e?e[0]:""}var yL=/^[^&#]+/;function vL(n){let e=n.match(yL);return e?e[0]:""}var hw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _e([],{}):new _e([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new _e(e,t)),r}parseSegment(){let e=ow(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new J(4009,!1);return this.capture(e),new $i(hh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=pL(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=ow(this.remaining);i&&(r=i,this.capture(r))}e[hh(t)]=hh(r)}parseQueryParam(e){let t=mL(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=vL(this.remaining);s&&(r=s,this.capture(r))}let i=QS(t),o=QS(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=ow(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new J(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=oe);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[oe]:new _e([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new J(4011,!1)}};function hA(n){return n.segments.length>0?new _e([],{[oe]:n}):n}function fA(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=fA(i);if(r===oe&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new _e(n.segments,e);return wL(t)}function wL(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new _e(n.segments.concat(e.segments),e.children)}return n}function Du(n){return n instanceof er}function _L(n,e,t=null,r=null){let i=pA(n);return gA(i,e,t,r)}function pA(n){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new _e(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=hA(r);return e??i}function gA(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return sw(i,i,i,t,r);let o=IL(e);if(o.toRoot())return sw(i,i,new _e([],{}),t,r);let s=EL(o,i,n),a=s.processChildren?_u(s.segmentGroup,s.index,o.commands):yA(s.segmentGroup,s.index,o.commands);return sw(i,s.segmentGroup,a,t,r)}function fh(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Tu(n){return typeof n=="object"&&n!=null&&n.outlets}function sw(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=mA(n,e,t);let a=hA(fA(s));return new er(a,o,i)}function mA(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=mA(o,e,t)}),new _e(n.segments,r)}var ph=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&fh(r[0]))throw new J(4003,!1);let i=r.find(Tu);if(i&&i!==oA(r))throw new J(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function IL(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ph(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new ph(t,e,r)}var ws=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function EL(n,e,t){if(n.isAbsolute)return new ws(e,!0,0);if(!t)return new ws(e,!1,NaN);if(t.parent===null)return new ws(t,!0,0);let r=fh(n.commands[0])?0:1,i=t.segments.length-1+r;return DL(t,i,n.numberOfDoubleDots)}function DL(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new J(4005,!1);i=r.segments.length}return new ws(r,!1,i-o)}function TL(n){return Tu(n[0])?n[0].outlets:{[oe]:n}}function yA(n,e,t){if(n??=new _e([],{}),n.segments.length===0&&n.hasChildren())return _u(n,e,t);let r=CL(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new _e(n.segments.slice(0,r.pathIndex),{});return o.children[oe]=new _e(n.segments.slice(r.pathIndex),n.children),_u(o,0,i)}else return r.match&&i.length===0?new _e(n.segments,{}):r.match&&!n.hasChildren()?fw(n,e,t):r.match?_u(n,0,i):fw(n,e,t)}function _u(n,e,t){if(t.length===0)return new _e(n.segments,{});{let r=TL(t),i={};if(Object.keys(r).some(o=>o!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let o=_u(n.children[oe],e,t);return new _e(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=yA(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new _e(n.segments,i)}}function CL(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Tu(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!ZS(c,l,s))return o;r+=2}else{if(!ZS(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function fw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Tu(o)){let c=bL(o.outlets);return new _e(r,c)}if(i===0&&fh(t[0])){let c=n.segments[e];r.push(new $i(c.path,YS(t[0]))),i++;continue}let s=Tu(o)?o.outlets[oe]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&fh(a)?(r.push(new $i(s,YS(a))),i+=2):(r.push(new $i(s,{})),i++)}return new _e(r,{})}function bL(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=fw(new _e([],{}),0,r))}),e}function YS(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function ZS(n,e,t){return n==t.path&&An(e,t.parameters)}var Iu="imperative",Je=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Je||{}),Gt=class{constructor(e,t){this.id=e,this.url=t}},Ts=class extends Gt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Je.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},tr=class extends Gt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Je.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},kt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(kt||{}),gh=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(gh||{}),Xn=class extends Gt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Je.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Br=class extends Gt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Je.NavigationSkipped}},Cu=class extends Gt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Je.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},mh=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pw=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},gw=class extends Gt{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=Je.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},mw=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yw=class extends Gt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},vw=class{constructor(e){this.route=e,this.type=Je.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ww=class{constructor(e){this.route=e,this.type=Je.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},_w=class{constructor(e){this.snapshot=e,this.type=Je.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Iw=class{constructor(e){this.snapshot=e,this.type=Je.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ew=class{constructor(e){this.snapshot=e,this.type=Je.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Dw=class{constructor(e){this.snapshot=e,this.type=Je.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yh=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Je.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},bu=class{},Cs=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function SL(n,e){return n.providers&&!n._injector&&(n._injector=El(n.providers,e,`Route: ${n.path}`)),n._injector??e}function un(n){return n.outlet||oe}function AL(n,e){let t=n.filter(r=>un(r)===e);return t.push(...n.filter(r=>un(r)!==e)),t}function Pu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Tw=class{get injector(){return Pu(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ku(this.rootInjector),this.attachRef=null}},ku=(()=>{let e=class e{constructor(r){this.rootInjector=r,this.contexts=new Map}onChildOutletCreated(r,i){let o=this.getOrCreateContext(r);o.outlet=i,this.contexts.set(r,o)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Tw(this.rootInjector),this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)(F(Mt))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),vh=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Cw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Cw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=bw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return bw(e,this._root).map(t=>t.value)}};function Cw(n,e){if(n===e.value)return e;for(let t of e.children){let r=Cw(n,t);if(r)return r}return null}function bw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=bw(n,t);if(r.length)return r.unshift(e),r}return[]}var Pt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function vs(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var wh=class extends vh{constructor(e,t){super(e),this.snapshot=t,Ow(this,e)}toString(){return this.snapshot.toString()}};function vA(n){let e=xL(n),t=new et([new $i("",{})]),r=new et({}),i=new et({}),o=new et({}),s=new et(""),a=new bs(t,r,o,s,i,oe,n,e.root);return a.snapshot=e.root,new wh(new Pt(a,[]),e)}function xL(n){let e={},t={},r={},i="",o=new _s([],e,r,i,t,oe,n,null,{});return new Ih("",new Pt(o,[]))}var bs=class{constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ee(l=>l[Ru]))??Z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>Es(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>Es(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function _h(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&_A(i)&&(r.resolve[Ru]=i.title),r}var _s=class{get title(){return this.data?.[Ru]}constructor(e,t,r,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Es(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Es(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Ih=class extends vh{constructor(e,t){super(t),this.url=e,Ow(this,t)}toString(){return wA(this._root)}};function Ow(n,e){e.value._routerState=n,e.children.forEach(t=>Ow(n,t))}function wA(n){let e=n.children.length>0?` { ${n.children.map(wA).join(", ")} } `:"";return`${n.value}${e}`}function aw(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,An(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),An(e.params,t.params)||n.paramsSubject.next(t.params),nL(e.url,t.url)||n.urlSubject.next(t.url),An(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Sw(n,e){let t=An(n.params,e.params)&&sL(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Sw(n.parent,e.parent))}function _A(n){return typeof n.title=="string"||n.title===null}var Fw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new mt,this.deactivateEvents=new mt,this.attachEvents=new mt,this.detachEvents=new mt,this.parentContexts=j(ku),this.location=j(ya),this.changeDetector=j(Ia),this.inputBinder=j(bh,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:o}=r.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new J(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new J(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new J(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new J(4013,!1);this._activatedRoute=r;let o=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Aw(r,c,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=al({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[dl]});let n=e;return n})(),Aw=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===bs?this.route:e===ku?this.childContexts:this.parent.get(e,t)}},bh=new z(""),JS=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,o=ea([i.queryParams,i.params,i.data]).pipe(Fe(([s,a,c],l)=>(c=q(q(q({},s),a),c),l===0?Z(c):Promise.resolve(c)))).subscribe(s=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=ET(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,s[c])});this.outletDataSubscriptions.set(r,o)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})();function ML(n,e,t){let r=Su(n,e._root,t?t._root:void 0);return new wh(r,e)}function Su(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=RL(n,e,t);return new Pt(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Su(n,a)),s}}let r=NL(e.value),i=e.children.map(o=>Su(n,o));return new Pt(r,i)}}function RL(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Su(n,r,i);return Su(n,r)})}function NL(n){return new bs(new et(n.url),new et(n.params),new et(n.queryParams),new et(n.fragment),new et(n.data),n.outlet,n.component,n)}var Au=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},IA="ngNavigationCancelingError";function Eh(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Du(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=EA(!1,kt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function EA(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[IA]=!0,t.cancellationCode=e,t}function PL(n){return DA(n)&&Du(n.url)}function DA(n){return!!n&&n[IA]}var kL=(n,e,t,r)=>ee(i=>(new xw(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),xw=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),aw(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=vs(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=vs(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=vs(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=vs(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Dw(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Iw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(aw(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),aw(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Dh=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Is=class{constructor(e,t){this.component=e,this.route=t}};function OL(n,e,t){let r=n._root,i=e?e._root:null;return vu(r,i,t,[r.value])}function FL(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function As(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!pE(n)?n:e.get(n):r}function vu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=vs(e);return n.children.forEach(s=>{LL(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Eu(a,t.getContext(s),i)),i}function LL(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=VL(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Dh(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?vu(n,e,a?a.children:null,r,i):vu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Is(a.outlet.component,s))}else s&&Eu(e,a,i),i.canActivateChecks.push(new Dh(r)),o.component?vu(n,null,a?a.children:null,r,i):vu(n,null,t,r,i);return i}function VL(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Hi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Hi(n.url,e.url)||!An(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sw(n,e)||!An(n.queryParams,e.queryParams);case"paramsChange":default:return!Sw(n,e)}}function Eu(n,e,t){let r=vs(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Eu(s,e.children.getContext(o),t):Eu(s,null,t):Eu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Is(e.outlet.component,i)):t.canDeactivateChecks.push(new Is(null,i)):t.canDeactivateChecks.push(new Is(null,i))}function Ou(n){return typeof n=="function"}function jL(n){return typeof n=="boolean"}function UL(n){return n&&Ou(n.canLoad)}function BL(n){return n&&Ou(n.canActivate)}function $L(n){return n&&Ou(n.canActivateChild)}function HL(n){return n&&Ou(n.canDeactivate)}function qL(n){return n&&Ou(n.canMatch)}function TA(n){return n instanceof Pn||n?.name==="EmptyError"}var ch=Symbol("INITIAL_VALUE");function Ss(){return Fe(n=>ea(n.map(e=>e.pipe(kn(1),Xr(ch)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===ch)return ch;if(t===!1||zL(t))return t}return!0}),tt(e=>e!==ch),kn(1)))}function zL(n){return Du(n)||n instanceof Au}function GL(n,e){return He(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Z(Ce(q({},t),{guardsResult:!0})):WL(s,r,i,n).pipe(He(a=>a&&jL(a)?KL(r,o,n,e):Z(a)),ee(a=>Ce(q({},t),{guardsResult:a})))})}function WL(n,e,t,r){return we(n).pipe(He(i=>XL(i.component,i.route,t,e,r)),Ft(i=>i!==!0,!0))}function KL(n,e,t,r){return we(e).pipe(Zr(i=>oo(YL(i.route.parent,r),QL(i.route,r),JL(n,i.path,t),ZL(n,i.route,t))),Ft(i=>i!==!0,!0))}function QL(n,e){return n!==null&&e&&e(new Ew(n)),Z(!0)}function YL(n,e){return n!==null&&e&&e(new _w(n)),Z(!0)}function ZL(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let i=r.map(o=>Dc(()=>{let s=Pu(e)??t,a=As(o,s),c=BL(a)?a.canActivate(e,n):yn(s,()=>a(e,n));return $r(c).pipe(Ft())}));return Z(i).pipe(Ss())}function JL(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>FL(s)).filter(s=>s!==null).map(s=>Dc(()=>{let a=s.guards.map(c=>{let l=Pu(s.node)??t,h=As(c,l),p=$L(h)?h.canActivateChild(r,n):yn(l,()=>h(r,n));return $r(p).pipe(Ft())});return Z(a).pipe(Ss())}));return Z(o).pipe(Ss())}function XL(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Z(!0);let s=o.map(a=>{let c=Pu(e)??i,l=As(a,c),h=HL(l)?l.canDeactivate(n,e,t,r):yn(c,()=>l(n,e,t,r));return $r(h).pipe(Ft())});return Z(s).pipe(Ss())}function eV(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Z(!0);let o=i.map(s=>{let a=As(s,n),c=UL(a)?a.canLoad(e,t):yn(n,()=>a(e,t));return $r(c)});return Z(o).pipe(Ss(),CA(r))}function CA(n){return Ef(Qe(e=>{if(typeof e!="boolean")throw Eh(n,e)}),ee(e=>e===!0))}function tV(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Z(!0);let o=i.map(s=>{let a=As(s,n),c=qL(a)?a.canMatch(e,t):yn(n,()=>a(e,t));return $r(c)});return Z(o).pipe(Ss(),CA(r))}var xu=class{constructor(e){this.segmentGroup=e||null}},Mu=class extends Error{constructor(e){super(),this.urlTree=e}};function ys(n){return io(new xu(n))}function nV(n){return io(new J(4e3,!1))}function rV(n){return io(EA(!1,kt.GuardRejected))}var Mw=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Z(r);if(i.numberOfChildren>1||!i.children[oe])return nV(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,params:y,data:C,title:A}=i,R=yn(o,()=>a({params:y,data:C,queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,title:A}));if(R instanceof er)throw new Mu(R);t=R}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Mu(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new er(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new _e(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new J(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Rw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function iV(n,e,t,r,i){let o=bA(n,e,t);return o.matched?(r=SL(e,r),tV(r,e,t,i).pipe(ee(s=>s===!0?o:q({},Rw)))):Z(o)}function bA(n,e,t){if(e.path==="**")return oV(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},Rw):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||tL)(t,n,e);if(!i)return q({},Rw);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?q(q({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function oV(n){return{matched:!0,parameters:n.length>0?oA(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function XS(n,e,t,r){return t.length>0&&uV(n,t,r)?{segmentGroup:new _e(e,aV(r,new _e(t,n.children))),slicedSegments:[]}:t.length===0&&cV(n,t,r)?{segmentGroup:new _e(n.segments,sV(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new _e(n.segments,n.children),slicedSegments:t}}function sV(n,e,t,r){let i={};for(let o of t)if(Sh(n,e,o)&&!r[un(o)]){let s=new _e([],{});i[un(o)]=s}return q(q({},r),i)}function aV(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&un(r)!==oe){let i=new _e([],{});t[un(r)]=i}return t}function uV(n,e,t){return t.some(r=>Sh(n,e,r)&&un(r)!==oe)}function cV(n,e,t){return t.some(r=>Sh(n,e,r))}function Sh(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function lV(n,e,t){return e.length===0&&!n.children[t]}var Nw=class{};function dV(n,e,t,r,i,o,s="emptyOnly"){return new Pw(n,e,t,r,i,s,o).recognize()}var hV=31,Pw=class{constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Mw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new J(4002,`'${e.segmentGroup}'`)}recognize(){let e=XS(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(({children:t,rootSnapshot:r})=>{let i=new Pt(r,t),o=new Ih("",i),s=_L(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new _s([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(ee(r=>({children:r,rootSnapshot:t})),ur(r=>{if(r instanceof Mu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof xu?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(ee(s=>s instanceof Pt?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return we(o).pipe(Zr(s=>{let a=r.children[s],c=AL(t,s);return this.processSegmentGroup(e,c,a,s,i)}),Jr((s,a)=>(s.push(...a),s)),cr(null),Nf(),He(s=>{if(s===null)return ys(r);let a=SA(s);return fV(a),Z(a)}))}processSegment(e,t,r,i,o,s,a){return we(t).pipe(Zr(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(ur(l=>{if(l instanceof xu)return Z(null);throw l}))),Ft(c=>!!c),ur(c=>{if(TA(c))return lV(r,i,o)?Z(new Nw):ys(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return un(r)!==s&&(s===oe||!Sh(i,o,r))?ys(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):ys(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=bA(t,i,o);if(!c)return ys(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>hV&&(this.allowRedirects=!1));let y=new _s(o,l,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,eA(i),un(i),i.component??i._loadedComponent??null,i,tA(i)),C=_h(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(C.params),y.data=Object.freeze(C.data);let A=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,y,e);return this.applyRedirects.lineralizeSegments(i,A).pipe(He(R=>this.processSegment(e,r,t,R.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=iV(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Fe(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Fe(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:y}=c,C=new _s(m,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,eA(r),un(r),r.component??r._loadedComponent??null,r,tA(r)),A=_h(C,s,this.paramsInheritanceStrategy);C.params=Object.freeze(A.params),C.data=Object.freeze(A.data);let{segmentGroup:R,slicedSegments:L}=XS(t,m,y,l);if(L.length===0&&R.hasChildren())return this.processChildren(h,l,R,C).pipe(ee(O=>new Pt(C,O)));if(l.length===0&&L.length===0)return Z(new Pt(C,[]));let $=un(r)===o;return this.processSegment(h,l,R,L,$?oe:o,!0,C).pipe(ee(O=>new Pt(C,O instanceof Pt?[O]:[])))}))):ys(t)))}getChildConfig(e,t,r){return t.children?Z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Z({routes:t._loadedRoutes,injector:t._loadedInjector}):eV(e,t,r,this.urlSerializer).pipe(He(i=>i?this.configLoader.loadChildren(e,t).pipe(Qe(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):rV(t))):Z({routes:[],injector:e})}};function fV(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function pV(n){let e=n.value.routeConfig;return e&&e.path===""}function SA(n){let e=[],t=new Set;for(let r of n){if(!pV(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=SA(r.children);e.push(new Pt(r.value,i))}return e.filter(r=>!t.has(r))}function eA(n){return n.data||{}}function tA(n){return n.resolve||{}}function gV(n,e,t,r,i,o){return He(s=>dV(n,e,t,r,s.extractedUrl,i,o).pipe(ee(({state:a,tree:c})=>Ce(q({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function mV(n,e){return He(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Z(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of AA(c))s.add(l);let a=0;return we(s).pipe(Zr(c=>o.has(c)?yV(c,r,n,e):(c.data=_h(c,c.parent,n).resolve,Z(void 0))),Qe(()=>a++),so(1),He(c=>a===s.size?Z(t):gt))})}function AA(n){let e=n.children.map(t=>AA(t)).flat();return[n,...e]}function yV(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!_A(i)&&(o[Ru]=i.title),vV(o,n,e,r).pipe(ee(s=>(n._resolvedData=s,n.data=_h(n,n.parent,t).resolve,null)))}function vV(n,e,t,r){let i=lw(n);if(i.length===0)return Z({});let o={};return we(i).pipe(He(s=>wV(n[s],e,t,r).pipe(Ft(),Qe(a=>{if(a instanceof Au)throw Eh(new Ds,a);o[s]=a}))),so(1),Mf(o),ur(s=>TA(s)?gt:io(s)))}function wV(n,e,t,r){let i=Pu(e)??r,o=As(n,i),s=o.resolve?o.resolve(e,t):yn(i,()=>o(e,t));return $r(s)}function uw(n){return Fe(e=>{let t=n(e);return t?we(t).pipe(ee(()=>e)):Z(e)})}var xA=(()=>{let e=class e{buildTitle(r){let i,o=r.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===oe);return i}getResolvedTitleForRoute(r){return r.data[Ru]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(_V),providedIn:"root"});let n=e;return n})(),_V=(()=>{let e=class e extends xA{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(F(zT))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Fu=new z("",{providedIn:"root",factory:()=>({})}),IV=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sl({type:e,selectors:[["ng-component"]],standalone:!0,features:[lT],decls:1,vars:0,template:function(i,o){i&1&&va(0,"router-outlet")},dependencies:[Fw],encapsulation:2});let n=e;return n})();function Lw(n){let e=n.children&&n.children.map(Lw),t=e?Ce(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=IV),t}var Th=new z(""),Vw=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=j(Al)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Z(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=$r(r.loadComponent()).pipe(ee(MA),Qe(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),ta(()=>{this.componentLoaders.delete(r)})),o=new eo(i,()=>new Ve).pipe(Xi());return this.componentLoaders.set(r,o),o}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Z({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=EV(i,this.compiler,r,this.onLoadEndListener).pipe(ta(()=>{this.childrenLoaders.delete(i)})),a=new eo(s,()=>new Ve).pipe(Xi());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function EV(n,e,t,r){return $r(n.loadChildren()).pipe(ee(MA),He(i=>i instanceof ha||Array.isArray(i)?Z(i):we(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Th,[],{optional:!0,self:!0}).flat()),{routes:s.map(Lw),injector:o}}))}function DV(n){return n&&typeof n=="object"&&"default"in n}function MA(n){return DV(n)?n.default:n}var jw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(TV),providedIn:"root"});let n=e;return n})(),TV=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),RA=new z(""),NA=new z("");function CV(n,e,t){let r=n.get(NA),i=n.get(vt);return n.get(he).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o,s=new Promise(l=>{o=l}),a=i.startViewTransition(()=>(o(),bV(n))),{onViewTransitionCreated:c}=r;return c&&yn(n,()=>c({transition:a,from:e,to:t})),s})}function bV(n){return new Promise(e=>{lg({read:()=>setTimeout(e)},{injector:n})})}var SV=new z(""),Uw=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ve,this.transitionAbortSubject=new Ve,this.configLoader=j(Vw),this.environmentInjector=j(Mt),this.urlSerializer=j(Nu),this.rootContexts=j(ku),this.location=j(bo),this.inputBindingEnabled=j(bh,{optional:!0})!==null,this.titleStrategy=j(xA),this.options=j(Fu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=j(jw),this.createViewTransition=j(RA,{optional:!0}),this.navigationErrorHandler=j(SV,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Z(void 0),this.rootComponentType=null;let r=o=>this.events.next(new vw(o)),i=o=>this.events.next(new ww(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Ce(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,o){return this.transitions=new et({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Iu,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(tt(s=>s.id!==0),ee(s=>Ce(q({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Fe(s=>{let a=!1,c=!1;return Z(s).pipe(Fe(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",kt.SupersededByNewNavigation),gt;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Ce(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!h&&p!=="reload"){let m="";return this.events.next(new Br(l.id,this.urlSerializer.serialize(l.rawUrl),m,gh.IgnoredSameUrlNavigation)),l.resolve(!1),gt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Z(l).pipe(Fe(m=>{let y=this.transitions?.getValue();return this.events.next(new Ts(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),y!==this.transitions?.getValue()?gt:Promise.resolve(m)}),gV(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Qe(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=Ce(q({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let y=new mh(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(y)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:y,source:C,restoredState:A,extras:R}=l,L=new Ts(m,this.urlSerializer.serialize(y),C,A);this.events.next(L);let $=vA(this.rootComponentType).snapshot;return this.currentTransition=s=Ce(q({},l),{targetSnapshot:$,urlAfterRedirects:y,extras:Ce(q({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=y,Z(s)}else{let m="";return this.events.next(new Br(l.id,this.urlSerializer.serialize(l.extractedUrl),m,gh.IgnoredByUrlHandlingStrategy)),l.resolve(!1),gt}}),Qe(l=>{let h=new pw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),ee(l=>(this.currentTransition=s=Ce(q({},l),{guards:OL(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),GL(this.environmentInjector,l=>this.events.next(l)),Qe(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Eh(this.urlSerializer,l.guardsResult);let h=new gw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),tt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",kt.GuardRejected),!1)),uw(l=>{if(l.guards.canActivateChecks.length)return Z(l).pipe(Qe(h=>{let p=new mw(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}),Fe(h=>{let p=!1;return Z(h).pipe(mV(this.paramsInheritanceStrategy,this.environmentInjector),Qe({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(h,"",kt.NoDataFromResolver)}}))}),Qe(h=>{let p=new yw(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}))}),uw(l=>{let h=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Qe(y=>{p.component=y}),ee(()=>{})));for(let y of p.children)m.push(...h(y));return m};return ea(h(l.targetSnapshot.root)).pipe(cr(null),kn(1))}),uw(()=>this.afterPreactivation()),Fe(()=>{let{currentSnapshot:l,targetSnapshot:h}=s,p=this.createViewTransition?.(this.environmentInjector,l.root,h.root);return p?we(p).pipe(ee(()=>s)):Z(s)}),ee(l=>{let h=ML(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=Ce(q({},l),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,s}),Qe(()=>{this.events.next(new bu)}),kL(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),kn(1),Qe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new tr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),kf(this.transitionAbortSubject.pipe(Qe(l=>{throw l}))),ta(()=>{!a&&!c&&this.cancelNavigationTransition(s,"",kt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),ur(l=>{if(c=!0,DA(l))this.events.next(new Xn(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),PL(l)?this.events.next(new Cs(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let h=new Cu(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let p=yn(this.environmentInjector,()=>this.navigationErrorHandler?.(h));if(p instanceof Au){let{message:m,cancellationCode:y}=Eh(this.urlSerializer,p);this.events.next(new Xn(s.id,this.urlSerializer.serialize(s.extractedUrl),m,y)),this.events.next(new Cs(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(h);let m=r.errorHandler(l);s.resolve(!!m)}}catch(p){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(p)}}return gt}))}))}cancelNavigationTransition(r,i,o){let s=new Xn(r.id,this.urlSerializer.serialize(r.extractedUrl),i,o);this.events.next(s),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let r=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return r.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function AV(n){return n!==Iu}var xV=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(MV),providedIn:"root"});let n=e;return n})(),kw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},MV=(()=>{let e=class e extends kw{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=zp(e)))(o||e)}})(),e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),PA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:()=>j(RV),providedIn:"root"});let n=e;return n})(),RV=(()=>{let e=class e extends PA{constructor(){super(...arguments),this.location=j(bo),this.urlSerializer=j(Nu),this.options=j(Fu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=j(jw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new er,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=vA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ts)this.stateMemento=this.createStateMemento();else if(r instanceof Br)this.rawUrlTree=i.initialUrl;else if(r instanceof mh){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??o,i)}}else r instanceof bu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):r instanceof Xn&&(r.code===kt.GuardRejected||r.code===kt.NoDataFromResolver)?this.restoreHistory(i):r instanceof Cu?this.restoreHistory(i,!0):r instanceof tr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let o=r instanceof er?this.urlSerializer.serialize(r):r;if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){let s=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(o,"",a)}else{let s=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===r.finalUrl&&s===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=zp(e)))(o||e)}})(),e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wu=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(wu||{});function kA(n,e){n.events.pipe(tt(t=>t instanceof tr||t instanceof Xn||t instanceof Cu||t instanceof Br),ee(t=>t instanceof tr||t instanceof Br?wu.COMPLETE:(t instanceof Xn?t.code===kt.Redirect||t.code===kt.SupersededByNewNavigation:!1)?wu.REDIRECTING:wu.FAILED),tt(t=>t!==wu.REDIRECTING),kn(1)).subscribe(()=>{e()})}function NV(n){throw n}var PV={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kV={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},qi=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=j(Tl),this.stateManager=j(PA),this.options=j(Fu,{optional:!0})||{},this.pendingTasks=j(To),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=j(Uw),this.urlSerializer=j(Nu),this.location=j(bo),this.urlHandlingStrategy=j(jw),this._events=new Ve,this.errorHandler=this.options.errorHandler||NV,this.navigated=!1,this.routeReuseStrategy=j(xV),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=j(Th,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!j(bh,{optional:!0}),this.eventsSubscription=new Oe,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof Xn&&i.code!==kt.Redirect&&i.code!==kt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof tr)this.navigated=!0;else if(i instanceof Cs){let a=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),l=q({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||AV(o.source)},a);this.scheduleNavigation(c,Iu,null,l,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}FV(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Iu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,o){let s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){let l=q({},o);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Lw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,h=l?this.currentUrlTree.fragment:a,p=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":p=q(q({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let y=o?o.snapshot:this.routerState.snapshot.root;m=pA(y)}catch{(typeof r[0]!="string"||r[0][0]!=="/")&&(r=[]),m=this.currentUrlTree.root}return gA(m,r,p,h??null)}navigateByUrl(r,i={skipLocationChange:!1}){let o=Du(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,Iu,null,i)}navigate(r,i={skipLocationChange:!1}){return OV(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let o;if(i===!0?o=q({},PV):i===!1?o=q({},kV):o=i,Du(r))return KS(this.currentUrlTree,r,o);let s=this.parseUrl(r);return KS(this.currentUrlTree,s,o)}removeEmptyProps(r){return Object.entries(r).reduce((i,[o,s])=>(s!=null&&(i[o]=s),i),{})}scheduleNavigation(r,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,h;a?(c=a.resolve,l=a.reject,h=a.promise):h=new Promise((m,y)=>{c=m,l=y});let p=this.pendingTasks.add();return kA(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:s,resolve:c,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function OV(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new J(4008,!1)}function FV(n){return!(n instanceof bu)&&!(n instanceof Cs)}var Ch=class{};var LV=(()=>{let e=class e{constructor(r,i,o,s,a){this.router=r,this.injector=o,this.preloadingStrategy=s,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(tt(r=>r instanceof tr),Zr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let o=[];for(let s of i){s.providers&&!s._injector&&(s._injector=El(s.providers,r,`Route: ${s.path}`));let a=s._injector??r,c=s._loadedInjector??a;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(a,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(c,s.children??s._loadedRoutes))}return we(o).pipe(ar())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let o;i.loadChildren&&i.canLoad===void 0?o=this.loader.loadChildren(r,i):o=Z(null);let s=o.pipe(He(a=>a===null?Z(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return we([s,a]).pipe(ar())}else return s})}};e.\u0275fac=function(i){return new(i||e)(F(qi),F(Al),F(Mt),F(Ch),F(Vw))},e.\u0275prov=W({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),OA=new z(""),VV=(()=>{let e=class e{constructor(r,i,o,s,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=o,this.zone=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ts?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof tr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Br&&r.code===gh.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof yh&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new yh(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){VD()},e.\u0275prov=W({token:e,factory:e.\u0275fac});let n=e;return n})();function jV(n){return n.routerState.root}function Lu(n,e){return{\u0275kind:n,\u0275providers:e}}function UV(){let n=j(Bt);return e=>{let t=n.get(wr);if(e!==t.components[0])return;let r=n.get(qi),i=n.get(FA);n.get(Bw)===1&&r.initialNavigation(),n.get(LA,null,ae.Optional)?.setUpPreloading(),n.get(OA,null,ae.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var FA=new z("",{factory:()=>new Ve}),Bw=new z("",{providedIn:"root",factory:()=>1});function BV(){return Lu(2,[{provide:Bw,useValue:0},{provide:Sl,multi:!0,deps:[Bt],useFactory:e=>{let t=e.get(xT,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(qi),o=e.get(FA);kA(i,()=>{r(!0)}),e.get(Uw).afterPreactivation=()=>(r(!0),o.closed?Z(void 0):o),i.initialNavigation()}))}}])}function $V(){return Lu(3,[{provide:Sl,multi:!0,useFactory:()=>{let e=j(qi);return()=>{e.setUpLocationChangeListener()}}},{provide:Bw,useValue:2}])}var LA=new z("");function HV(n){return Lu(0,[{provide:LA,useExisting:LV},{provide:Ch,useExisting:n}])}function qV(){return Lu(8,[JS,{provide:bh,useExisting:JS}])}function zV(n){let e=[{provide:RA,useValue:CV},{provide:NA,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return Lu(9,e)}var nA=new z("ROUTER_FORROOT_GUARD"),GV=[bo,{provide:Nu,useClass:Ds},qi,ku,{provide:bs,useFactory:jV,deps:[qi]},Vw,[]],$w=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[GV,[],{provide:Th,multi:!0,useValue:r},{provide:nA,useFactory:YV,deps:[[qi,new Do,new Mp]]},{provide:Fu,useValue:i||{}},i?.useHash?KV():QV(),WV(),i?.preloadingStrategy?HV(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?ZV(i):[],i?.bindToComponentInputs?qV().\u0275providers:[],i?.enableViewTransitions?zV().\u0275providers:[],JV()]}}static forChild(r){return{ngModule:e,providers:[{provide:Th,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(F(nA,8))},e.\u0275mod=ct({type:e}),e.\u0275inj=ut({});let n=e;return n})();function WV(){return{provide:OA,useFactory:()=>{let n=j(OT),e=j(he),t=j(Fu),r=j(Uw),i=j(Nu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new VV(i,r,n,e,t)}}}function KV(){return{provide:fi,useClass:RT}}function QV(){return{provide:fi,useClass:Sg}}function YV(n){return"guarded"}function ZV(n){return[n.initialNavigation==="disabled"?$V().\u0275providers:[],n.initialNavigation==="enabledBlocking"?BV().\u0275providers:[]]}var rA=new z("");function JV(){return[{provide:rA,useFactory:UV},{provide:gg,multi:!0,useExisting:rA}]}var e2=[],Ah=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ct({type:n});static \u0275inj=ut({imports:[$w.forRoot(e2),$w]})};var xh=class n{constructor(e){this.firestore=e}addDocument(e){return this.firestore.collection("users").add(e)}getDocuments(){return this.firestore.collection("users",e=>e.where("age",">",40)).valueChanges()}static \u0275fac=function(t){return new(t||n)(F(iw))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})};function n2(n,e){if(n&1&&(Bn(0,"li"),Co(1),vr()),n&2){let t=e.$implicit;ng(),hg("",t.name," - Age: ",t.age,"")}}var Mh=class n{constructor(e){this.dataService=e}title="dsa-roadmap-app";users=[];ngOnInit(){this.dataService.getDocuments().subscribe(e=>{this.users=e})}getRandomUser(){let e=["Alice","Bob","Charlie","David","Eve","Frank"],t=e[Math.floor(Math.random()*e.length)],r=Math.floor(Math.random()*50)+1;return{name:t,age:r}}addUser(){let e=this.getRandomUser();this.dataService.addDocument(e).then(t=>{console.log("User added with ID:",t.id)}).catch(t=>{console.error("Error adding user:",t)})}static \u0275fac=function(t){return new(t||n)(yr(xh))};static \u0275cmp=sl({type:n,selectors:[["app-root"]],decls:13,vars:1,consts:[[1,"main"],[1,"content"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,r){t&1&&(Bn(0,"main",0)(1,"div",1),Co(2," Welcome "),Bn(3,"div")(4,"h1"),Co(5,"User List"),vr(),Bn(6,"ul"),cg(7,n2,2,2,"li",2),vr(),Bn(8,"h2"),Co(9,"Add New User"),vr(),Bn(10,"button",3),Dl("click",function(){return r.addUser()}),Co(11,"Add User"),vr()()()(),va(12,"router-outlet")),t&2&&(ng(7),dg("ngForOf",r.users))},dependencies:[PT,Fw]})};var Rh=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ct({type:n,bootstrap:[Mh]});static \u0275inj=ut({imports:[qT,Ah,YT.initializeApp(WS),GS]})};HT().bootstrapModule(Rh,{ngZoneEventCoalescing:!0}).catch(n=>console.error(n));
